!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,e.RayMarch=t()}}(function(){var t;return function t(e,n,r){function a(o,s){if(!n[o]){if(!e[o]){var u="function"==typeof require&&require;if(!s&&u)return u(o,!0);if(i)return i(o,!0);var l=new Error("Cannot find module '"+o+"'");throw l.code="MODULE_NOT_FOUND",l}var c=n[o]={exports:{}};e[o][0].call(c.exports,function(t){var n=e[o][1][t];return a(n?n:t)},c,c.exports,t,e,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)a(r[o]);return a}({1:[function(e,n,r){(function(e){function a(t,e,n){function r(t){var e=t.split(/[:;,]/),n=e[1],r="base64"==e[2]?atob:decodeURIComponent,a=r(e.pop()),i=a.length,o=0,s=new Uint8Array(i);for(o;o<i;++o)s[o]=a.charCodeAt(o);return new g([s],{type:n})}function a(t,e){if("download"in d)return d.href=t,d.setAttribute("download",v),d.innerHTML="downloading...",d.style.display="none",h.body.appendChild(d),setTimeout(function(){d.click(),h.body.removeChild(d),e===!0&&setTimeout(function(){u.URL.revokeObjectURL(d.href)},250)},66),!0;var n=h.createElement("iframe");h.body.appendChild(n),e||(t="data:"+t.replace(/^data:([\w\/\-\+]+)/,l)),n.src=t,setTimeout(function(){h.body.removeChild(n)},333)}var i,o,s,u=window,l="application/octet-stream",c=n||l,f=t,h=document,d=h.createElement("a"),p=function(t){return String(t)},g=u.Blob||u.MozBlob||u.WebKitBlob||p,m=u.MSBlobBuilder||u.WebKitBlobBuilder||u.BlobBuilder,v=e||"download";if("true"===String(this)&&(f=[f,c],c=f[0],f=f[1]),String(f).match(/^data\:[\w+\-]+\/[\w+\-]+[,;]/))return navigator.msSaveBlob?navigator.msSaveBlob(r(f),v):a(f);try{i=f instanceof g?f:new g([f],{type:c})}catch(t){m&&(o=new m,o.append([f]),i=o.getBlob(c))}if(navigator.msSaveBlob)return navigator.msSaveBlob(i,v);if(u.URL)a(u.URL.createObjectURL(i),!0);else{if("string"==typeof i||i.constructor===p)try{return a("data:"+c+";base64,"+u.btoa(i))}catch(t){return a("data:"+c+","+encodeURIComponent(i))}s=new FileReader,s.onload=function(t){a(this.result)},s.readAsDataURL(i)}return!0}window.Whammy=function(){function t(t,n){for(var r=e(t),a=3e4,i=[{id:440786851,data:[{data:1,id:17030},{data:1,id:17143},{data:4,id:17138},{data:8,id:17139},{data:"webm",id:17026},{data:2,id:17031},{data:2,id:17029}]},{id:408125543,data:[{id:357149030,data:[{data:1e6,id:2807729},{data:"whammy",id:19840},{data:"whammy",id:22337},{data:f(r.duration),id:17545}]},{id:374648427,data:[{id:174,data:[{data:1,id:215},{data:1,id:29637},{data:0,id:156},{data:"und",id:2274716},{data:"V_VP8",id:134},{data:"VP8",id:2459272},{data:1,id:131},{id:224,data:[{data:r.width,id:176},{data:r.height,id:186}]}]}]},{id:475249515,data:[]}]}],s=i[1],l=s.data[2],c=0,h=0;c<t.length;){var d={id:187,data:[{data:Math.round(h),id:179},{id:183,data:[{data:1,id:247},{data:0,size:8,id:241}]}]};l.data.push(d);var p=[],g=0;do p.push(t[c]),g+=t[c].duration,c++;while(c<t.length&&g<a);var m=0,v={id:524531317,data:[{data:Math.round(h),id:231}].concat(p.map(function(t){var e=u({discardable:0,frame:t.data.slice(4),invisible:0,keyframe:1,lacing:0,trackNum:1,timecode:Math.round(m)});return m+=t.duration,{data:e,id:163}}))};s.data.push(v),h+=g}for(var y=0,_=0;_<s.data.length;_++){_>=3&&(l.data[_-3].data[1].data[1].data=y);var b=o([s.data[_]],n);y+=b.size||b.byteLength||b.length,2!=_&&(s.data[_]=b)}return o(i,n)}function e(t){for(var e=t[0].width,n=t[0].height,r=t[0].duration,a=1;a<t.length;a++){if(t[a].width!=e)throw"Frame "+(a+1)+" has a different width";if(t[a].height!=n)throw"Frame "+(a+1)+" has a different height";if(t[a].duration<0||t[a].duration>32767)throw"Frame "+(a+1)+" has a weird duration (must be between 0 and 32767)";r+=t[a].duration}return{duration:r,width:e,height:n}}function n(t){for(var e=[];t>0;)e.push(255&t),t>>=8;return new Uint8Array(e.reverse())}function r(t,e){for(var n=new Uint8Array(e),r=e-1;r>=0;r--)n[r]=255&t,t>>=8;return n}function a(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}function i(t){var e=[],n=t.length%8?new Array(9-t.length%8).join("0"):"";t=n+t;for(var r=0;r<t.length;r+=8)e.push(parseInt(t.substr(r,8),2));return new Uint8Array(e)}function o(t,e){for(var u=[],l=0;l<t.length;l++)if("id"in t[l]){var c=t[l].data;"object"==typeof c&&(c=o(c,e)),"number"==typeof c&&(c="size"in t[l]?r(c,t[l].size):i(c.toString(2))),"string"==typeof c&&(c=a(c)),c.length;for(var f=c.size||c.byteLength||c.length,h=0,d=56;d>0;d-=7)if(f>Math.pow(2,d)-2){h=d/7;break}var p=f.toString(2),g=new Array(8*(h+1)+1).join("0"),m=new Array(h+1).join("0")+1,v=g.substr(0,g.length-p.length-m.length)+p,y=m+v;u.push(n(t[l].id)),u.push(i(y)),u.push(c)}else u.push(t[l]);if(e){var _=s(u);return new Uint8Array(_)}return new Blob(u,{type:"video/webm"})}function s(t,e){null==e&&(e=[]);for(var n=0;n<t.length;n++)"object"==typeof t[n]?s(t[n],e):e.push(t[n]);return e}function u(t){var e=0;if(t.keyframe&&(e|=128),t.invisible&&(e|=8),t.lacing&&(e|=t.lacing<<1),t.discardable&&(e|=1),t.trackNum>127)throw"TrackNumber > 127 not supported";var n=[128|t.trackNum,t.timecode>>8,255&t.timecode,e].map(function(t){return String.fromCharCode(t)}).join("")+t.frame;return n}function l(t){for(var e=t.RIFF[0].WEBP[0],n=e.indexOf("¬ù*"),r=0,a=[];r<4;r++)a[r]=e.charCodeAt(n+3+r);var i,o,s,u,l;return l=a[1]<<8|a[0],i=16383&l,o=l>>14,l=a[3]<<8|a[2],s=16383&l,u=l>>14,{width:i,height:s,data:e,riff:t}}function c(t){for(var e=0,n={};e<t.length;){var r=t.substr(e,4);if(n[r]=n[r]||[],"RIFF"==r||"LIST"==r){var a=parseInt(t.substr(e+4,4).split("").map(function(t){var e=t.charCodeAt(0).toString(2);return new Array(8-e.length+1).join("0")+e}).join(""),2),i=t.substr(e+4+4,a);e+=8+a,n[r].push(c(i))}else"WEBP"==r?(n[r].push(t.substr(e+8)),e=t.length):(n[r].push(t.substr(e+4)),e=t.length)}return n}function f(t){return[].slice.call(new Uint8Array(new Float64Array([t]).buffer),0).map(function(t){return String.fromCharCode(t)}).reverse().join("")}function h(t,e){this.frames=[],this.duration=1e3/t,this.quality=e||.8}return h.prototype.add=function(t,e){if("undefined"!=typeof e&&this.duration)throw"you can't pass a duration if the fps is set";if("undefined"==typeof e&&!this.duration)throw"if you don't have the fps set, you need to have durations here.";if(t.canvas&&(t=t.canvas),t.toDataURL)t=t.getContext("2d").getImageData(0,0,t.width,t.height);else if("string"!=typeof t)throw"frame must be a a HTMLCanvasElement, a CanvasRenderingContext2D or a DataURI formatted string";if("string"==typeof t&&!/^data:image\/webp;base64,/gi.test(t))throw"Input must be formatted properly as a base64 encoded DataURI of type image/webp";this.frames.push({image:t,duration:e||this.duration})},h.prototype.encodeFrames=function(t){if(this.frames[0].image instanceof ImageData){var e=this.frames,n=document.createElement("canvas"),r=n.getContext("2d");n.width=this.frames[0].image.width,n.height=this.frames[0].image.height;var a=function(i){var o=e[i];r.putImageData(o.image,0,0),o.image=n.toDataURL("image/webp",this.quality),i<e.length-1?setTimeout(function(){a(i+1)},1):t()}.bind(this);a(0)}else t()},h.prototype.compile=function(e,n){this.encodeFrames(function(){var r=new t(this.frames.map(function(t){var e=l(c(atob(t.image.slice(23))));return e.duration=t.duration,e}),e);n(r)}.bind(this))},{Video:h,fromImageArray:function(e,n,r){return t(e.map(function(t){var e=l(c(atob(t.slice(23))));return e.duration=1e3/n,e}),r)},toWebM:t}}(),function(){"use strict";function t(t){var e,n=new Uint8Array(t);for(e=0;e<t;e+=1)n[e]=0;return n}function e(e,n,r,a){var i=n+r,o=t((parseInt(i/a)+1)*a);return o.set(e),o}function n(t,e,n){return t=t.toString(n||8),"000000000000".substr(t.length+12-e)+t}function r(e,n,r){var a,i;for(n=n||t(e.length),r=r||0,a=0,i=e.length;a<i;a+=1)n[r]=e.charCodeAt(a),r+=1;return n}function a(t){function e(t){return i[t>>18&63]+i[t>>12&63]+i[t>>6&63]+i[63&t]}var n,r,a,o=t.length%3,s="";for(n=0,a=t.length-o;n<a;n+=3)r=(t[n]<<16)+(t[n+1]<<8)+t[n+2],s+=e(r);switch(s.length%4){case 1:s+="=";break;case 2:s+="=="}return s}var i=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9","+","/"];window.utils={},window.utils.clean=t,window.utils.pad=n,window.utils.extend=e,window.utils.stringToUint8=r,window.utils.uint8ToBase64=a}(),function(){"use strict";function t(t,r){var a=n.clean(512),i=0;return e.forEach(function(e){var n,r,o=t[e.field]||"";for(n=0,r=o.length;n<r;n+=1)a[i]=o.charCodeAt(n),i+=1;i+=e.length-n}),"function"==typeof r?r(a,i):a}var e,n=window.utils;e=[{field:"fileName",length:100},{field:"fileMode",length:8},{field:"uid",length:8},{field:"gid",length:8},{field:"fileSize",length:12},{field:"mtime",length:12},{field:"checksum",length:8},{field:"type",length:1},{field:"linkName",length:100},{field:"ustar",length:8},{field:"owner",length:32},{field:"group",length:32},{field:"majorNumber",length:8},{field:"minorNumber",length:8},{field:"filenamePrefix",length:155},{field:"padding",length:12}],window.header={},window.header.structure=e,window.header.format=t}(),function(){"use strict";function t(t){this.written=0,e=(t||20)*a,this.out=r.clean(e),this.blocks=[],this.length=0}var e,n=window.header,r=window.utils,a=512;t.prototype.append=function(t,e,i,o){var s,u,l,c,f,h,d;if("string"==typeof e)e=r.stringToUint8(e);else if(e.constructor!==Uint8Array.prototype.constructor)throw"Invalid input type. You gave me: "+e.constructor.toString().match(/function\s*([$A-Za-z_][0-9A-Za-z_]*)\s*\(/)[1];"function"==typeof i&&(o=i,i={}),i=i||{},l=i.mode||4095&parseInt("777",8),c=i.mtime||Math.floor(+new Date/1e3),f=i.uid||0,h=i.gid||0,s={fileName:t,fileMode:r.pad(l,7),uid:r.pad(f,7),gid:r.pad(h,7),fileSize:r.pad(e.length,11),mtime:r.pad(c,11),checksum:"        ",type:"0",ustar:"ustar  ",owner:i.owner||"",group:i.group||""},u=0,Object.keys(s).forEach(function(t){var e,n,r=s[t];for(e=0,n=r.length;e<n;e+=1)u+=r.charCodeAt(e)}),s.checksum=r.pad(u,6)+"\0 ",d=n.format(s);var p=Math.ceil(d.length/a)*a,g=Math.ceil(e.length/a)*a;this.blocks.push({header:d,input:e,headerLength:p,inputLength:g})},t.prototype.save=function(){var t=[],e=[],n=0,r=Math.pow(2,20),i=[];return this.blocks.forEach(function(t){n+t.headerLength+t.inputLength>r&&(e.push({blocks:i,length:n}),i=[],n=0),i.push(t),n+=t.headerLength+t.inputLength}),e.push({blocks:i,length:n}),e.forEach(function(e){var n=new Uint8Array(e.length),r=0;e.blocks.forEach(function(t){n.set(t.header,r),r+=t.headerLength,n.set(t.input,r),r+=t.inputLength}),t.push(n)}),t.push(new Uint8Array(2*a)),new Blob(t,{type:"octet/stream"})},t.prototype.clear=function(){this.written=0,this.out=r.clean(e)},window.Tar=t}(),function(t){function e(t,n){if({}.hasOwnProperty.call(e.cache,t))return e.cache[t];var r=e.resolve(t);if(!r)throw new Error("Failed to resolve module "+t);var a={id:t,require:e,filename:t,exports:{},loaded:!1,parent:n,children:[]};n&&n.children.push(a);var i=t.slice(0,t.lastIndexOf("/")+1);return e.cache[t]=a.exports,r.call(a.exports,a,a.exports,i,t),a.loaded=!0,e.cache[t]=a.exports}e.modules={},e.cache={},e.resolve=function(t){return{}.hasOwnProperty.call(e.modules,t)?e.modules[t]:void 0},e.define=function(t,n){e.modules[t]=n};var n=function(e){return e="/",{title:"browser",version:"v0.10.26",browser:!0,env:{},argv:[],nextTick:t.setImmediate||function(t){setTimeout(t,0)},cwd:function(){return e},chdir:function(t){e=t}}}();e.define("/gif.coffee",function(t,n,r,a){function i(t,e){return{}.hasOwnProperty.call(t,e)}function o(t,e){for(var n=0,r=e.length;n<r;++n)if(n in e&&e[n]===t)return!0;return!1}function s(t,e){function n(){this.constructor=t}for(var r in e)i(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t}var u,l,c,f,h;c=e("events",t).EventEmitter,u=e("/browser.coffee",t),h=function(t){function e(t){var e,n;this.running=!1,this.options={},this.frames=[],this.freeWorkers=[],this.activeWorkers=[],this.setOptions(t);for(e in l)n=l[e],null!=this.options[e]?this.options[e]:this.options[e]=n}return s(e,t),l={workerScript:"gif.worker.js",workers:2,repeat:0,background:"#fff",quality:10,width:null,height:null,transparent:null},f={delay:500,copy:!1},e.prototype.setOption=function(t,e){return this.options[t]=e,null==this._canvas||"width"!==t&&"height"!==t?void 0:this._canvas[t]=e},e.prototype.setOptions=function(t){var e,n;return function(r){for(e in t)i(t,e)&&(n=t[e],r.push(this.setOption(e,n)));return r}.call(this,[])},e.prototype.addFrame=function(t,e){var n,r;null==e&&(e={}),n={},n.transparent=this.options.transparent;for(r in f)n[r]=e[r]||f[r];if(null!=this.options.width||this.setOption("width",t.width),null!=this.options.height||this.setOption("height",t.height),"undefined"!=typeof ImageData&&null!=ImageData&&t instanceof ImageData)n.data=t.data;else if("undefined"!=typeof CanvasRenderingContext2D&&null!=CanvasRenderingContext2D&&t instanceof CanvasRenderingContext2D||"undefined"!=typeof WebGLRenderingContext&&null!=WebGLRenderingContext&&t instanceof WebGLRenderingContext)e.copy?n.data=this.getContextData(t):n.context=t;else{if(null==t.childNodes)throw new Error("Invalid image");e.copy?n.data=this.getImageData(t):n.image=t}return this.frames.push(n)},e.prototype.render=function(){var t,e;if(this.running)throw new Error("Already running");if(null==this.options.width||null==this.options.height)throw new Error("Width and height must be set prior to rendering");this.running=!0,this.nextFrame=0,this.finishedFrames=0,this.imageParts=function(e){for(var n=function(){var t;t=[];for(var e=0;0<=this.frames.length?e<this.frames.length:e>this.frames.length;0<=this.frames.length?++e:--e)t.push(e);return t}.apply(this,arguments),r=0,a=n.length;r<a;++r)t=n[r],e.push(null);return e}.call(this,[]),e=this.spawnWorkers();for(var n=function(){var t;t=[];for(var n=0;0<=e?n<e:n>e;0<=e?++n:--n)t.push(n);return t}.apply(this,arguments),r=0,a=n.length;r<a;++r)t=n[r],this.renderNextFrame();return this.emit("start"),this.emit("progress",0)},e.prototype.abort=function(){for(var t;t=this.activeWorkers.shift(),null!=t;)console.log("killing active worker"),t.terminate();return this.running=!1,this.emit("abort")},e.prototype.spawnWorkers=function(){var t;return t=Math.min(this.options.workers,this.frames.length),function(){var e;e=[];for(var n=this.freeWorkers.length;this.freeWorkers.length<=t?n<t:n>t;this.freeWorkers.length<=t?++n:--n)e.push(n);return e}.apply(this,arguments).forEach(function(t){return function(e){var n;return console.log("spawning worker "+e),n=new Worker(t.options.workerScript),n.onmessage=function(t){return function(e){return t.activeWorkers.splice(t.activeWorkers.indexOf(n),1),t.freeWorkers.push(n),t.frameFinished(e.data)}}(t),t.freeWorkers.push(n)}}(this)),t},e.prototype.frameFinished=function(t){return console.log("frame "+t.index+" finished - "+this.activeWorkers.length+" active"),this.finishedFrames++,this.emit("progress",this.finishedFrames/this.frames.length),this.imageParts[t.index]=t,o(null,this.imageParts)?this.renderNextFrame():this.finishRendering()},e.prototype.finishRendering=function(){var t,e,n,r,a,i,o;a=0;for(var s=0,u=this.imageParts.length;s<u;++s)e=this.imageParts[s],a+=(e.data.length-1)*e.pageSize+e.cursor;a+=e.pageSize-e.cursor,console.log("rendering finished - filesize "+Math.round(a/1e3)+"kb"),t=new Uint8Array(a),i=0;for(var l=0,c=this.imageParts.length;l<c;++l){e=this.imageParts[l];for(var f=0,h=e.data.length;f<h;++f)o=e.data[f],n=f,t.set(o,i),i+=n===e.data.length-1?e.cursor:e.pageSize}return r=new Blob([t],{type:"image/gif"}),this.emit("finished",r,t)},e.prototype.renderNextFrame=function(){var t,e,n;if(0===this.freeWorkers.length)throw new Error("No free workers");return this.nextFrame>=this.frames.length?void 0:(t=this.frames[this.nextFrame++],n=this.freeWorkers.shift(),e=this.getTask(t),console.log("starting frame "+(e.index+1)+" of "+this.frames.length),this.activeWorkers.push(n),n.postMessage(e))},e.prototype.getContextData=function(t){return t.getImageData(0,0,this.options.width,this.options.height).data},e.prototype.getImageData=function(t){var e;return null!=this._canvas||(this._canvas=document.createElement("canvas"),this._canvas.width=this.options.width,this._canvas.height=this.options.height),e=this._canvas.getContext("2d"),e.setFill=this.options.background,e.fillRect(0,0,this.options.width,this.options.height),e.drawImage(t,0,0),this.getContextData(e)},e.prototype.getTask=function(t){var e,n;if(e=this.frames.indexOf(t),n={index:e,last:e===this.frames.length-1,delay:t.delay,transparent:t.transparent,width:this.options.width,height:this.options.height,quality:this.options.quality,repeat:this.options.repeat,canTransfer:"chrome"===u.name},null!=t.data)n.data=t.data;else if(null!=t.context)n.data=this.getContextData(t.context);else{if(null==t.image)throw new Error("Invalid frame");n.data=this.getImageData(t.image)}return n},e}(c),t.exports=h}),e.define("/browser.coffee",function(t,e,n,r){var a,i,o,s,u;s=navigator.userAgent.toLowerCase(),o=navigator.platform.toLowerCase(),u=s.match(/(opera|ie|firefox|chrome|version)[\s\/:]([\w\d\.]+)?.*?(safari|version[\s\/:]([\w\d\.]+)|$)/)||[null,"unknown",0],i="ie"===u[1]&&document.documentMode,a={name:"version"===u[1]?u[3]:u[1],version:i||parseFloat("opera"===u[1]&&u[4]?u[4]:u[2]),platform:{name:s.match(/ip(?:ad|od|hone)/)?"ios":(s.match(/(?:webos|android)/)||o.match(/mac|win|linux/)||["other"])[0]}},a[a.name]=!0,a[a.name+parseInt(a.version,10)]=!0,a.platform[a.platform.name]=!0,t.exports=a}),e.define("events",function(t,e,r,a){n.EventEmitter||(n.EventEmitter=function(){});var i=e.EventEmitter=n.EventEmitter,o="function"==typeof Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},s=10;i.prototype.setMaxListeners=function(t){this._events||(this._events={}),this._events.maxListeners=t},i.prototype.emit=function(t){if("error"===t&&(!this._events||!this._events.error||o(this._events.error)&&!this._events.error.length))throw arguments[1]instanceof Error?arguments[1]:new Error("Uncaught, unspecified 'error' event.");if(!this._events)return!1;var e=this._events[t];if(!e)return!1;if("function"!=typeof e){if(o(e)){for(var n=Array.prototype.slice.call(arguments,1),r=e.slice(),a=0,i=r.length;a<i;a++)r[a].apply(this,n);return!0}return!1}switch(arguments.length){case 1:e.call(this);break;case 2:e.call(this,arguments[1]);break;case 3:e.call(this,arguments[1],arguments[2]);break;default:var n=Array.prototype.slice.call(arguments,1);e.apply(this,n)}return!0},i.prototype.addListener=function(t,e){if("function"!=typeof e)throw new Error("addListener only takes instances of Function");if(this._events||(this._events={}),this.emit("newListener",t,e),this._events[t])if(o(this._events[t])){if(!this._events[t].warned){var n;n=void 0!==this._events.maxListeners?this._events.maxListeners:s,n&&n>0&&this._events[t].length>n&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),console.trace())}this._events[t].push(e)}else this._events[t]=[this._events[t],e];else this._events[t]=e;return this},i.prototype.on=i.prototype.addListener,i.prototype.once=function(t,e){var n=this;return n.on(t,function r(){n.removeListener(t,r),e.apply(this,arguments)}),this},i.prototype.removeListener=function(t,e){if("function"!=typeof e)throw new Error("removeListener only takes instances of Function");if(!this._events||!this._events[t])return this;var n=this._events[t];if(o(n)){var r=n.indexOf(e);if(r<0)return this;n.splice(r,1),0==n.length&&delete this._events[t]}else this._events[t]===e&&delete this._events[t];return this},i.prototype.removeAllListeners=function(t){return t&&this._events&&this._events[t]&&(this._events[t]=null),this},i.prototype.listeners=function(t){return this._events||(this._events={}),this._events[t]||(this._events[t]=[]),o(this._events[t])||(this._events[t]=[this._events[t]]),this._events[t]}}),t.GIF=e("/gif.coffee")}.call(this,this),function(){"use strict";function i(t){return t&&t.Object===Object?t:null}function o(t){return String("0000000"+t).slice(-7)}function s(){function t(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()}function u(t){var e={};this.settings=t,this.on=function(t,n){e[t]=n},this.emit=function(t){var n=e[t];n&&n.apply(null,Array.prototype.slice.call(arguments,1))},this.filename=t.name||s(),this.extension="",this.mimeType=""}function l(t){u.call(this,t),this.extension=".tar",this.mimeType="application/x-tar",this.fileExtension="",this.baseFilename=this.filename,this.tape=null,this.count=0,this.part=1}function c(t){l.call(this,t),this.type="image/png",this.fileExtension=".png"}function f(t){l.call(this,t),this.type="image/jpeg",this.fileExtension=".jpg",this.quality=t.quality/100||.8}function h(t){var e=document.createElement("canvas");"image/webp"!==e.toDataURL("image/webp").substr(5,10)&&console.log("WebP not supported - try another export format"),u.call(this,t),t.quality=t.quality/100||.8,this.extension=".webm",this.mimeType="video/webm",this.baseFilename=this.filename,this.frames=[],this.part=1}function d(t){u.call(this,t),t.quality=t.quality/100||.8,this.encoder=new FFMpegServer.Video(t),this.encoder.on("process",function(){this.emit("process")}.bind(this)),this.encoder.on("finished",function(t,e){var n=this.callback;n&&(this.callback=void 0,n(t,e))}.bind(this)),this.encoder.on("progress",function(t){this.settings.onProgress&&this.settings.onProgress(t)}.bind(this)),this.encoder.on("error",function(t){alert(JSON.stringify(t,null,2))}.bind(this))}function p(t){u.call(this,t),this.framerate=this.settings.framerate,this.type="video/webm",this.extension=".webm",this.stream=null,this.mediaRecorder=null,this.chunks=[]}function g(t){u.call(this,t),t.quality=31-(30*t.quality/100||10),t.workers=t.workers||4,this.extension=".gif",this.mimeType="image/gif",this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.sizeSet=!1,this.encoder=new GIF({workers:t.workers,quality:t.quality,workerScript:t.workersPath+"gif.worker.js"}),this.encoder.on("progress",function(t){this.settings.onProgress&&this.settings.onProgress(t)}.bind(this)),this.encoder.on("finished",function(t){var e=this.callback;e&&(this.callback=void 0,e(t))}.bind(this))}function m(t){function e(){function t(){return this._hooked||(this._hooked=!0,this._hookedTime=this.currentTime||0,this.pause(),nt.push(this)),this._hookedTime+L.startTime}x("Capturer start"),R=window.Date.now(),T=R+L.startTime,F=window.performance.now(),D=F+L.startTime,window.Date.prototype.getTime=function(){return T},window.Date.now=function(){return T},window.setTimeout=function(t,e){var n={callback:t,time:e,triggerTime:T+e};return P.push(n),x("Timeout set to "+n.time),n},window.clearTimeout=function(t){for(var e=0;e<P.length;e++)P[e]!=t||(P.splice(e,1),x("Timeout cleared"))},window.setInterval=function(t,e){var n={callback:t,time:e,triggerTime:T+e};return C.push(n),x("Interval set to "+n.time),n},window.clearInterval=function(t){return x("clear Interval"),null},window.requestAnimationFrame=function(t){U.push(t)},window.performance.now=function(){return D};try{Object.defineProperty(HTMLVideoElement.prototype,"currentTime",{get:t}),Object.defineProperty(HTMLAudioElement.prototype,"currentTime",{get:t})}catch(t){x(t)}}function n(){e(),N.start(),z=!0}function r(){z=!1,N.stop(),s()}function i(t,e){Z(t,0,e)}function o(){i(_)}function s(){x("Capturer stop"),window.setTimeout=Z,window.setInterval=Q,window.clearTimeout=K,window.requestAnimationFrame=J,window.Date.prototype.getTime=et,window.Date.now=$,window.performance.now=tt}function u(){var t=O/L.framerate;z&&(L.frameLimit&&O>=L.frameLimit||L.timeLimit&&t>=L.timeLimit)&&(r(),b());var e=new Date(null);e.setSeconds(t),L.motionBlurFrames>2?B.textContent="CCapture "+L.format+" | "+O+" frames ("+j+" inter) | "+e.toISOString().substr(11,8):B.textContent="CCapture "+L.format+" | "+O+" frames | "+e.toISOString().substr(11,8)}function l(t){Y.width===t.width&&Y.height===t.height||(Y.width=t.width,Y.height=t.height,V=new Uint16Array(Y.height*Y.width*4),H.fillStyle="#0",H.fillRect(0,0,Y.width,Y.height))}function m(t){H.drawImage(t,0,0),q=H.getImageData(0,0,Y.width,Y.height);for(var e=0;e<V.length;e+=4)V[e]+=q.data[e],V[e+1]+=q.data[e+1],V[e+2]+=q.data[e+2];j++}function v(){for(var t=q.data,e=0;e<V.length;e+=4)t[e]=2*V[e]/L.motionBlurFrames,t[e+1]=2*V[e+1]/L.motionBlurFrames,t[e+2]=2*V[e+2]/L.motionBlurFrames;H.putImageData(q,0,0),N.add(Y),O++,j=0,x("Full MB Frame! "+O+" "+T);for(var e=0;e<V.length;e+=4)V[e]=0,V[e+1]=0,V[e+2]=0;gc()}function y(t){z&&(L.motionBlurFrames>2?(l(t),m(t),j>=.5*L.motionBlurFrames?v():o()):(N.add(t),O++,x("Full Frame! "+O)))}function _(){var t=1e3/L.framerate,e=(O+j/L.motionBlurFrames)*t;T=R+e,D=F+e,nt.forEach(function(t){t._hookedTime=e/1e3}),u(),x("Frame: "+O+" "+j);for(var n=0;n<P.length;n++)T>=P[n].triggerTime&&(i(P[n].callback),P.splice(n,1));for(var n=0;n<C.length;n++)T>=C[n].triggerTime&&(i(C[n].callback),C[n].triggerTime+=C[n].time);U.forEach(function(t){i(t,T-A)}),U=[]}function b(t){t||(t=function(t){return a(t,N.filename+N.extension,N.mimeType),!1}),N.save(t)}function x(t){I&&console.log(t)}function w(t,e){k[t]=e}function E(t){var e=k[t];e&&e.apply(null,Array.prototype.slice.call(arguments,1))}function M(t){E("progress",t)}var I,S,T,R,D,F,o,N,L=t||{},P=(new Date,[]),C=[],O=0,j=0,U=[],z=!1,k={};L.framerate=L.framerate||60,L.motionBlurFrames=2*(L.motionBlurFrames||1),I=L.verbose||!1,S=L.display||!1,L.step=1e3/L.framerate,L.timeLimit=L.timeLimit||0,L.frameLimit=L.frameLimit||0,L.startTime=L.startTime||0;var B=document.createElement("div");B.style.position="absolute",B.style.left=B.style.top=0,B.style.backgroundColor="black",B.style.fontFamily="monospace",B.style.fontSize="11px",B.style.padding="5px",B.style.color="red",B.style.zIndex=1e5,L.display&&document.body.appendChild(B);var V,q,Y=document.createElement("canvas"),H=Y.getContext("2d");x("Step is set to "+L.step+"ms");var G={gif:g,webm:h,ffmpegserver:d,png:c,jpg:f,"webm-mediarecorder":p},X=G[L.format];if(!X)throw"Error: Incorrect or missing format: Valid formats are "+Object.keys(G).join(", ");if(N=new X(L),N.step=o,N.on("process",_),N.on("progress",M),"performance"in window==0&&(window.performance={}),Date.now=Date.now||function(){return(new Date).getTime()},"now"in window.performance==0){var W=Date.now();performance.timing&&performance.timing.navigationStart&&(W=performance.timing.navigationStart),window.performance.now=function(){return Date.now()-W}}var Z=window.setTimeout,Q=window.setInterval,K=window.clearTimeout,J=window.requestAnimationFrame,$=window.Date.now,tt=window.performance.now,et=window.Date.prototype.getTime,nt=[];return{start:n,capture:y,stop:r,save:b,on:w}}var v={function:!0,object:!0},y=(parseFloat,parseInt,v[typeof r]&&r&&!r.nodeType?r:void 0),_=v[typeof n]&&n&&!n.nodeType?n:void 0,b=_&&_.exports===y?y:void 0,x=i(y&&_&&"object"==typeof e&&e),w=i(v[typeof self]&&self),E=i(v[typeof window]&&window),M=i(v[typeof this]&&this),I=x||E!==(M&&M.window)&&E||w||M||Function("return this")();"gc"in window||(window.gc=function(){}),HTMLCanvasElement.prototype.toBlob||Object.defineProperty(HTMLCanvasElement.prototype,"toBlob",{value:function(t,e,n){for(var r=atob(this.toDataURL(e,n).split(",")[1]),a=r.length,i=new Uint8Array(a),o=0;o<a;o++)i[o]=r.charCodeAt(o);t(new Blob([i],{type:e||"image/png"}))}}),function(){if("performance"in window==0&&(window.performance={}),Date.now=Date.now||function(){return(new Date).getTime()},"now"in window.performance==0){var t=Date.now();performance.timing&&performance.timing.navigationStart&&(t=performance.timing.navigationStart),window.performance.now=function(){return Date.now()-t}}}();var A=window.Date.now();u.prototype.start=function(){},u.prototype.stop=function(){},u.prototype.add=function(){},u.prototype.save=function(){},u.prototype.dispose=function(){},u.prototype.safeToProceed=function(){return!0},u.prototype.step=function(){console.log("Step not set!")},l.prototype=Object.create(u.prototype),l.prototype.start=function(){this.dispose()},l.prototype.add=function(t){var e=new FileReader;e.onload=function(){this.tape.append(o(this.count)+this.fileExtension,new Uint8Array(e.result)),this.count++,this.settings.autoSaveTime>0&&this.count/this.settings.framerate>=this.settings.autoSaveTime?this.save(function(t){this.filename=this.baseFilename+"-part-"+o(this.part),a(t,this.filename+this.extension,this.mimeType),this.dispose(),this.part++,this.filename=this.baseFilename+"-part-"+o(this.part),this.step()}.bind(this)):this.step()}.bind(this),e.readAsArrayBuffer(t)},l.prototype.save=function(t){this.tape.blocks.length&&t(this.tape.save())},l.prototype.dispose=function(){this.tape=new Tar,this.count=0},c.prototype=Object.create(l.prototype),c.prototype.add=function(t){t.toBlob(function(t){l.prototype.add.call(this,t)}.bind(this),this.type)},f.prototype=Object.create(l.prototype),f.prototype.add=function(t){t.toBlob(function(t){l.prototype.add.call(this,t)}.bind(this),this.type,this.quality)},h.prototype=Object.create(u.prototype),h.prototype.start=function(t){this.dispose()},h.prototype.add=function(t){this.frames.push(t.toDataURL("image/webp",this.quality)),this.settings.autoSaveTime>0&&this.frames.length/this.settings.framerate>=this.settings.autoSaveTime?this.save(function(t){this.filename=this.baseFilename+"-part-"+o(this.part),a(t,this.filename+this.extension,this.mimeType),this.dispose(),this.part++,this.filename=this.baseFilename+"-part-"+o(this.part),this.step()}.bind(this)):this.step()},h.prototype.save=function(t){if(this.frames.length){var e=Whammy.fromImageArray(this.frames,this.settings.framerate),n=new Blob([e],{type:"octet/stream"});t(n)}},h.prototype.dispose=function(t){this.frames=[]},d.prototype=Object.create(u.prototype),d.prototype.start=function(){this.encoder.start(this.settings)},d.prototype.add=function(t){this.encoder.add(t)},d.prototype.save=function(t){this.callback=t,this.encoder.end()},d.prototype.safeToProceed=function(){return this.encoder.safeToProceed()},p.prototype=Object.create(u.prototype),p.prototype.add=function(t){this.stream||(this.stream=t.captureStream(this.framerate),this.mediaRecorder=new MediaRecorder(this.stream),this.mediaRecorder.start(),this.mediaRecorder.ondataavailable=function(t){this.chunks.push(t.data)}.bind(this)),this.step()},p.prototype.save=function(t){this.mediaRecorder.onstop=function(e){var n=new Blob(this.chunks,{type:"video/webm"});this.chunks=[],t(n)}.bind(this),this.mediaRecorder.stop()},g.prototype=Object.create(u.prototype),g.prototype.add=function(t){this.sizeSet||(this.encoder.setOption("width",t.width),this.encoder.setOption("height",t.height),this.sizeSet=!0),this.canvas.width=t.width,this.canvas.height=t.height,this.ctx.drawImage(t,0,0),this.encoder.addFrame(this.ctx,{copy:!0,delay:this.settings.step}),this.step()},g.prototype.save=function(t){this.callback=t,this.encoder.render()},(E||w||{}).CCapture=m,"function"==typeof t&&"object"==typeof t.amd&&t.amd?t(function(){return m}):y&&_?(b&&((_.exports=m).CCapture=m),y.CCapture=m):I.CCapture=m}()}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),
Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=t("gl-shader"),s=r(o),u=t("gl-texture2d"),l=(r(u),t("gl-fbo")),c=r(l),f=t("shader-vr-effect"),h=r(f),d=t("shader-vr-orbit-controls"),p=r(d),g=t("shader-webvr-manager"),m=r(g),v=t("canvas-fit"),y=r(v),_=t("tween.js"),b=r(_),x=t("gl-context"),w=r(x),E=t("./utils"),M=(t("./camera-tweens"),t("ccapture.js")),I=r(M),A=t("soundcloud-badge"),S=r(A),T=t("gl-audio-analyser"),R=r(T),D=t("a-big-triangle"),F=r(D),N=t("object-assign"),L=r(N),P=t("defined"),C=r(P),O=t("gl-matrix"),j=t("./presets.json"),U=(r(j),t("glslify")),z=Math.min(2,(0,C.default)(window.devicePixelRatio,1)),k="ded451c6d8f9ff1c62f72523f49dab68",B=60,V=0,q=50,Y=!1,H=!1,G=!1,X={};Y&&(X=new I.default({format:"jpg",framerate:B,name:"kifs-dodeca-introspective-reflective-test1",autoSaveTime:5,quality:90,startTime:V,timeLimit:q,verbose:!0}));var W=1e3*V;window.capturer=X;var Z=window.setTimeout,Q=window.clearTimeout,K=window.setInterval,J=window.clearInterval,$=window.requestAnimationFrame,tt=window.performance.now,et=((1+Math.sqrt(5))/2,function(){function t(){arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a(this,t);var e=document.createElement("canvas");document.body.appendChild(e),e.style.display="none",(0,E.isAndroid)()||e.addEventListener("touchstart",function(t){t.preventDefault()});var n=(0,w.default)(e);this.LOOKAT=!0;var r={offset:{x:.669,y:-.654,z:1.618},d:5,scale:.9,rot2angle:[.685,.583,2.259],cameraAngles:[0,0,0]};this.d=r.d,this.cameraRo=O.vec3.fromValues(1,1,1),this.epsilon=r.epsilon||1e-4,this.offset=r.offset?O.vec3.fromValues(r.offset.x,r.offset.y,r.offset.z):O.vec3.fromValues(0,0,0),this.scale=r.scale,this.rot2angle=r.rot2angle||[0,0,0],this.cameraAngles=r.cameraAngles||[0,0,0],this.setupAnimation(r),this.glInit(n);var i=new h.default(n),o=new p.default(n),s={hideButton:!0,isUndistorted:!1},u=new m.default({domElement:e},i,s),l=void 0;(0,L.default)(this,{canvas:e,gl:n,effect:i,controls:o,manager:u,vrDisplay:l,currentRAF:null,running:!1}),this.stageReady=this.setupStage(),this.loaded=Promise.all([this.stageReady])}return i(t,[{key:"getDimensions",value:function(){return[z*window.innerWidth,z*window.innerHeight]}},{key:"setupFBOs",value:function(t){var e=this.getDimensions();this.state=[(0,c.default)(t,e,{depth:!1}),(0,c.default)(t,e,{depth:!1}),(0,c.default)(t,e,{depth:!1})],this.state[0].color.magFilter=t.LINEAR,this.state[0].color.minFilter=t.LINEAR,this.state[1].color.magFilter=t.LINEAR,this.state[1].color.minFilter=t.LINEAR,this.state[2].color.magFilter=t.LINEAR,this.state[2].color.minFilter=t.LINEAR}},{key:"setupAnimation",value:function(t){var e=new b.default.Tween(this);e.to({epsilon:.001},1e4).easing(b.default.Easing.Quadratic.InOut);var n=new b.default.Tween(this);n.to({epsilon:6e-5},6e3).easing(b.default.Easing.Quadratic.InOut);var r=new b.default.Tween(this);r.to({epsilon:9e-6},5e3).easing(b.default.Easing.Quadratic.InOut);var a=new b.default.Tween(this);a.delay(2e3).to({epsilon:.005},1e4).easing(b.default.Easing.Quadratic.InOut);var i=new b.default.Tween(this.cameraRo);i.to([1.91,.092,1.102],2e4).easing(b.default.Easing.Sinusoidal.Out);var o=new b.default.Tween(this.cameraRo).to([2.92,0,0],2e4).easing(b.default.Easing.Sinusoidal.Out);i.chain(o),i.start(0);var s=this,u=new b.default.Tween([-1.579,2.148,1.57]);u.to([-.124,.917,.121],1e4).onUpdate(function(){s.cameraAngles[0]=this[0],s.cameraAngles[1]=this[1],s.cameraAngles[2]=this[2]}).delay(1e4).easing(b.default.Easing.Quadratic.InOut);var l=new b.default.Tween([0,0,0]);l.to([0,Math.PI/2,0],5e3).onUpdate(function(){s.cameraAngles[0]=this[0],s.cameraAngles[1]=this[1],s.cameraAngles[2]=this[2]}).easing(b.default.Easing.Quadratic.InOut).delay(0);var c=new b.default.Tween(this.rot2angle);c.to([1.899,1.483,2.315],2e4).easing(b.default.Easing.Quadratic.InOut);var f=new b.default.Tween(this.rot2angle).to([2.359,1.483,2.315],2e4).easing(b.default.Easing.Quadratic.InOut);c.chain(f),c.start(0);var h=new b.default.Tween(this);h.to({scale:1.72},1e4).easing(b.default.Easing.Quadratic.InOut);var d=new b.default.Tween(this.offset).delay(2e4).to([1.441,.669,-.654],2e4).easing(b.default.Easing.Quadratic.InOut);d.start(0)}},{key:"setupAudio",value:function(){var t=this;return new Promise(function(e,n){(0,S.default)({client_id:k,song:"https://soundcloud.com/shang-lin/swanky",dark:!0,getFonts:!0},function(r,a,i,o){if(r)throw n(r),r;var s=new Audio;s.crossOrigin="Anonymous",s.src=a,s.addEventListener("canplay",function(){console.log("playing!"),t.analyser=(0,R.default)(t.gl,s),s.play()}),t.audio=s,e(),console.log(i)})})}},{key:"enableEvents",value:function(){Y||(this.resizeBound=this.resizeBound||this.resize.bind(this),window.addEventListener("resize",this.resizeBound,!0),window.addEventListener("vrdisplaypresentchange",this.resizeBound,!0))}},{key:"disposeEvents",value:function(){window.removeEventListener("resize",this.resizeBound,!0),window.removeEventListener("vrdisplaypresentchange",this.resizeBound,!0)}},{key:"glInit",value:function(t){t.disable(t.DEPTH_TEST),this.shader=(0,s.default)(t,U(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec2 position;\nuniform vec2 resolution;\nvarying vec2 fragCoord;\n\nvoid main() {\n    // Adjust coordinates to (-1, -1) -> (1, 1)\n    fragCoord = position.xy * resolution / max(resolution.y, resolution.x);\n\n    gl_Position = vec4(position.xy, 0.0, 1.0);\n}\n"]),U(['#define PI 3.1415926536\n\n// #define debugMapCalls\n// #define debugMapMaxed\n#define SS 2\n\nprecision highp float;\n#define GLSLIFY 1\n\nvarying vec2 fragCoord;\nuniform vec2 resolution;\nuniform float time;\nuniform vec3 cOffset;\nuniform vec3 cameraRo;\nuniform mat4 cameraMatrix;\nuniform mat4 orientation;\nuniform mat4 projectionMatrix;\n\n// KIFS\nuniform mat4 kifsM;\nuniform float scale;\nuniform vec3 offset;\n\n// Greatest precision = 0.000001;\nuniform float epsilon;\n#define maxSteps 1024\n#define maxDistance 50.\n#define background vec3(0.,0.,0.)\n\n#define slowTime time * .01\n#define Iterations 8\n\nvec3 lightPos = normalize(vec3(1., 0., 0.));\n\nconst vec3 un = vec3(1., -1., 0.);\n\n// Utils\nfloat inverse(float m) {\n  return 1.0 / m;\n}\n\nmat2 inverse(mat2 m) {\n  return mat2(m[1][1],-m[0][1],\n             -m[1][0], m[0][0]) / (m[0][0]*m[1][1] - m[0][1]*m[1][0]);\n}\n\nmat3 inverse(mat3 m) {\n  float a00 = m[0][0], a01 = m[0][1], a02 = m[0][2];\n  float a10 = m[1][0], a11 = m[1][1], a12 = m[1][2];\n  float a20 = m[2][0], a21 = m[2][1], a22 = m[2][2];\n\n  float b01 = a22 * a11 - a12 * a21;\n  float b11 = -a22 * a10 + a12 * a20;\n  float b21 = a21 * a10 - a11 * a20;\n\n  float det = a00 * b01 + a01 * b11 + a02 * b21;\n\n  return mat3(b01, (-a22 * a01 + a02 * a21), (a12 * a01 - a02 * a11),\n              b11, (a22 * a00 - a02 * a20), (-a12 * a00 + a02 * a10),\n              b21, (-a21 * a00 + a01 * a20), (a11 * a00 - a01 * a10)) / det;\n}\n\nmat4 inverse(mat4 m) {\n  float\n      a00 = m[0][0], a01 = m[0][1], a02 = m[0][2], a03 = m[0][3],\n      a10 = m[1][0], a11 = m[1][1], a12 = m[1][2], a13 = m[1][3],\n      a20 = m[2][0], a21 = m[2][1], a22 = m[2][2], a23 = m[2][3],\n      a30 = m[3][0], a31 = m[3][1], a32 = m[3][2], a33 = m[3][3],\n\n      b00 = a00 * a11 - a01 * a10,\n      b01 = a00 * a12 - a02 * a10,\n      b02 = a00 * a13 - a03 * a10,\n      b03 = a01 * a12 - a02 * a11,\n      b04 = a01 * a13 - a03 * a11,\n      b05 = a02 * a13 - a03 * a12,\n      b06 = a20 * a31 - a21 * a30,\n      b07 = a20 * a32 - a22 * a30,\n      b08 = a20 * a33 - a23 * a30,\n      b09 = a21 * a32 - a22 * a31,\n      b10 = a21 * a33 - a23 * a31,\n      b11 = a22 * a33 - a23 * a32,\n\n      det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n\n  return mat4(\n      a11 * b11 - a12 * b10 + a13 * b09,\n      a02 * b10 - a01 * b11 - a03 * b09,\n      a31 * b05 - a32 * b04 + a33 * b03,\n      a22 * b04 - a21 * b05 - a23 * b03,\n      a12 * b08 - a10 * b11 - a13 * b07,\n      a00 * b11 - a02 * b08 + a03 * b07,\n      a32 * b02 - a30 * b05 - a33 * b01,\n      a20 * b05 - a22 * b02 + a23 * b01,\n      a10 * b10 - a11 * b08 + a13 * b06,\n      a01 * b08 - a00 * b10 - a03 * b06,\n      a30 * b04 - a31 * b02 + a33 * b00,\n      a21 * b02 - a20 * b04 - a23 * b00,\n      a11 * b07 - a10 * b09 - a12 * b06,\n      a00 * b09 - a01 * b07 + a02 * b06,\n      a31 * b01 - a30 * b03 - a32 * b00,\n      a20 * b03 - a21 * b01 + a22 * b00) / det;\n}\n\n// getRayDirection source:\n// https://bitbucket.org/jimbo00000/opengl-with-luajit/src/33a9abcd04a468d9974d7b35f869d3b0e8e696f4/scene/shadertoy_scene2.lua?at=master&fileviewer=file-view-default#shadertoy_scene2.lua-215\n// Construct the usual eye ray frustum oriented down the negative z axis.\n// http://antongerdelan.net/opengl/raycasting.html\nvec3 getRayDirection(vec2 uv, in mat4 projectionMatrix) {\n    vec4 ray_clip = vec4(uv.x, uv.y, -1., 1.);\n    vec4 ray_eye = inverse(projectionMatrix) * ray_clip;\n    return normalize(vec3(ray_eye.x, ray_eye.y, -1.));\n}\n\n//\n// Description : Array and textureless GLSL 2D simplex noise function.\n//      Author : Ian McEwan, Ashima Arts.\n//  Maintainer : ijm\n//     Lastmod : 20110822 (ijm)\n//     License : Copyright (C) 2011 Ashima Arts. All rights reserved.\n//               Distributed under the MIT License. See LICENSE file.\n//               https://github.com/ashima/webgl-noise\n//\n\nvec3 mod289_2(vec3 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec2 mod289_2(vec2 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec3 permute_2(vec3 x) {\n  return mod289_2(((x*34.0)+1.0)*x);\n}\n\nfloat snoise_1(vec2 v)\n  {\n  const vec4 C = vec4(0.211324865405187,  // (3.0-sqrt(3.0))/6.0\n                      0.366025403784439,  // 0.5*(sqrt(3.0)-1.0)\n                     -0.577350269189626,  // -1.0 + 2.0 * C.x\n                      0.024390243902439); // 1.0 / 41.0\n// First corner\n  vec2 i  = floor(v + dot(v, C.yy) );\n  vec2 x0 = v -   i + dot(i, C.xx);\n\n// Other corners\n  vec2 i1;\n  //i1.x = step( x0.y, x0.x ); // x0.x > x0.y ? 1.0 : 0.0\n  //i1.y = 1.0 - i1.x;\n  i1 = (x0.x > x0.y) ? vec2(1.0, 0.0) : vec2(0.0, 1.0);\n  // x0 = x0 - 0.0 + 0.0 * C.xx ;\n  // x1 = x0 - i1 + 1.0 * C.xx ;\n  // x2 = x0 - 1.0 + 2.0 * C.xx ;\n  vec4 x12 = x0.xyxy + C.xxzz;\n  x12.xy -= i1;\n\n// Permutations\n  i = mod289_2(i); // Avoid truncation effects in permutation\n  vec3 p = permute_2( permute_2( i.y + vec3(0.0, i1.y, 1.0 ))\n    + i.x + vec3(0.0, i1.x, 1.0 ));\n\n  vec3 m = max(0.5 - vec3(dot(x0,x0), dot(x12.xy,x12.xy), dot(x12.zw,x12.zw)), 0.0);\n  m = m*m ;\n  m = m*m ;\n\n// Gradients: 41 points uniformly over a line, mapped onto a diamond.\n// The ring size 17*17 = 289 is close to a multiple of 41 (41*7 = 287)\n\n  vec3 x = 2.0 * fract(p * C.www) - 1.0;\n  vec3 h = abs(x) - 0.5;\n  vec3 ox = floor(x + 0.5);\n  vec3 a0 = x - ox;\n\n// Normalise gradients implicitly by scaling m\n// Approximation of: m *= inversesqrt( a0*a0 + h*h );\n  m *= 1.79284291400159 - 0.85373472095314 * ( a0*a0 + h*h );\n\n// Compute final noise value at P\n  vec3 g;\n  g.x  = a0.x  * x0.x  + h.x  * x0.y;\n  g.yz = a0.yz * x12.xz + h.yz * x12.yw;\n  return 130.0 * dot(m, g);\n}\n\n//\n// Description : Array and textureless GLSL 2D/3D/4D simplex\n//               noise functions.\n//      Author : Ian McEwan, Ashima Arts.\n//  Maintainer : ijm\n//     Lastmod : 20110822 (ijm)\n//     License : Copyright (C) 2011 Ashima Arts. All rights reserved.\n//               Distributed under the MIT License. See LICENSE file.\n//               https://github.com/ashima/webgl-noise\n//\n\nvec3 mod289_1(vec3 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 mod289_1(vec4 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 permute_1(vec4 x) {\n     return mod289_1(((x*34.0)+1.0)*x);\n}\n\nvec4 taylorInvSqrt_1(vec4 r)\n{\n  return 1.79284291400159 - 0.85373472095314 * r;\n}\n\nfloat snoise_0(vec3 v)\n  {\n  const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;\n  const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);\n\n// First corner\n  vec3 i  = floor(v + dot(v, C.yyy) );\n  vec3 x0 =   v - i + dot(i, C.xxx) ;\n\n// Other corners\n  vec3 g_0 = step(x0.yzx, x0.xyz);\n  vec3 l = 1.0 - g_0;\n  vec3 i1 = min( g_0.xyz, l.zxy );\n  vec3 i2 = max( g_0.xyz, l.zxy );\n\n  //   x0 = x0 - 0.0 + 0.0 * C.xxx;\n  //   x1 = x0 - i1  + 1.0 * C.xxx;\n  //   x2 = x0 - i2  + 2.0 * C.xxx;\n  //   x3 = x0 - 1.0 + 3.0 * C.xxx;\n  vec3 x1 = x0 - i1 + C.xxx;\n  vec3 x2 = x0 - i2 + C.yyy; // 2.0*C.x = 1/3 = C.y\n  vec3 x3 = x0 - D.yyy;      // -1.0+3.0*C.x = -0.5 = -D.y\n\n// Permutations\n  i = mod289_1(i);\n  vec4 p = permute_1( permute_1( permute_1(\n             i.z + vec4(0.0, i1.z, i2.z, 1.0 ))\n           + i.y + vec4(0.0, i1.y, i2.y, 1.0 ))\n           + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));\n\n// Gradients: 7x7 points over a square, mapped onto an octahedron.\n// The ring size 17*17 = 289 is close to a multiple of 49 (49*6 = 294)\n  float n_ = 0.142857142857; // 1.0/7.0\n  vec3  ns = n_ * D.wyz - D.xzx;\n\n  vec4 j = p - 49.0 * floor(p * ns.z * ns.z);  //  mod(p,7*7)\n\n  vec4 x_ = floor(j * ns.z);\n  vec4 y_ = floor(j - 7.0 * x_ );    // mod(j,N)\n\n  vec4 x = x_ *ns.x + ns.yyyy;\n  vec4 y = y_ *ns.x + ns.yyyy;\n  vec4 h = 1.0 - abs(x) - abs(y);\n\n  vec4 b0 = vec4( x.xy, y.xy );\n  vec4 b1 = vec4( x.zw, y.zw );\n\n  //vec4 s0 = vec4(lessThan(b0,0.0))*2.0 - 1.0;\n  //vec4 s1 = vec4(lessThan(b1,0.0))*2.0 - 1.0;\n  vec4 s0 = floor(b0)*2.0 + 1.0;\n  vec4 s1 = floor(b1)*2.0 + 1.0;\n  vec4 sh = -step(h, vec4(0.0));\n\n  vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;\n  vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;\n\n  vec3 p0 = vec3(a0.xy,h.x);\n  vec3 p1 = vec3(a0.zw,h.y);\n  vec3 p2 = vec3(a1.xy,h.z);\n  vec3 p3 = vec3(a1.zw,h.w);\n\n//Normalise gradients\n  vec4 norm = taylorInvSqrt_1(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));\n  p0 *= norm.x;\n  p1 *= norm.y;\n  p2 *= norm.z;\n  p3 *= norm.w;\n\n// Mix final noise value\n  vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);\n  m = m * m;\n  return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1),\n                                dot(p2,x2), dot(p3,x3) ) );\n  }\n\n//\n// GLSL textureless classic 3D noise "cnoise",\n// with an RSL-style periodic variant "pnoise".\n// Author:  Stefan Gustavson (stefan.gustavson@liu.se)\n// Version: 2011-10-11\n//\n// Many thanks to Ian McEwan of Ashima Arts for the\n// ideas for permutation and gradient selection.\n//\n// Copyright (c) 2011 Stefan Gustavson. All rights reserved.\n// Distributed under the MIT license. See LICENSE file.\n// https://github.com/ashima/webgl-noise\n//\n\nvec3 mod289_3(vec3 x)\n{\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 mod289_3(vec4 x)\n{\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 permute_3(vec4 x)\n{\n  return mod289_3(((x*34.0)+1.0)*x);\n}\n\nvec4 taylorInvSqrt_2(vec4 r)\n{\n  return 1.79284291400159 - 0.85373472095314 * r;\n}\n\nvec3 fade_1(vec3 t) {\n  return t*t*t*(t*(t*6.0-15.0)+10.0);\n}\n\n// Classic Perlin noise\nfloat cnoise_1(vec3 P)\n{\n  vec3 Pi0 = floor(P); // Integer part for indexing\n  vec3 Pi1 = Pi0 + vec3(1.0); // Integer part + 1\n  Pi0 = mod289_3(Pi0);\n  Pi1 = mod289_3(Pi1);\n  vec3 Pf0 = fract(P); // Fractional part for interpolation\n  vec3 Pf1 = Pf0 - vec3(1.0); // Fractional part - 1.0\n  vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);\n  vec4 iy = vec4(Pi0.yy, Pi1.yy);\n  vec4 iz0 = Pi0.zzzz;\n  vec4 iz1 = Pi1.zzzz;\n\n  vec4 ixy = permute_3(permute_3(ix) + iy);\n  vec4 ixy0 = permute_3(ixy + iz0);\n  vec4 ixy1 = permute_3(ixy + iz1);\n\n  vec4 gx0 = ixy0 * (1.0 / 7.0);\n  vec4 gy0 = fract(floor(gx0) * (1.0 / 7.0)) - 0.5;\n  gx0 = fract(gx0);\n  vec4 gz0 = vec4(0.5) - abs(gx0) - abs(gy0);\n  vec4 sz0 = step(gz0, vec4(0.0));\n  gx0 -= sz0 * (step(0.0, gx0) - 0.5);\n  gy0 -= sz0 * (step(0.0, gy0) - 0.5);\n\n  vec4 gx1 = ixy1 * (1.0 / 7.0);\n  vec4 gy1 = fract(floor(gx1) * (1.0 / 7.0)) - 0.5;\n  gx1 = fract(gx1);\n  vec4 gz1 = vec4(0.5) - abs(gx1) - abs(gy1);\n  vec4 sz1 = step(gz1, vec4(0.0));\n  gx1 -= sz1 * (step(0.0, gx1) - 0.5);\n  gy1 -= sz1 * (step(0.0, gy1) - 0.5);\n\n  vec3 g000 = vec3(gx0.x,gy0.x,gz0.x);\n  vec3 g100 = vec3(gx0.y,gy0.y,gz0.y);\n  vec3 g010 = vec3(gx0.z,gy0.z,gz0.z);\n  vec3 g110 = vec3(gx0.w,gy0.w,gz0.w);\n  vec3 g001 = vec3(gx1.x,gy1.x,gz1.x);\n  vec3 g101 = vec3(gx1.y,gy1.y,gz1.y);\n  vec3 g011 = vec3(gx1.z,gy1.z,gz1.z);\n  vec3 g111 = vec3(gx1.w,gy1.w,gz1.w);\n\n  vec4 norm0 = taylorInvSqrt_2(vec4(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));\n  g000 *= norm0.x;\n  g010 *= norm0.y;\n  g100 *= norm0.z;\n  g110 *= norm0.w;\n  vec4 norm1 = taylorInvSqrt_2(vec4(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));\n  g001 *= norm1.x;\n  g011 *= norm1.y;\n  g101 *= norm1.z;\n  g111 *= norm1.w;\n\n  float n000 = dot(g000, Pf0);\n  float n100 = dot(g100, vec3(Pf1.x, Pf0.yz));\n  float n010 = dot(g010, vec3(Pf0.x, Pf1.y, Pf0.z));\n  float n110 = dot(g110, vec3(Pf1.xy, Pf0.z));\n  float n001 = dot(g001, vec3(Pf0.xy, Pf1.z));\n  float n101 = dot(g101, vec3(Pf1.x, Pf0.y, Pf1.z));\n  float n011 = dot(g011, vec3(Pf0.x, Pf1.yz));\n  float n111 = dot(g111, Pf1);\n\n  vec3 fade_xyz = fade_1(Pf0);\n  vec4 n_z = mix(vec4(n000, n100, n010, n110), vec4(n001, n101, n011, n111), fade_xyz.z);\n  vec2 n_yz = mix(n_z.xy, n_z.zw, fade_xyz.y);\n  float n_xyz = mix(n_yz.x, n_yz.y, fade_xyz.x);\n  return 2.2 * n_xyz;\n}\n\n//\n// GLSL textureless classic 2D noise "cnoise",\n// with an RSL-style periodic variant "pnoise".\n// Author:  Stefan Gustavson (stefan.gustavson@liu.se)\n// Version: 2011-08-22\n//\n// Many thanks to Ian McEwan of Ashima Arts for the\n// ideas for permutation and gradient selection.\n//\n// Copyright (c) 2011 Stefan Gustavson. All rights reserved.\n// Distributed under the MIT license. See LICENSE file.\n// https://github.com/ashima/webgl-noise\n//\n\nvec4 mod289_0(vec4 x)\n{\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 permute_0(vec4 x)\n{\n  return mod289_0(((x*34.0)+1.0)*x);\n}\n\nvec4 taylorInvSqrt_0(vec4 r)\n{\n  return 1.79284291400159 - 0.85373472095314 * r;\n}\n\nvec2 fade_0(vec2 t) {\n  return t*t*t*(t*(t*6.0-15.0)+10.0);\n}\n\n// Classic Perlin noise\nfloat cnoise_0(vec2 P)\n{\n  vec4 Pi = floor(P.xyxy) + vec4(0.0, 0.0, 1.0, 1.0);\n  vec4 Pf = fract(P.xyxy) - vec4(0.0, 0.0, 1.0, 1.0);\n  Pi = mod289_0(Pi); // To avoid truncation effects in permutation\n  vec4 ix = Pi.xzxz;\n  vec4 iy = Pi.yyww;\n  vec4 fx = Pf.xzxz;\n  vec4 fy = Pf.yyww;\n\n  vec4 i = permute_0(permute_0(ix) + iy);\n\n  vec4 gx = fract(i * (1.0 / 41.0)) * 2.0 - 1.0 ;\n  vec4 gy = abs(gx) - 0.5 ;\n  vec4 tx = floor(gx + 0.5);\n  gx = gx - tx;\n\n  vec2 g00 = vec2(gx.x,gy.x);\n  vec2 g10 = vec2(gx.y,gy.y);\n  vec2 g01 = vec2(gx.z,gy.z);\n  vec2 g11 = vec2(gx.w,gy.w);\n\n  vec4 norm = taylorInvSqrt_0(vec4(dot(g00, g00), dot(g01, g01), dot(g10, g10), dot(g11, g11)));\n  g00 *= norm.x;\n  g01 *= norm.y;\n  g10 *= norm.z;\n  g11 *= norm.w;\n\n  float n00 = dot(g00, vec2(fx.x, fy.x));\n  float n10 = dot(g10, vec2(fx.y, fy.y));\n  float n01 = dot(g01, vec2(fx.z, fy.z));\n  float n11 = dot(g11, vec2(fx.w, fy.w));\n\n  vec2 fade_xy = fade_0(Pf.xy);\n  vec2 n_x = mix(vec2(n00, n01), vec2(n10, n11), fade_xy.x);\n  float n_xy = mix(n_x.x, n_x.y, fade_xy.y);\n  return 2.3 * n_xy;\n}\n\nmat4 rotationMatrix(vec3 axis, float angle) {\n    axis = normalize(axis);\n    float s = sin(angle);\n    float c = cos(angle);\n    float oc = 1.0 - c;\n\n    return mat4(oc * axis.x * axis.x + c,           oc * axis.x * axis.y - axis.z * s,  oc * axis.z * axis.x + axis.y * s,  0.0,\n                oc * axis.x * axis.y + axis.z * s,  oc * axis.y * axis.y + c,           oc * axis.y * axis.z - axis.x * s,  0.0,\n                oc * axis.z * axis.x - axis.y * s,  oc * axis.y * axis.z + axis.x * s,  oc * axis.z * axis.z + c,           0.0,\n                0.0,                                0.0,                                0.0,                                1.0);\n}\n\n#ifndef PI\n#define PI 3.141592653589793\n#endif\n\nfloat bounceOut(float t) {\n  const float a = 4.0 / 11.0;\n  const float b = 8.0 / 11.0;\n  const float c = 9.0 / 10.0;\n\n  const float ca = 4356.0 / 361.0;\n  const float cb = 35442.0 / 1805.0;\n  const float cc = 16061.0 / 1805.0;\n\n  float t2 = t * t;\n\n  return t < a\n    ? 7.5625 * t2\n    : t < b\n      ? 9.075 * t2 - 9.9 * t + 3.4\n      : t < c\n        ? ca * t2 - cb * t + cc\n        : 10.8 * t * t - 20.52 * t + 10.72;\n}\n\nfloat circularInOut(float t) {\n  return t < 0.5\n    ? 0.5 * (1.0 - sqrt(1.0 - 4.0 * t * t))\n    : 0.5 * (sqrt((3.0 - 2.0 * t) * (2.0 * t - 1.0)) + 1.0);\n}\n\nfloat qinticInOut(float t) {\n  return t < 0.5\n    ? +16.0 * pow(t, 5.0)\n    : -0.5 * pow(2.0 * t - 2.0, 5.0) + 1.0;\n}\n\n// Folds\nvoid fold (inout vec2 p_3) {\n  if (p_3.x + p_3.y < 0.) {\n    float x1 = -p_3.y;\n    p_3.y = -p_3.x;\n    p_3.x = x1;\n  }\n}\n\nvoid foldInv (inout vec2 p_1) {\n  if (p_1.x - p_1.y < 0.) {\n    float x1 = p_1.y;\n    p_1.y = p_1.x;\n    p_1.x = x1;\n  }\n}\nvoid bfold (inout vec2 p_1) {\n  const vec2 n = vec2(1., -1.);\n  p_1 -= min(0., dot(p_1, n)) * n;\n}\n\nvoid sphereFold (inout vec3 p_0, inout float dz) {\n  const float fixedRadius2 = 1.;\n  const float minRadius2 = .25;\n\n  float r2 = dot(p_0, p_0);\n  if (r2 < minRadius2) {\n    float temp = (fixedRadius2 / minRadius2);\n    p_0 *= temp;\n    dz *= temp;\n  } else if (r2 < fixedRadius2) {\n    float temp = (fixedRadius2 / r2);\n    p_0 *= temp;\n    dz *= temp;\n  }\n} \n\nvec3 opTwist( vec3 p, float angle ) {\n    float c = cos(angle);\n    float s = sin(angle);\n    mat2  m = mat2(c,-s,s,c);\n    return vec3(m*p.xz,p.y);\n}\n\nvoid foldNd (inout vec3 z, vec3 n1) {\n  z-=2.0 * min(0.0, dot(z, n1)) * n1;\n}\n\nfloat hash(vec2 co){\n    return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);\n}\n\n// Orbit Trap\nfloat trapCalc (in vec3 p, in float k) {\n  return dot(p, p) / (k * k);\n}\n\n#ifndef foldLimit\n  #define foldLimit 1.\n#endif\n\nfloat C1 = abs(scale - 1.);\nfloat C2 = pow(abs(scale), float(1 - Iterations));\n\nfloat trapCalc_0 (in vec4 z_0) {\n  return (length(z_0.xyz) - C1) / z_0.w;\n}\n\nvec4 mandelboxFold (in vec4 z_2, inout float minD_2) {\n  float k = 1.0;\n  vec4 z0 = vec4(z_2.xyz, 1.);\n\n  float minRadius2 = 0.5 * 0.5;\n  vec4 scalevec = vec4(scale, scale, scale, abs(scale)) / minRadius2;\n\n  for (int i = 0; i < Iterations; i++) {\n    // Box Fold\n    z_2.xyz = clamp(z_2.xyz, -1., 1.) * 2. - z_2.xyz;\n\n    // Ball fold\n    float r2 = dot(z_2.xyz, z_2.xyz);\n    z_2.xyzw *= clamp(max(minRadius2/r2, minRadius2), 0., 1.);\n\n    z_2 *= kifsM;\n\n    z_2.xyzw = z_2*scalevec + z0;\n\n    minD_2 = min(minD_2, trapCalc_0(z_2));\n    k *= 1.1;\n  }\n\n  return z_2;\n}\n\nvec2 mandelbox (in vec3 z_0) {\n  vec4 p = vec4(z_0.xyz, 1.);\n\n  float minD = maxDistance * 2.;\n\n  p = mandelboxFold(p, minD);\n\n  return vec2((length(p.xyz) - C1) / p.w - C2, minD);\n}\n\n// #pragma glslify: octahedron = require(./octahedron, scale=scale, kifsM=kifsM)\n\n#ifndef Iterations\n  #define Iterations 10\n#endif\nconst int IT = Iterations;\n\n#define _PHI_ (1.+sqrt(5.))/2.\n\n#define _IVNORM_ (0.5/_PHI_)\n#define _PHI1_ (_PHI_*_IVNORM_)\n#define _1PHI_ (_IVNORM_)\n#define _PHI2_ (_PHI_*_PHI_*_IVNORM_)\n\n#define _IKVNORM_ 1. / sqrt(pow(_PHI_*(1.+_PHI_),2.) + pow(pow(_PHI_, 2.) - 1., 2.) + pow(1.+_PHI_, 2.))\n#define _C1_ (_PHI_*(1.+_PHI_)*_IKVNORM_)\n#define _C2_ ((_PHI_*_PHI_-1.)*_IKVNORM_)\n#define _1C_ ((1.+_PHI_)*_IKVNORM_)\n\nvoid foldNd_0 (inout vec3 z_1, vec3 n1_1) {\n  z_1-=2.0 * min(0.0, dot(z_1, n1_1)) * n1_1;\n}\n\nvec3 dodecahedronFold (in vec3 p_5, inout float minD_1) {\n  for(int i=0; i < IT; i++) {\n    p_5=abs(p_5);\n\n    vec3 axis = vec3(_PHI2_, _1PHI_, -_PHI1_);\n    foldNd_0(p_5, axis);\n\n    axis = vec3(-_PHI1_, _PHI2_, _1PHI_);\n    foldNd_0(p_5, axis);\n\n    axis = vec3(_1PHI_, -_PHI1_, _PHI2_);\n    foldNd_0(p_5, axis);\n\n    axis = vec3(-_C1_, _C2_, _1C_);\n    foldNd_0(p_5, axis);\n\n    axis = vec3(_1C_, -_C1_, _C2_);\n    foldNd_0(p_5, axis);\n\n    // Stretch\n    p_5 = (vec4(p_5, 1.) * kifsM).xyz;\n\n    minD_1 = min(length(p_5), minD_1);\n  }\n\n  return p_5;\n}\n\nfloat sdBox( vec3 p, vec3 b ) {\n  vec3 d = abs(p) - b;\n  return min(max(d.x,max(d.y,d.z)),0.0) + length(max(d,0.0));\n}\n\nvec2 dodecasierpinski(in vec3 p) {\n  float minD = 10000.;\n\n  p = dodecahedronFold(p, minD);\n\n  return vec2((sdBox(p, vec3(1.))) * pow(scale, -float(Iterations)), minD);\n}\n\n#ifndef Iterations\n  #define Iterations 10\n#endif\n\nvec2 MengerSphere (inout vec3 p_2) {\n  p_2 = .5*p_2 + vec3(.5);\n  vec3 pp = abs(p_2 -.5) - .5;\n\n  float k = 2.0;\n\n  float minD = 10000.;\n\n  float d1 = max(pp.x, max(pp.y, pp.z));\n  float d = d1;\n\n  for (int i = 0; i < Iterations; i++) {\n    vec3 pa = mod(3. * p_2 * k, 3.);\n    k *= scale;\n\n    pp = .5 - abs(pa-1.5);\n\n    pp = (vec4(pp, 1.) * kifsM).xyz;\n\n    //distance inside the 3 axis aligned square tubes\n    d1 = min(max(pp.x, pp.z), min(max(pp.x, pp.y), max(pp.y, pp.z))) / k;\n\n    d = max(d, d1); // intersect\n\n    minD = min(abs(dot(pp, pp)), minD);\n  }\n\n  float e = clamp(length(pp) - 10., 0., 100.);\n  d = max(d, e);\n  return vec2(d, minD);\n}\n\n#define octaPreFold 6\nmat4 octaM = mat4(\nscale, 0., 0., 0.,\n0., scale, 0., 0.,\n0., 0., scale, 0.,\n1., 1., 1., 1.) * mat4(\n1., 0., 0.1, .0,\n0., 1., 0., 0.,\n0., 0.2, 1., 0.,\n0., 0., 0., 1.);\n\nvec3 octahedronFold (in vec3 p_4, inout float minD_0) {\n  float k = 1.0;\n\n  for (int i = 0; i < octaPreFold; i++) {\n    p_4 = -abs(-p_4);\n\n    // Folding\n    fold(p_4.xy);\n    fold(p_4.xz);\n    bfold(p_4.xy);\n    bfold(p_4.xz);\n\n    // Stretch\n    p_4 = (vec4(p_4, 1.) * octaM).xyz;\n\n    minD_0 = min(trapCalc(p_4, k), minD_0);\n    k *= 1.1;\n  }\n\n  return p_4;\n}\n\nvec3 map (in vec3 p) {\n  // Sphere\n  // vec3 s = vec3(length(p) - 1., 1., 0.);\n  // return s;\n\n  // Fractal\n  vec2 f = dodecasierpinski(p);\n  vec3 fractal = vec3(f.x, 1., f.y);\n\n  return fractal;\n}\n\nvec4 march (in vec3 rayOrigin, in vec3 rayDirection) {\n  float t = 0.00001;\n  float maxI = 0.;\n\n  float trap = maxDistance;\n\n  for (int i = 0; i < maxSteps; i++) {\n    vec3 d = map(rayOrigin + rayDirection * t);\n    if (d.x < epsilon) return vec4(t + d.x, d.y, float(i), d.z);\n    t += d.x;\n    maxI = float(i);\n    trap = d.z;\n    if (t > maxDistance) break;\n  }\n  return vec4(-1., 0., maxI, trap);\n}\n\nvec3 getNormal( in vec3 p, in float eps ) {\n    vec2 e = vec2(1.0,-1.0)*.05773*eps;\n    return normalize(\n      e.xyy * map( p + e.xyy ).x + \n      e.yyx * map( p + e.yyx ).x + \n      e.yxy * map( p + e.yxy ).x + \n      e.xxx * map( p + e.xxx ).x );\n}\n\nvec3 getNormal2 (in vec3 p, in float eps) {\n  vec2 e = vec2(1.,-1.) * .015 * eps;\n  return normalize(vec3(\n    map(p + e.xyy).x - map(p - e.xyy).x,\n    map(p + e.yxy).x - map(p - e.yxy).x,\n    map(p + e.yyx).x - map(p - e.yyx).x));\n}\n\n// Material Functions\nfloat diffuse (in vec3 nor, in vec3 lightPos) {\n  return clamp(dot(lightPos, nor), 0., 1.);\n}\n\n// Source: https://www.shadertoy.com/view/Xds3zN\nfloat softshadow( in vec3 ro, in vec3 rd, in float mint, in float tmax ) {\n  float res = 1.0;\n    float t = mint;\n    for( int i=0; i<16; i++ ) {\n      vec3 h = map(ro + rd*t);\n      res = min( res, 4.0*h.x/t );\n      t += clamp( h.x, 0.02, 0.10 );\n      if( h.x<0.001 || t>tmax ) break;\n    }\n    return clamp( res, 0.0, 1.0 );\n}\n\nfloat calcAO( in vec3 pos, in vec3 nor  ) {\n  float occ = 0.0;\n  float sca = 1.0;\n  for( int i=0; i<4; i++  ) {\n    float hr = 0.01 + 0.12*float(i)/4.0;\n    vec3 aopos =  nor * hr + pos;\n    vec3 dd = map(aopos);\n    occ += -(dd.x-hr)*sca;\n    sca *= 0.95;\n  }\n  return clamp( 1.0 - 3.0*occ, 0.0, 1.0  );    \n}\n\nvoid colorMap (inout vec3 color) {\n  float l = length(vec4(color, 1.));\n  // Light\n  color = mix(vec3(0.9372549019607843,0.47058823529411764,1.), color, 1. - l * .0625);\n  // Dark\n  color = mix(vec3(0.01568627450980392,0.19607843137254902,0.06274509803921569), color, clamp(exp(l) * .325, 0., 1.));\n}\n\nvec3 hsv2rgb(vec3 c) {\n  vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n  vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n  return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n\nfloat checker(vec2 uv, float repeats) {\n  float cx = floor(repeats * uv.x);\n  float cy = floor(repeats * uv.y); \n  float result = mod(cx + cy, 2.0);\n  return sign(result);\n}\n\nvec3 textures (in vec3 rd) {\n  vec3 color = vec3(0.);\n\n  // float v = checker(rd.xy, 10.);\n  float v = cnoise_1(10. * rd);\n  v = smoothstep(-1.0, 1.0, v);\n\n  color = vec3(v);\n\n  #if 0\n  if (color == vec3(0.)) {\n    color = vec3(1., 0., 1.);\n  }\n  if (color == vec3(1.)) {\n    color = vec3(0., 1., 0.);\n  }\n  #endif\n\n  return clamp(color, 0., 1.);\n}\n\nvec3 scene (in vec3 rd) {\n  vec3 color = vec3(0.);\n\n  rd = normalize(rd);\n  color = textures(rd);\n\n  return color;\n}\n\n#define RGBCMY 1\n\nvec3 refractColors (in vec3 nor_0, in vec3 eye, in float n2_0, in float n1_0) {\n  const float between = 0.1;\n  float greenIOR = n2_0;\n\n  #ifdef RGBCMY\n  float redIORRatio = n1_0/(greenIOR - 2. * between);\n  float yellowIORRatio = n1_0/(greenIOR - 1. * between);\n  float greenIORRatio = n1_0/greenIOR;\n  float cyanIORRatio = n1_0/(greenIOR + 1. * between);\n  float blueIORRatio = n1_0/(greenIOR + 2. * between);\n  float purpleIORRatio = n1_0/(greenIOR + 3. * between);\n\n  vec3 redRefract = refract(eye, nor_0, redIORRatio);\n  vec3 yellowRefract = refract(eye, nor_0, yellowIORRatio);\n  vec3 greenRefract = refract(eye, nor_0, greenIORRatio);\n  vec3 cyanRefract = refract(eye, nor_0, cyanIORRatio);\n  vec3 blueRefract = refract(eye, nor_0, blueIORRatio);\n  vec3 purpleRefract = refract(eye, nor_0, purpleIORRatio);\n\n  float r = scene(redRefract).r * 0.5;\n  float y = dot(scene(yellowRefract), vec3(2.0, 2.0, -1.0)) / 6.0;\n  float g = scene(greenRefract).g * 0.5;\n  float c = dot(scene(cyanRefract), vec3(-1.0, 2.0, 2.0)) / 6.0;\n  float b = scene(blueRefract).b * 0.5;\n  float p = dot(scene(purpleRefract), vec3(2.0, -1.0, 2.0)) / 6.0;\n\n  float R = r + (2.0*p + 2.0*y - c)/3.0;\n  float G = g + (2.0*y + 2.0*c - p)/3.0;\n  float B = b + (2.0*c + 2.0*p - y)/3.0;\n\n  #else\n\n  float redIORRatio = n1_0/(greenIOR - 1. * between);\n  float greenIORRatio = n1_0/greenIOR;\n  float blueIORRatio = n1_0/(greenIOR + 1. * between);\n\n  vec3 redRefract = refract(eye, nor_0, redIORRatio);\n  vec3 greenRefract = refract(eye, nor_0, greenIORRatio);\n  vec3 blueRefract = refract(eye, nor_0, blueIORRatio);\n\n  float r = scene(redRefract).r;\n  float g = scene(greenRefract).g;\n  float b = scene(blueRefract).b;\n\n  float R = r;\n  float G = g;\n  float B = b;\n  #endif\n\n  return vec3(R, G, B);\n}\nvec3 refractColors (in vec3 nor_0, in vec3 eye, in float n2_0) {\n  return refractColors(nor_0, eye, n2_0, 1.);\n}\n\nvec3 baseColor(in vec3 pos, in vec3 nor, in vec3 rd, in float m, in float trap) {\n  return refractColors(nor, rd, 1.57);\n}\n\nvec4 shade( in vec3 rayOrigin, in vec3 rayDirection, in vec4 t, in vec2 uv ) {\n    vec3 pos = rayOrigin + rayDirection * t.x;\n    if (t.x>0.) {\n      vec3 color = background;\n\n      vec3 nor = getNormal(pos, .0001);\n      vec3 ref = reflect(rayDirection, nor);\n\n      // Basic Diffusion\n      color = baseColor(pos, nor, rayDirection, t.y, t.w);\n\n      float occ = calcAO(pos, nor);\n      float amb = clamp( 0.5+0.5*nor.y, 0.0, 1.0  );\n      float dif = diffuse(nor, lightPos);\n      float spec = pow(clamp( dot(ref, (lightPos)), 0., 1. ), 4.);\n      const float n1 = 1.000277; // Air\n      const float n2 = 2.42; // Diamond\n      const float ReflectionFresnel = pow((n1 - n2) / (n1 + n2), 2.);\n      float fre = ReflectionFresnel + pow(clamp( 1. + dot(nor, rayDirection), 0., 1. ), 5.) * (1. - ReflectionFresnel);\n\n      dif *= min(0.1 + softshadow(pos, lightPos, 0.02, 1.5), 1.);\n      vec3 lin = vec3(0.);\n\n      // Specular Lighting\n      lin += spec * (1. - fre) * dif * color.g;\n      lin += fre * occ;\n\n      // Ambient\n      lin += 0.04 * amb * occ * vec3(0.8,0.8,1.);\n\n      float conserve = (1. - (dot(lin, vec3(1.)) * .3333));\n      lin += conserve * dif;\n\n      color *= lin;\n\n      // Fog\n      color = mix(background, color, clamp(1.1 * ((maxDistance-t.x) / maxDistance), 0., 1.));\n\n      // Inner Glow\n      // vec3 glowColor = vec3(0.4,0.6,1.) * 5.0;\n      // float fGlow = clamp(t.w * 0.1, 0.0, 1.0);\n      // fGlow = pow(fGlow, 3.5);\n      // color += glowColor * 3.5 * fGlow;\n\n      color *= exp(-t.x * .2);\n\n      // color = baseColor(pos, nor, rayDirection, t.y, t.w);\n\n      // colorMap(color);\n\n      #ifdef debugMapMaxed\n      if (t.z / float(maxSteps) > 0.9) {\n        color = vec3(1., 0., 1.);\n      }\n      #endif\n\n      #ifdef debugMapCalls\n      color = vec3(t.z / float(maxSteps));\n      #endif\n\n      return vec4(color, 1.);\n    } else {\n      vec4 color = vec4(background, 0.);\n      // Radial Gradient\n      // color.xyz *= mix(vec3(1.), background, length(uv) / 2.);\n\n      // Glow\n      // color = mix(vec4(1.), color, 1. - .95 * clamp(t.z / float(maxSteps), 0., 1.));\n      return color;\n    }\n}\n\nvec4 sample (in vec3 ro, in vec3 rd, in vec2 uv) {\n  vec4 t = march(ro, rd);\n  return shade(ro, rd, t, uv);\n}\n\nvoid main() {\n    vec3 ro = cameraRo + cOffset;\n\n    vec2 uv = fragCoord.xy;\n\n    lightPos = normalize(vec3(1., .75, 0.));\n\n    #ifdef SS\n    // Antialias by averaging all adjacent values\n    vec4 color = vec4(0.);\n    vec2 R = resolution * 2.;\n\n    for (int x = - SS / 2; x < SS / 2; x++) {\n        for (int y = - SS / 2; y < SS / 2; y++) {\n            vec3 rd = getRayDirection(vec2(\n                  float(x) / R.y + uv.x,\n                  float(y) / R.y + uv.y),\n                  projectionMatrix);\n            rd = (vec4(rd, 1.) * cameraMatrix).xyz;\n            rd = normalize(rd);\n            color += sample(ro, rd, uv);\n        }\n    }\n    gl_FragColor = color / float(SS * SS);\n\n    #else\n    vec3 rd = getRayDirection(uv, projectionMatrix);\n    rd = (vec4(rd, 1.) * cameraMatrix).xyz;\n    rd = normalize(rd);\n    gl_FragColor = sample(ro, rd, uv);\n    #endif\n\n    // gamma\n    gl_FragColor.rgb = pow(gl_FragColor.rgb, vec3(0.454545));\n\n    // gl_FragColor += .05 * cnoise2(500. * uv) + .05 * cnoise2(500. * uv + 253.5);\n}\n'])),
this.bright=(0,s.default)(t,U(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec2 position;\nuniform vec2 resolution;\nvarying vec2 fragCoord;\n\nvoid main() {\n    // Adjust coordinates to (-1, -1) -> (1, 1)\n    fragCoord = position.xy * resolution / max(resolution.y, resolution.x);\n\n    gl_Position = vec4(position.xy, 0.0, 1.0);\n}\n"]),U(["precision highp float;\n#define GLSLIFY 1\n\nuniform vec2 resolution;\nuniform sampler2D buffer;\nuniform float minBright;\n\nvoid main() {\n  vec2 uv = vec2(gl_FragCoord.xy / resolution.xy);\n\n  vec4 color = texture2D(buffer, uv);\n  // Check whether fragment output is higher than threshold, if so output as brightness color\n  float brightness = dot(color.rgb, vec3(0.2126, 0.7152, 0.0722));\n  if (brightness > .89) {\n    gl_FragColor = vec4(color.rgb, 1.0);\n  } else {\n    gl_FragColor = vec4(vec3(0.), 1.);\n  }\n}\n"])),this.bloom=(0,s.default)(t,U(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec2 position;\nuniform vec2 resolution;\nvarying vec2 fragCoord;\n\nvoid main() {\n    // Adjust coordinates to (-1, -1) -> (1, 1)\n    fragCoord = position.xy * resolution / max(resolution.y, resolution.x);\n\n    gl_Position = vec4(position.xy, 0.0, 1.0);\n}\n"]),U(["precision highp float;\n#define GLSLIFY 1\n\nuniform vec2 resolution;\nuniform vec2 direction;\nuniform sampler2D buffer;\n\nvec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {\n  vec4 color = vec4(0.0);\n  vec2 off1 = vec2(1.3846153846) * direction;\n  vec2 off2 = vec2(3.2307692308) * direction;\n  color += texture2D(image, uv) * 0.2270270270;\n  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;\n  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;\n  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;\n  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;\n  return color;\n}\n\nvoid main() {\n  vec2 uv = vec2(gl_FragCoord.xy / resolution.xy);\n  gl_FragColor = blur9(buffer, uv, resolution.xy, direction);\n}\n"])),this.finalPass=(0,s.default)(t,U(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec2 position;\nuniform vec2 resolution;\nvarying vec2 fragCoord;\n\nvoid main() {\n    // Adjust coordinates to (-1, -1) -> (1, 1)\n    fragCoord = position.xy * resolution / max(resolution.y, resolution.x);\n\n    gl_Position = vec4(position.xy, 0.0, 1.0);\n}\n"]),U(["#define background vec3(0.,0.,0.)\n\nprecision highp float;\n#define GLSLIFY 1\n\nuniform vec2 resolution;\nuniform sampler2D base;\nuniform sampler2D buffer;\n\nvoid main() {\n  const float gamma = 1.5;\n\n  vec2 uv = vec2(gl_FragCoord.xy / resolution.xy);\n  vec4 baseColor = texture2D(base, uv);\n  vec4 result = baseColor + texture2D(buffer, uv);\n  result.rgb = pow(result.rgb, vec3(1.0 / gamma));\n  gl_FragColor = mix(vec4(background, 1.), result, baseColor.a);\n}\n"])),this.setupFBOs(t),this.shader.attributes.position.location=0}},{key:"kifsM",value:function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,this.offset),e=this.scale;this.shader.uniforms.scale=e,this.shader.uniforms.offset=t;var n=void 0;n=G?O.mat4.fromValues(1,0,0,-t[0],0,1,0,-t[1],0,0,1,-t[2],0,0,0,1):O.mat4.fromValues(e,0,0,-t[0]*(e-1),0,e,0,-t[1]*(e-1),0,0,e,-t[2]*(e-1),0,0,0,1);var r=this.rot2angle[0],a=O.vec3.fromValues(1,0,0);O.mat4.multiply(n,(0,E.rot4)(a,r),n);var i=this.rot2angle[1],o=O.vec3.fromValues(0,1,0);O.mat4.multiply(n,(0,E.rot4)(o,i),n);var s=this.rot2angle[2],u=O.vec3.fromValues(0,0,1);return O.mat4.multiply(n,(0,E.rot4)(u,s),n),n}},{key:"setupStage",value:function(){var t=this;return navigator.getVRDisplays().then(function(e){e.length>0&&(t.vrDisplay=e[0],t.effect.setVRDisplay(t.vrDisplay),t.controls.setVRDisplay(t.vrDisplay))})}},{key:"resize",value:function(t){var e=this.effect,n=this.canvas,r=1;(0,y.default)(n,window,z*r);var a=this.getDimensions();e.setSize(r*a[0],r*a[1]),this.state[0].shape=a,this.state[1].shape=a,this.state[2].shape=a}},{key:"tick",value:function(t){var e=this.gl,n=this.getDimensions();t=Y?W+1e3/B:t,W=t,this.shader.bind(),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT),e.clearColor(0,0,0,1),e.viewport(0,0,n[0],n[1]),this.update(t),this.render(t),this.currentRAF=this.vrDisplay.requestAnimationFrame(this.tick.bind(this))}},{key:"getCamera",value:function(t){t/=1e3;var e=O.mat4.create();if(this.LOOKAT)O.mat4.lookAt(e,this.cameraRo,O.vec3.fromValues(0,0,0),O.vec3.fromValues(0,1,0));else{var n=this.cameraAngles[0],r=O.vec3.fromValues(1,0,0);O.mat4.multiply(e,(0,E.rot4)(r,n),e);var a=this.cameraAngles[1],i=O.vec3.fromValues(0,1,0);O.mat4.multiply(e,(0,E.rot4)(i,a),e);var o=this.cameraAngles[2],s=O.vec3.fromValues(0,0,1);O.mat4.multiply(e,(0,E.rot4)(s,o),e)}return this.cameraMatrix=e,[this.cameraRo,e]}},{key:"update",value:function(t){b.default.update(t),this.shader.uniforms.epsilon=this.epsilon,this.controls.update(this.shader);var e=this.getCamera(t);this.shader.uniforms.cameraRo=e[0],this.shader.uniforms.cameraMatrix=e[1],this.shader.uniforms.kifsM=this.kifsM(t)}},{key:"bloomBlur",value:function(t){var e=this.getDimensions(),n=this.state[0].color[0];this.state[1].bind(),this.bright.bind(),this.bright.uniforms.minBright=.2,this.bright.uniforms.buffer=n.bind(0),this.bright.uniforms.resolution=e,(0,F.default)(t);for(var r=0;r<5;r++){var a=this.state[1].color[0];this.state[2].bind(),this.bloom.bind(),this.bloom.uniforms.buffer=a.bind(1),this.bloom.uniforms.resolution=e,this.bloom.uniforms.direction=[1,0],(0,F.default)(t);var i=this.state[2].color[0];this.state[1].bind(),this.bloom.uniforms.buffer=i.bind(2),this.bloom.uniforms.resolution=e,this.bloom.uniforms.direction=[0,1],(0,F.default)(t)}t.bindFramebuffer(t.FRAMEBUFFER,null),this.finalPass.bind(),this.finalPass.uniforms.base=n.bind(0),this.finalPass.uniforms.buffer=this.state[1].color[0].bind(1),this.finalPass.uniforms.resolution=e,(0,F.default)(t)}},{key:"render",value:function(t){var e=this.shader,n=this.manager,r=(this.controls,this.gl);H&&this.state[0].bind(),e.uniforms.time=t/1e3,n.render(e,t),H&&this.bloomBlur(r),Y&&X.capture(this.canvas)}},{key:"run",value:function(){var t=this;this.canvas.style.display=null,this.resize(),this.manager.mode!==m.default.Modes.VR&&this.manager.button.setVisibility(!0),this.enableEvents(),this.manager.enableEvents(),this.running=!0,Y&&X.start(),window.setTimeout=Z,window.clearTimeout=Q,window.setInterval=K,window.clearInterval=J,window.requestAnimationFrame=$,window.performance.now=tt,this.loaded.then(function(){t.vrDisplay&&t.running&&!t.currentRAF&&(t.currentRAF=t.vrDisplay.requestAnimationFrame(t.tick.bind(t)))})}},{key:"stop",value:function(){this.canvas.style.display="none",this.manager.button.setVisibility(!1),this.currentRAF&&(this.vrDisplay.cancelAnimationFrame(this.currentRAF),this.currentRAF=null),this.running=!1,this.disposeEvents(),this.manager.disposeEvents()}}]),t}());n.default=et,e.exports=n.default},{"./camera-tweens":3,"./presets.json":87,"./utils":88,"a-big-triangle":4,"canvas-fit":12,"ccapture.js":1,defined:16,"gl-audio-analyser":19,"gl-context":23,"gl-fbo":24,"gl-matrix":26,"gl-shader":36,"gl-texture2d":43,glslify:57,"object-assign":66,"shader-vr-effect":107,"shader-vr-orbit-controls":108,"shader-webvr-manager":113,"soundcloud-badge":74,"tween.js":77}],3:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function a(t,e,n,r,a){var i=n.slice(),s=new o.default.Tween(i);return s.to(r,a).onUpdate(function(){t[0]=e*Math.sin(this[0]),t[1]=e*Math.cos(this[1])}).easing(o.default.Easing.Quadratic.InOut).onComplete(function(t){this[0]=n[0],this[1]=n[1]}),s}Object.defineProperty(n,"__esModule",{value:!0}),n.cameraOrbit=a;var i=t("tween.js"),o=r(i)},{"tween.js":77}],4:[function(t,e,n){"use strict";function r(t){var e=s.get(t),n=e&&(e._triangleBuffer.handle||e._triangleBuffer.buffer);if(!n||!t.isBuffer(n)){var r=i(t,new Float32Array([-1,-1,-1,4,4,-1]));e=o(t,[{buffer:r,type:t.FLOAT,size:2}]),e._triangleBuffer=r,s.set(t,e)}e.bind(),t.drawArrays(t.TRIANGLES,0,3),e.unbind()}var a="undefined"==typeof WeakMap?t("weak-map"):WeakMap,i=t("gl-buffer"),o=t("gl-vao"),s=new a;e.exports=r},{"gl-buffer":20,"gl-vao":47,"weak-map":80}],5:[function(t,e,n){function r(t,e,n){e="number"==typeof e?e:1,n=n||": ";var r=t.split(/\r?\n/),i=String(r.length+e-1).length;return r.map(function(t,r){var o=r+e,s=String(o).length,u=a(o,i-s);return u+n+t}).join("\n")}var a=t("pad-left");e.exports=r},{"pad-left":67}],6:[function(t,e,n){e.exports=function(t){return atob(t)}},{}],7:[function(t,e,n){"use strict";function r(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");return"="===t[e-2]?2:"="===t[e-1]?1:0}function a(t){return 3*t.length/4-r(t)}function i(t){var e,n,a,i,o,s,u=t.length;o=r(t),s=new f(3*u/4-o),a=o>0?u-4:u;var l=0;for(e=0,n=0;e<a;e+=4,n+=3)i=c[t.charCodeAt(e)]<<18|c[t.charCodeAt(e+1)]<<12|c[t.charCodeAt(e+2)]<<6|c[t.charCodeAt(e+3)],s[l++]=i>>16&255,s[l++]=i>>8&255,s[l++]=255&i;return 2===o?(i=c[t.charCodeAt(e)]<<2|c[t.charCodeAt(e+1)]>>4,s[l++]=255&i):1===o&&(i=c[t.charCodeAt(e)]<<10|c[t.charCodeAt(e+1)]<<4|c[t.charCodeAt(e+2)]>>2,s[l++]=i>>8&255,s[l++]=255&i),s}function o(t){return l[t>>18&63]+l[t>>12&63]+l[t>>6&63]+l[63&t]}function s(t,e,n){for(var r,a=[],i=e;i<n;i+=3)r=(t[i]<<16)+(t[i+1]<<8)+t[i+2],a.push(o(r));return a.join("")}function u(t){for(var e,n=t.length,r=n%3,a="",i=[],o=16383,u=0,c=n-r;u<c;u+=o)i.push(s(t,u,u+o>c?c:u+o));return 1===r?(e=t[n-1],a+=l[e>>2],a+=l[e<<4&63],a+="=="):2===r&&(e=(t[n-2]<<8)+t[n-1],a+=l[e>>10],a+=l[e>>4&63],a+=l[e<<2&63],a+="="),i.push(a),i.join("")}n.byteLength=a,n.toByteArray=i,n.fromByteArray=u;for(var l=[],c=[],f="undefined"!=typeof Uint8Array?Uint8Array:Array,h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",d=0,p=h.length;d<p;++d)l[d]=h[d],c[h.charCodeAt(d)]=d;c["-".charCodeAt(0)]=62,c["_".charCodeAt(0)]=63},{}],8:[function(t,e,n){"use strict";"use restrict";function r(t){var e=32;return t&=-t,t&&e--,65535&t&&(e-=16),16711935&t&&(e-=8),252645135&t&&(e-=4),858993459&t&&(e-=2),1431655765&t&&(e-=1),e}var a=32;n.INT_BITS=a,n.INT_MAX=2147483647,n.INT_MIN=-1<<a-1,n.sign=function(t){return(t>0)-(t<0)},n.abs=function(t){var e=t>>a-1;return(t^e)-e},n.min=function(t,e){return e^(t^e)&-(t<e)},n.max=function(t,e){return t^(t^e)&-(t<e)},n.isPow2=function(t){return!(t&t-1||!t)},n.log2=function(t){var e,n;return e=(t>65535)<<4,t>>>=e,n=(t>255)<<3,t>>>=n,e|=n,n=(t>15)<<2,t>>>=n,e|=n,n=(t>3)<<1,t>>>=n,e|=n,e|t>>1},n.log10=function(t){return t>=1e9?9:t>=1e8?8:t>=1e7?7:t>=1e6?6:t>=1e5?5:t>=1e4?4:t>=1e3?3:t>=100?2:t>=10?1:0},n.popCount=function(t){return t-=t>>>1&1431655765,t=(858993459&t)+(t>>>2&858993459),16843009*(t+(t>>>4)&252645135)>>>24},n.countTrailingZeros=r,n.nextPow2=function(t){return t+=0===t,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t+1},n.prevPow2=function(t){return t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t-(t>>>1)},n.parity=function(t){return t^=t>>>16,t^=t>>>8,t^=t>>>4,t&=15,27030>>>t&1};var i=new Array(256);!function(t){for(var e=0;e<256;++e){var n=e,r=e,a=7;for(n>>>=1;n;n>>>=1)r<<=1,r|=1&n,--a;t[e]=r<<a&255}}(i),n.reverse=function(t){return i[255&t]<<24|i[t>>>8&255]<<16|i[t>>>16&255]<<8|i[t>>>24&255]},n.interleave2=function(t,e){return t&=65535,t=16711935&(t|t<<8),t=252645135&(t|t<<4),t=858993459&(t|t<<2),t=1431655765&(t|t<<1),e&=65535,e=16711935&(e|e<<8),e=252645135&(e|e<<4),e=858993459&(e|e<<2),e=1431655765&(e|e<<1),t|e<<1},n.deinterleave2=function(t,e){return t=t>>>e&1431655765,t=858993459&(t|t>>>1),t=252645135&(t|t>>>2),t=16711935&(t|t>>>4),t=65535&(t|t>>>16),t<<16>>16},n.interleave3=function(t,e,n){return t&=1023,t=4278190335&(t|t<<16),t=251719695&(t|t<<8),t=3272356035&(t|t<<4),t=1227133513&(t|t<<2),e&=1023,e=4278190335&(e|e<<16),e=251719695&(e|e<<8),e=3272356035&(e|e<<4),e=1227133513&(e|e<<2),t|=e<<1,n&=1023,n=4278190335&(n|n<<16),n=251719695&(n|n<<8),n=3272356035&(n|n<<4),n=1227133513&(n|n<<2),t|n<<2},n.deinterleave3=function(t,e){return t=t>>>e&1227133513,t=3272356035&(t|t>>>2),t=251719695&(t|t>>>4),t=4278190335&(t|t>>>8),t=1023&(t|t>>>16),t<<22>>22},n.nextCombination=function(t){var e=t|t-1;return e+1|(~e&-~e)-1>>>r(t)+1}},{}],9:[function(t,e,n){},{}],10:[function(t,e,n){(function(e){"use strict";function r(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}function a(){return o.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function i(t,e){if(a()<e)throw new RangeError("Invalid typed array length");return o.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e),t.__proto__=o.prototype):(null===t&&(t=new o(e)),t.length=e),t}function o(t,e,n){if(!(o.TYPED_ARRAY_SUPPORT||this instanceof o))return new o(t,e,n);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return c(this,t)}return s(this,t,e,n)}function s(t,e,n,r){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?d(t,e,n,r):"string"==typeof e?f(t,e,n):p(t,e)}function u(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function l(t,e,n,r){return u(e),e<=0?i(t,e):void 0!==n?"string"==typeof r?i(t,e).fill(n,r):i(t,e).fill(n):i(t,e)}function c(t,e){if(u(e),t=i(t,e<0?0:0|g(e)),!o.TYPED_ARRAY_SUPPORT)for(var n=0;n<e;++n)t[n]=0;return t}function f(t,e,n){if("string"==typeof n&&""!==n||(n="utf8"),!o.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|v(e,n);t=i(t,r);var a=t.write(e,n);return a!==r&&(t=t.slice(0,a)),t}function h(t,e){var n=e.length<0?0:0|g(e.length);t=i(t,n);for(var r=0;r<n;r+=1)t[r]=255&e[r];return t}function d(t,e,n,r){if(e.byteLength,n<0||e.byteLength<n)throw new RangeError("'offset' is out of bounds");if(e.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");return e=void 0===n&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,n):new Uint8Array(e,n,r),o.TYPED_ARRAY_SUPPORT?(t=e,t.__proto__=o.prototype):t=h(t,e),t}function p(t,e){if(o.isBuffer(e)){var n=0|g(e.length);return t=i(t,n),0===t.length?t:(e.copy(t,0,0,n),t)}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||Q(e.length)?i(t,0):h(t,e);if("Buffer"===e.type&&$(e.data))return h(t,e.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function g(t){if(t>=a())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a().toString(16)+" bytes");return 0|t}function m(t){return+t!=t&&(t=0),o.alloc(+t)}function v(t,e){if(o.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var n=t.length;if(0===n)return 0;for(var r=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return H(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return W(t).length;default:if(r)return H(t).length;e=(""+e).toLowerCase(),r=!0}}function y(t,e,n){var r=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if(n>>>=0,e>>>=0,n<=e)return"";for(t||(t="utf8");;)switch(t){case"hex":return L(this,e,n);case"utf8":case"utf-8":return R(this,e,n);case"ascii":return F(this,e,n);case"latin1":case"binary":return N(this,e,n);case"base64":return T(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return P(this,e,n);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}function _(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function b(t,e,n,r,a){if(0===t.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=a?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(a)return-1;n=t.length-1}else if(n<0){if(!a)return-1;n=0}if("string"==typeof e&&(e=o.from(e,r)),o.isBuffer(e))return 0===e.length?-1:x(t,e,n,r,a);if("number"==typeof e)return e&=255,o.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?a?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):x(t,[e],n,r,a);throw new TypeError("val must be string, number or Buffer")}function x(t,e,n,r,a){function i(t,e){return 1===o?t[e]:t.readUInt16BE(e*o)}var o=1,s=t.length,u=e.length;if(void 0!==r&&(r=String(r).toLowerCase(),"ucs2"===r||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return-1;o=2,s/=2,u/=2,n/=2}var l;if(a){var c=-1;for(l=n;l<s;l++)if(i(t,l)===i(e,c===-1?0:l-c)){if(c===-1&&(c=l),l-c+1===u)return c*o}else c!==-1&&(l-=l-c),c=-1}else for(n+u>s&&(n=s-u),l=n;l>=0;l--){for(var f=!0,h=0;h<u;h++)if(i(t,l+h)!==i(e,h)){f=!1;break}if(f)return l}return-1}function w(t,e,n,r){n=Number(n)||0;var a=t.length-n;r?(r=Number(r),r>a&&(r=a)):r=a;var i=e.length;if(i%2!==0)throw new TypeError("Invalid hex string");r>i/2&&(r=i/2);for(var o=0;o<r;++o){var s=parseInt(e.substr(2*o,2),16);if(isNaN(s))return o;t[n+o]=s}return o}function E(t,e,n,r){return Z(H(e,t.length-n),t,n,r)}function M(t,e,n,r){return Z(G(e),t,n,r)}function I(t,e,n,r){return M(t,e,n,r)}function A(t,e,n,r){return Z(W(e),t,n,r)}function S(t,e,n,r){return Z(X(e,t.length-n),t,n,r)}function T(t,e,n){return 0===e&&n===t.length?K.fromByteArray(t):K.fromByteArray(t.slice(e,n))}function R(t,e,n){n=Math.min(t.length,n);for(var r=[],a=e;a<n;){var i=t[a],o=null,s=i>239?4:i>223?3:i>191?2:1;if(a+s<=n){var u,l,c,f;switch(s){case 1:i<128&&(o=i);break;case 2:u=t[a+1],128===(192&u)&&(f=(31&i)<<6|63&u,f>127&&(o=f));break;case 3:u=t[a+1],l=t[a+2],128===(192&u)&&128===(192&l)&&(f=(15&i)<<12|(63&u)<<6|63&l,f>2047&&(f<55296||f>57343)&&(o=f));break;case 4:u=t[a+1],l=t[a+2],c=t[a+3],128===(192&u)&&128===(192&l)&&128===(192&c)&&(f=(15&i)<<18|(63&u)<<12|(63&l)<<6|63&c,f>65535&&f<1114112&&(o=f))}}null===o?(o=65533,s=1):o>65535&&(o-=65536,r.push(o>>>10&1023|55296),o=56320|1023&o),r.push(o),a+=s}return D(r)}function D(t){var e=t.length;if(e<=tt)return String.fromCharCode.apply(String,t);for(var n="",r=0;r<e;)n+=String.fromCharCode.apply(String,t.slice(r,r+=tt));return n}function F(t,e,n){var r="";n=Math.min(t.length,n);for(var a=e;a<n;++a)r+=String.fromCharCode(127&t[a]);return r}function N(t,e,n){var r="";n=Math.min(t.length,n);for(var a=e;a<n;++a)r+=String.fromCharCode(t[a]);return r}function L(t,e,n){var r=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>r)&&(n=r);for(var a="",i=e;i<n;++i)a+=Y(t[i]);return a}function P(t,e,n){for(var r=t.slice(e,n),a="",i=0;i<r.length;i+=2)a+=String.fromCharCode(r[i]+256*r[i+1]);return a}function C(t,e,n){if(t%1!==0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function O(t,e,n,r,a,i){if(!o.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>a||e<i)throw new RangeError('"value" argument is out of bounds');if(n+r>t.length)throw new RangeError("Index out of range")}function j(t,e,n,r){e<0&&(e=65535+e+1);for(var a=0,i=Math.min(t.length-n,2);a<i;++a)t[n+a]=(e&255<<8*(r?a:1-a))>>>8*(r?a:1-a)}function U(t,e,n,r){e<0&&(e=4294967295+e+1);for(var a=0,i=Math.min(t.length-n,4);a<i;++a)t[n+a]=e>>>8*(r?a:3-a)&255}function z(t,e,n,r,a,i){if(n+r>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function k(t,e,n,r,a){return a||z(t,e,n,4,3.4028234663852886e38,-3.4028234663852886e38),J.write(t,e,n,r,23,4),n+4}function B(t,e,n,r,a){return a||z(t,e,n,8,1.7976931348623157e308,-1.7976931348623157e308),J.write(t,e,n,r,52,8),n+8}function V(t){if(t=q(t).replace(et,""),t.length<2)return"";for(;t.length%4!==0;)t+="=";return t}function q(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function Y(t){return t<16?"0"+t.toString(16):t.toString(16)}function H(t,e){e=e||1/0;for(var n,r=t.length,a=null,i=[],o=0;o<r;++o){if(n=t.charCodeAt(o),n>55295&&n<57344){if(!a){if(n>56319){(e-=3)>-1&&i.push(239,191,189);continue}if(o+1===r){(e-=3)>-1&&i.push(239,191,189);continue}a=n;continue}if(n<56320){(e-=3)>-1&&i.push(239,191,189),a=n;continue}n=(a-55296<<10|n-56320)+65536}else a&&(e-=3)>-1&&i.push(239,191,189);if(a=null,n<128){if((e-=1)<0)break;i.push(n)}else if(n<2048){if((e-=2)<0)break;i.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;i.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;i.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return i}function G(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}function X(t,e){for(var n,r,a,i=[],o=0;o<t.length&&!((e-=2)<0);++o)n=t.charCodeAt(o),r=n>>8,a=n%256,i.push(a),i.push(r);return i}function W(t){return K.toByteArray(V(t))}function Z(t,e,n,r){for(var a=0;a<r&&!(a+n>=e.length||a>=t.length);++a)e[a+n]=t[a];return a}function Q(t){return t!==t}var K=t("base64-js"),J=t("ieee754"),$=t("isarray");n.Buffer=o,n.SlowBuffer=m,n.INSPECT_MAX_BYTES=50,o.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:r(),n.kMaxLength=a(),o.poolSize=8192,o._augment=function(t){return t.__proto__=o.prototype,t},o.from=function(t,e,n){return s(null,t,e,n)},o.TYPED_ARRAY_SUPPORT&&(o.prototype.__proto__=Uint8Array.prototype,o.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&o[Symbol.species]===o&&Object.defineProperty(o,Symbol.species,{value:null,configurable:!0})),o.alloc=function(t,e,n){return l(null,t,e,n)},o.allocUnsafe=function(t){return c(null,t)},o.allocUnsafeSlow=function(t){return c(null,t)},o.isBuffer=function(t){return!(null==t||!t._isBuffer)},o.compare=function(t,e){if(!o.isBuffer(t)||!o.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var n=t.length,r=e.length,a=0,i=Math.min(n,r);a<i;++a)if(t[a]!==e[a]){n=t[a],r=e[a];break}return n<r?-1:r<n?1:0},o.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},o.concat=function(t,e){if(!$(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return o.alloc(0);var n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;var r=o.allocUnsafe(e),a=0;for(n=0;n<t.length;++n){var i=t[n];if(!o.isBuffer(i))throw new TypeError('"list" argument must be an Array of Buffers');i.copy(r,a),a+=i.length}return r},o.byteLength=v,o.prototype._isBuffer=!0,o.prototype.swap16=function(){var t=this.length;if(t%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)_(this,e,e+1);return this},o.prototype.swap32=function(){var t=this.length;if(t%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)_(this,e,e+3),_(this,e+1,e+2);return this},o.prototype.swap64=function(){var t=this.length;if(t%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)_(this,e,e+7),_(this,e+1,e+6),_(this,e+2,e+5),_(this,e+3,e+4);return this},o.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?R(this,0,t):y.apply(this,arguments)},o.prototype.equals=function(t){if(!o.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===o.compare(this,t)},o.prototype.inspect=function(){var t="",e=n.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,e).match(/.{2}/g).join(" "),this.length>e&&(t+=" ... ")),"<Buffer "+t+">"},o.prototype.compare=function(t,e,n,r,a){if(!o.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===r&&(r=0),void 0===a&&(a=this.length),e<0||n>t.length||r<0||a>this.length)throw new RangeError("out of range index");if(r>=a&&e>=n)return 0;if(r>=a)return-1;if(e>=n)return 1;if(e>>>=0,n>>>=0,r>>>=0,a>>>=0,this===t)return 0;for(var i=a-r,s=n-e,u=Math.min(i,s),l=this.slice(r,a),c=t.slice(e,n),f=0;f<u;++f)if(l[f]!==c[f]){i=l[f],s=c[f];break}return i<s?-1:s<i?1:0},o.prototype.includes=function(t,e,n){return this.indexOf(t,e,n)!==-1},o.prototype.indexOf=function(t,e,n){return b(this,t,e,n,!0)},o.prototype.lastIndexOf=function(t,e,n){return b(this,t,e,n,!1)},o.prototype.write=function(t,e,n,r){if(void 0===e)r="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)r=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var a=this.length-e;if((void 0===n||n>a)&&(n=a),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var i=!1;;)switch(r){case"hex":return w(this,t,e,n);case"utf8":case"utf-8":return E(this,t,e,n);case"ascii":return M(this,t,e,n);case"latin1":case"binary":return I(this,t,e,n);case"base64":return A(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return S(this,t,e,n);default:if(i)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),i=!0}},o.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var tt=4096;o.prototype.slice=function(t,e){var n=this.length;t=~~t,e=void 0===e?n:~~e,t<0?(t+=n,t<0&&(t=0)):t>n&&(t=n),e<0?(e+=n,e<0&&(e=0)):e>n&&(e=n),e<t&&(e=t);var r;if(o.TYPED_ARRAY_SUPPORT)r=this.subarray(t,e),r.__proto__=o.prototype;else{var a=e-t;r=new o(a,void 0);for(var i=0;i<a;++i)r[i]=this[i+t]}return r},o.prototype.readUIntLE=function(t,e,n){t|=0,e|=0,n||C(t,e,this.length);for(var r=this[t],a=1,i=0;++i<e&&(a*=256);)r+=this[t+i]*a;return r},o.prototype.readUIntBE=function(t,e,n){t|=0,e|=0,n||C(t,e,this.length);for(var r=this[t+--e],a=1;e>0&&(a*=256);)r+=this[t+--e]*a;return r},o.prototype.readUInt8=function(t,e){return e||C(t,1,this.length),this[t]},o.prototype.readUInt16LE=function(t,e){return e||C(t,2,this.length),this[t]|this[t+1]<<8},o.prototype.readUInt16BE=function(t,e){return e||C(t,2,this.length),this[t]<<8|this[t+1]},o.prototype.readUInt32LE=function(t,e){return e||C(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},o.prototype.readUInt32BE=function(t,e){return e||C(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},o.prototype.readIntLE=function(t,e,n){t|=0,e|=0,n||C(t,e,this.length);for(var r=this[t],a=1,i=0;++i<e&&(a*=256);)r+=this[t+i]*a;return a*=128,r>=a&&(r-=Math.pow(2,8*e)),r},o.prototype.readIntBE=function(t,e,n){t|=0,e|=0,n||C(t,e,this.length);for(var r=e,a=1,i=this[t+--r];r>0&&(a*=256);)i+=this[t+--r]*a;return a*=128,i>=a&&(i-=Math.pow(2,8*e)),i},o.prototype.readInt8=function(t,e){return e||C(t,1,this.length),128&this[t]?(255-this[t]+1)*-1:this[t]},o.prototype.readInt16LE=function(t,e){e||C(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},o.prototype.readInt16BE=function(t,e){e||C(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},o.prototype.readInt32LE=function(t,e){return e||C(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},o.prototype.readInt32BE=function(t,e){return e||C(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},o.prototype.readFloatLE=function(t,e){return e||C(t,4,this.length),J.read(this,t,!0,23,4)},o.prototype.readFloatBE=function(t,e){return e||C(t,4,this.length),J.read(this,t,!1,23,4)},o.prototype.readDoubleLE=function(t,e){return e||C(t,8,this.length),J.read(this,t,!0,52,8)},o.prototype.readDoubleBE=function(t,e){return e||C(t,8,this.length),J.read(this,t,!1,52,8)},o.prototype.writeUIntLE=function(t,e,n,r){if(t=+t,e|=0,n|=0,!r){var a=Math.pow(2,8*n)-1;O(this,t,e,n,a,0)}var i=1,o=0;for(this[e]=255&t;++o<n&&(i*=256);)this[e+o]=t/i&255;return e+n},o.prototype.writeUIntBE=function(t,e,n,r){if(t=+t,e|=0,n|=0,!r){var a=Math.pow(2,8*n)-1;O(this,t,e,n,a,0)}var i=n-1,o=1;for(this[e+i]=255&t;--i>=0&&(o*=256);)this[e+i]=t/o&255;return e+n},o.prototype.writeUInt8=function(t,e,n){return t=+t,e|=0,n||O(this,t,e,1,255,0),o.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},o.prototype.writeUInt16LE=function(t,e,n){return t=+t,e|=0,n||O(this,t,e,2,65535,0),o.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):j(this,t,e,!0),e+2},o.prototype.writeUInt16BE=function(t,e,n){return t=+t,e|=0,n||O(this,t,e,2,65535,0),o.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):j(this,t,e,!1),e+2},o.prototype.writeUInt32LE=function(t,e,n){return t=+t,e|=0,n||O(this,t,e,4,4294967295,0),o.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):U(this,t,e,!0),e+4},o.prototype.writeUInt32BE=function(t,e,n){return t=+t,e|=0,n||O(this,t,e,4,4294967295,0),o.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):U(this,t,e,!1),e+4},o.prototype.writeIntLE=function(t,e,n,r){if(t=+t,e|=0,!r){var a=Math.pow(2,8*n-1);O(this,t,e,n,a-1,-a)}var i=0,o=1,s=0;for(this[e]=255&t;++i<n&&(o*=256);)t<0&&0===s&&0!==this[e+i-1]&&(s=1),this[e+i]=(t/o>>0)-s&255;return e+n},o.prototype.writeIntBE=function(t,e,n,r){if(t=+t,e|=0,!r){var a=Math.pow(2,8*n-1);O(this,t,e,n,a-1,-a)}var i=n-1,o=1,s=0;for(this[e+i]=255&t;--i>=0&&(o*=256);)t<0&&0===s&&0!==this[e+i+1]&&(s=1),this[e+i]=(t/o>>0)-s&255;return e+n},o.prototype.writeInt8=function(t,e,n){return t=+t,e|=0,n||O(this,t,e,1,127,-128),o.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},o.prototype.writeInt16LE=function(t,e,n){return t=+t,e|=0,n||O(this,t,e,2,32767,-32768),o.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):j(this,t,e,!0),e+2},o.prototype.writeInt16BE=function(t,e,n){return t=+t,e|=0,n||O(this,t,e,2,32767,-32768),o.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):j(this,t,e,!1),e+2},o.prototype.writeInt32LE=function(t,e,n){return t=+t,e|=0,n||O(this,t,e,4,2147483647,-2147483648),o.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):U(this,t,e,!0),e+4},o.prototype.writeInt32BE=function(t,e,n){return t=+t,e|=0,n||O(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),o.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):U(this,t,e,!1),e+4},o.prototype.writeFloatLE=function(t,e,n){return k(this,t,e,!0,n)},o.prototype.writeFloatBE=function(t,e,n){return k(this,t,e,!1,n)},o.prototype.writeDoubleLE=function(t,e,n){return B(this,t,e,!0,n)},o.prototype.writeDoubleBE=function(t,e,n){return B(this,t,e,!1,n)},o.prototype.copy=function(t,e,n,r){if(n||(n=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);var a,i=r-n;if(this===t&&n<e&&e<r)for(a=i-1;a>=0;--a)t[a+e]=this[a+n];else if(i<1e3||!o.TYPED_ARRAY_SUPPORT)for(a=0;a<i;++a)t[a+e]=this[a+n];else Uint8Array.prototype.set.call(t,this.subarray(n,n+i),e);return i},o.prototype.fill=function(t,e,n,r){if("string"==typeof t){if("string"==typeof e?(r=e,e=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===t.length){var a=t.charCodeAt(0);a<256&&(t=a)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!o.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0);var i;if("number"==typeof t)for(i=e;i<n;++i)this[i]=t;else{var s=o.isBuffer(t)?t:H(new o(t,r).toString()),u=s.length;
for(i=0;i<n-e;++i)this[i+e]=s[i%u]}return this};var et=/[^+\/0-9A-Za-z-_]/g}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"base64-js":7,ieee754:59,isarray:11}],11:[function(t,e,n){var r={}.toString;e.exports=Array.isArray||function(t){return"[object Array]"==r.call(t)}},{}],12:[function(t,e,n){function r(t,e,n){function r(){var e=r.parent||t.parentNode;if("function"==typeof e)var n=e(i)||i,s=n[0],u=n[1];else if(e&&e!==document.body)var l=a(e),s=0|l[0],u=0|l[1];else var s=window.innerWidth,u=window.innerHeight;return o?(t.setAttribute("width",s*r.scale+"px"),t.setAttribute("height",u*r.scale+"px")):(t.width=s*r.scale,t.height=u*r.scale),t.style.width=s+"px",t.style.height=u+"px",r}var o="SVG"===t.nodeName.toUpperCase();return t.style.position=t.style.position||"absolute",t.style.top=0,t.style.left=0,r.scale=parseFloat(n||1),r.parent=e,r()}var a=t("element-size");e.exports=r;var i=new Float32Array(2)},{"element-size":18}],13:[function(t,e,n){"use strict";function r(){this.argTypes=[],this.shimArgs=[],this.arrayArgs=[],this.arrayBlockIndices=[],this.scalarArgs=[],this.offsetArgs=[],this.offsetArgIndex=[],this.indexArgs=[],this.shapeArgs=[],this.funcName="",this.pre=null,this.body=null,this.post=null,this.debug=!1}function a(t){var e=new r;e.pre=t.pre,e.body=t.body,e.post=t.post;var n=t.args.slice(0);e.argTypes=n;for(var a=0;a<n.length;++a){var o=n[a];if("array"===o||"object"==typeof o&&o.blockIndices){if(e.argTypes[a]="array",e.arrayArgs.push(a),e.arrayBlockIndices.push(o.blockIndices?o.blockIndices:0),e.shimArgs.push("array"+a),a<e.pre.args.length&&e.pre.args[a].count>0)throw new Error("cwise: pre() block may not reference array args");if(a<e.post.args.length&&e.post.args[a].count>0)throw new Error("cwise: post() block may not reference array args")}else if("scalar"===o)e.scalarArgs.push(a),e.shimArgs.push("scalar"+a);else if("index"===o){if(e.indexArgs.push(a),a<e.pre.args.length&&e.pre.args[a].count>0)throw new Error("cwise: pre() block may not reference array index");if(a<e.body.args.length&&e.body.args[a].lvalue)throw new Error("cwise: body() block may not write to array index");if(a<e.post.args.length&&e.post.args[a].count>0)throw new Error("cwise: post() block may not reference array index")}else if("shape"===o){if(e.shapeArgs.push(a),a<e.pre.args.length&&e.pre.args[a].lvalue)throw new Error("cwise: pre() block may not write to array shape");if(a<e.body.args.length&&e.body.args[a].lvalue)throw new Error("cwise: body() block may not write to array shape");if(a<e.post.args.length&&e.post.args[a].lvalue)throw new Error("cwise: post() block may not write to array shape")}else{if("object"!=typeof o||!o.offset)throw new Error("cwise: Unknown argument type "+n[a]);e.argTypes[a]="offset",e.offsetArgs.push({array:o.array,offset:o.offset}),e.offsetArgIndex.push(a)}}if(e.arrayArgs.length<=0)throw new Error("cwise: No array arguments specified");if(e.pre.args.length>n.length)throw new Error("cwise: Too many arguments in pre() block");if(e.body.args.length>n.length)throw new Error("cwise: Too many arguments in body() block");if(e.post.args.length>n.length)throw new Error("cwise: Too many arguments in post() block");return e.debug=!!t.printCode||!!t.debug,e.funcName=t.funcName||"cwise",e.blockSize=t.blockSize||64,i(e)}var i=t("./lib/thunk.js");e.exports=a},{"./lib/thunk.js":15}],14:[function(t,e,n){"use strict";function r(t,e,n){var r,a,i=t.length,o=e.arrayArgs.length,s=e.indexArgs.length>0,u=[],l=[],c=0,f=0;for(r=0;r<i;++r)l.push(["i",r,"=0"].join(""));for(a=0;a<o;++a)for(r=0;r<i;++r)f=c,c=t[r],0===r?l.push(["d",a,"s",r,"=t",a,"p",c].join("")):l.push(["d",a,"s",r,"=(t",a,"p",c,"-s",f,"*t",a,"p",f,")"].join(""));for(u.push("var "+l.join(",")),r=i-1;r>=0;--r)c=t[r],u.push(["for(i",r,"=0;i",r,"<s",c,";++i",r,"){"].join(""));for(u.push(n),r=0;r<i;++r){for(f=c,c=t[r],a=0;a<o;++a)u.push(["p",a,"+=d",a,"s",r].join(""));s&&(r>0&&u.push(["index[",f,"]-=s",f].join("")),u.push(["++index[",c,"]"].join(""))),u.push("}")}return u.join("\n")}function a(t,e,n,a){for(var i=e.length,o=n.arrayArgs.length,s=n.blockSize,u=n.indexArgs.length>0,l=[],c=0;c<o;++c)l.push(["var offset",c,"=p",c].join(""));for(var c=t;c<i;++c)l.push(["for(var j"+c+"=SS[",e[c],"]|0;j",c,">0;){"].join("")),l.push(["if(j",c,"<",s,"){"].join("")),l.push(["s",e[c],"=j",c].join("")),l.push(["j",c,"=0"].join("")),l.push(["}else{s",e[c],"=",s].join("")),l.push(["j",c,"-=",s,"}"].join("")),u&&l.push(["index[",e[c],"]=j",c].join(""));for(var c=0;c<o;++c){for(var f=["offset"+c],h=t;h<i;++h)f.push(["j",h,"*t",c,"p",e[h]].join(""));l.push(["p",c,"=(",f.join("+"),")"].join(""))}l.push(r(e,n,a));for(var c=t;c<i;++c)l.push("}");return l.join("\n")}function i(t){for(var e=0,n=t[0].length;e<n;){for(var r=1;r<t.length;++r)if(t[r][e]!==t[0][e])return e;++e}return e}function o(t,e,n){for(var r=t.body,a=[],i=[],o=0;o<t.args.length;++o){var s=t.args[o];if(!(s.count<=0)){var u=new RegExp(s.name,"g"),l="",c=e.arrayArgs.indexOf(o);switch(e.argTypes[o]){case"offset":var f=e.offsetArgIndex.indexOf(o),h=e.offsetArgs[f];c=h.array,l="+q"+f;case"array":l="p"+c+l;var d="l"+o,p="a"+c;if(0===e.arrayBlockIndices[c])1===s.count?"generic"===n[c]?s.lvalue?(a.push(["var ",d,"=",p,".get(",l,")"].join("")),r=r.replace(u,d),i.push([p,".set(",l,",",d,")"].join(""))):r=r.replace(u,[p,".get(",l,")"].join("")):r=r.replace(u,[p,"[",l,"]"].join("")):"generic"===n[c]?(a.push(["var ",d,"=",p,".get(",l,")"].join("")),r=r.replace(u,d),s.lvalue&&i.push([p,".set(",l,",",d,")"].join(""))):(a.push(["var ",d,"=",p,"[",l,"]"].join("")),r=r.replace(u,d),s.lvalue&&i.push([p,"[",l,"]=",d].join("")));else{for(var g=[s.name],m=[l],v=0;v<Math.abs(e.arrayBlockIndices[c]);v++)g.push("\\s*\\[([^\\]]+)\\]"),m.push("$"+(v+1)+"*t"+c+"b"+v);if(u=new RegExp(g.join(""),"g"),l=m.join("+"),"generic"===n[c])throw new Error("cwise: Generic arrays not supported in combination with blocks!");r=r.replace(u,[p,"[",l,"]"].join(""))}break;case"scalar":r=r.replace(u,"Y"+e.scalarArgs.indexOf(o));break;case"index":r=r.replace(u,"index");break;case"shape":r=r.replace(u,"shape")}}}return[a.join("\n"),r,i.join("\n")].join("\n").trim()}function s(t){for(var e=new Array(t.length),n=!0,r=0;r<t.length;++r){var a=t[r],i=a.match(/\d+/);i=i?i[0]:"",0===a.charAt(0)?e[r]="u"+a.charAt(1)+i:e[r]=a.charAt(0)+i,r>0&&(n=n&&e[r]===e[r-1])}return n?e[0]:e.join("")}function u(t,e){for(var n=e[1].length-Math.abs(t.arrayBlockIndices[0])|0,u=new Array(t.arrayArgs.length),c=new Array(t.arrayArgs.length),f=0;f<t.arrayArgs.length;++f)c[f]=e[2*f],u[f]=e[2*f+1];for(var h=[],d=[],p=[],g=[],m=[],f=0;f<t.arrayArgs.length;++f){t.arrayBlockIndices[f]<0?(p.push(0),g.push(n),h.push(n),d.push(n+t.arrayBlockIndices[f])):(p.push(t.arrayBlockIndices[f]),g.push(t.arrayBlockIndices[f]+n),h.push(0),d.push(t.arrayBlockIndices[f]));for(var v=[],y=0;y<u[f].length;y++)p[f]<=u[f][y]&&u[f][y]<g[f]&&v.push(u[f][y]-p[f]);m.push(v)}for(var _=["SS"],b=["'use strict'"],x=[],y=0;y<n;++y)x.push(["s",y,"=SS[",y,"]"].join(""));for(var f=0;f<t.arrayArgs.length;++f){_.push("a"+f),_.push("t"+f),_.push("p"+f);for(var y=0;y<n;++y)x.push(["t",f,"p",y,"=t",f,"[",p[f]+y,"]"].join(""));for(var y=0;y<Math.abs(t.arrayBlockIndices[f]);++y)x.push(["t",f,"b",y,"=t",f,"[",h[f]+y,"]"].join(""))}for(var f=0;f<t.scalarArgs.length;++f)_.push("Y"+f);if(t.shapeArgs.length>0&&x.push("shape=SS.slice(0)"),t.indexArgs.length>0){for(var w=new Array(n),f=0;f<n;++f)w[f]="0";x.push(["index=[",w.join(","),"]"].join(""))}for(var f=0;f<t.offsetArgs.length;++f){for(var E=t.offsetArgs[f],M=[],y=0;y<E.offset.length;++y)0!==E.offset[y]&&(1===E.offset[y]?M.push(["t",E.array,"p",y].join("")):M.push([E.offset[y],"*t",E.array,"p",y].join("")));0===M.length?x.push("q"+f+"=0"):x.push(["q",f,"=",M.join("+")].join(""))}var I=l([].concat(t.pre.thisVars).concat(t.body.thisVars).concat(t.post.thisVars));x=x.concat(I),b.push("var "+x.join(","));for(var f=0;f<t.arrayArgs.length;++f)b.push("p"+f+"|=0");t.pre.body.length>3&&b.push(o(t.pre,t,c));var A=o(t.body,t,c),S=i(m);S<n?b.push(a(S,m[0],t,A)):b.push(r(m[0],t,A)),t.post.body.length>3&&b.push(o(t.post,t,c)),t.debug&&console.log("-----Generated cwise routine for ",e,":\n"+b.join("\n")+"\n----------");var T=[t.funcName||"unnamed","_cwise_loop_",u[0].join("s"),"m",S,s(c)].join(""),R=new Function(["function ",T,"(",_.join(","),"){",b.join("\n"),"} return ",T].join(""));return R()}var l=t("uniq");e.exports=u},{uniq:79}],15:[function(t,e,n){"use strict";function r(t){var e=["'use strict'","var CACHED={}"],n=[],r=t.funcName+"_cwise_thunk";e.push(["return function ",r,"(",t.shimArgs.join(","),"){"].join(""));for(var i=[],o=[],s=[["array",t.arrayArgs[0],".shape.slice(",Math.max(0,t.arrayBlockIndices[0]),t.arrayBlockIndices[0]<0?","+t.arrayBlockIndices[0]+")":")"].join("")],u=[],l=[],c=0;c<t.arrayArgs.length;++c){var f=t.arrayArgs[c];n.push(["t",f,"=array",f,".dtype,","r",f,"=array",f,".order"].join("")),i.push("t"+f),i.push("r"+f),o.push("t"+f),o.push("r"+f+".join()"),s.push("array"+f+".data"),s.push("array"+f+".stride"),s.push("array"+f+".offset|0"),c>0&&(u.push("array"+t.arrayArgs[0]+".shape.length===array"+f+".shape.length+"+(Math.abs(t.arrayBlockIndices[0])-Math.abs(t.arrayBlockIndices[c]))),l.push("array"+t.arrayArgs[0]+".shape[shapeIndex+"+Math.max(0,t.arrayBlockIndices[0])+"]===array"+f+".shape[shapeIndex+"+Math.max(0,t.arrayBlockIndices[c])+"]"))}t.arrayArgs.length>1&&(e.push("if (!("+u.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same dimensionality!')"),e.push("for(var shapeIndex=array"+t.arrayArgs[0]+".shape.length-"+Math.abs(t.arrayBlockIndices[0])+"; shapeIndex-->0;) {"),e.push("if (!("+l.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same shape!')"),e.push("}"));for(var c=0;c<t.scalarArgs.length;++c)s.push("scalar"+t.scalarArgs[c]);n.push(["type=[",o.join(","),"].join()"].join("")),n.push("proc=CACHED[type]"),e.push("var "+n.join(",")),e.push(["if(!proc){","CACHED[type]=proc=compile([",i.join(","),"])}","return proc(",s.join(","),")}"].join("")),t.debug&&console.log("-----Generated thunk:\n"+e.join("\n")+"\n----------");var h=new Function("compile",e.join("\n"));return h(a.bind(void 0,t))}var a=t("./compile.js");e.exports=r},{"./compile.js":14}],16:[function(t,e,n){e.exports=function(){for(var t=0;t<arguments.length;t++)if(void 0!==arguments[t])return arguments[t]}},{}],17:[function(t,e,n){"use strict";function r(t,e,n){var a=0|t[n];if(a<=0)return[];var i,o=new Array(a);if(n===t.length-1)for(i=0;i<a;++i)o[i]=e;else for(i=0;i<a;++i)o[i]=r(t,e,n+1);return o}function a(t,e){var n,r;for(n=new Array(t),r=0;r<t;++r)n[r]=e;return n}function i(t,e){switch("undefined"==typeof e&&(e=0),typeof t){case"number":if(t>0)return a(0|t,e);break;case"object":if("number"==typeof t.length)return r(t,e,0)}return[]}e.exports=i},{}],18:[function(t,e,n){function r(t){if(t===window||t===document.body)return[window.innerWidth,window.innerHeight];if(!t.parentNode){var e=!0;document.body.appendChild(t)}var n=t.getBoundingClientRect(),r=getComputedStyle(t),i=(0|n.height)+a(r.getPropertyValue("margin-top"))+a(r.getPropertyValue("margin-bottom")),o=(0|n.width)+a(r.getPropertyValue("margin-left"))+a(r.getPropertyValue("margin-right"));return e&&document.body.removeChild(t),[o,i]}function a(t){return parseFloat(t)||0}e.exports=r},{}],19:[function(t,e,n){function r(t,e,n){if(!(this instanceof r))return new r(t,e,n);this.gl=t,this.audio=e,this.ctx=n||new AudioContext,this.waa=a(this.audio,this.ctx);var s=(this.waa.analyser[0]||this.waa.analyser).frequencyBinCount;this.waveNda=o(new Float32Array(s),[s,1]),this.waveTex=i(t,this.waveNda,{float:!0}),this.waveFlt=this.waveNda.data,this.freqNda=o(new Float32Array(s),[s,1]),this.freqTex=i(t,this.freqNda,{float:!0}),this.freqFlt=this.freqNda.data}var a=t("web-audio-analyser"),i=t("gl-texture2d"),o=t("ndarray");e.exports=r,r.prototype.waveform=function(t){return this.waa.waveform(null,t)},r.prototype.frequencies=function(t){return this.waa.frequencies(null,t)},r.prototype.bindWaveform=function(t){for(var e=this.waveform(),n=this.waveFlt,r=0;r<e.length;r++)n[r]=(e[r]-128)/128;var a=this.waveTex.bind(t);return this.waveTex.setPixels(this.waveNda),a},r.prototype.bindFrequencies=function(t){for(var e=this.frequencies(),n=this.freqFlt,r=0;r<e.length;r++)n[r]=e[r]/256;var a=this.freqTex.bind(t);return this.freqTex.setPixels(this.freqNda),a}},{"gl-texture2d":43,ndarray:65,"web-audio-analyser":84}],20:[function(t,e,n){"use strict";function r(t,e,n,r,a){this.gl=t,this.type=e,this.handle=n,this.length=r,this.usage=a}function a(t,e,n,r,a,i){var o=a.length*a.BYTES_PER_ELEMENT;if(i<0)return t.bufferData(e,a,r),o;if(o+i>n)throw new Error("gl-buffer: If resizing buffer, must not specify offset");return t.bufferSubData(e,i,a),n}function i(t,e){for(var n=u.malloc(t.length,e),r=t.length,a=0;a<r;++a)n[a]=t[a];return n}function o(t,e){for(var n=1,r=e.length-1;r>=0;--r){if(e[r]!==n)return!1;n*=t[r]}return!0}function s(t,e,n,a){if(n=n||t.ARRAY_BUFFER,a=a||t.DYNAMIC_DRAW,n!==t.ARRAY_BUFFER&&n!==t.ELEMENT_ARRAY_BUFFER)throw new Error("gl-buffer: Invalid type for webgl buffer, must be either gl.ARRAY_BUFFER or gl.ELEMENT_ARRAY_BUFFER");if(a!==t.DYNAMIC_DRAW&&a!==t.STATIC_DRAW&&a!==t.STREAM_DRAW)throw new Error("gl-buffer: Invalid usage for buffer, must be either gl.DYNAMIC_DRAW, gl.STATIC_DRAW or gl.STREAM_DRAW");var i=t.createBuffer(),o=new r(t,n,i,0,a);return o.update(e),o}var u=t("typedarray-pool"),l=t("ndarray-ops"),c=t("ndarray"),f=["uint8","uint8_clamped","uint16","uint32","int8","int16","int32","float32"],h=r.prototype;h.bind=function(){this.gl.bindBuffer(this.type,this.handle)},h.unbind=function(){this.gl.bindBuffer(this.type,null)},h.dispose=function(){this.gl.deleteBuffer(this.handle)},h.update=function(t,e){if("number"!=typeof e&&(e=-1),this.bind(),"object"==typeof t&&"undefined"!=typeof t.shape){var n=t.dtype;if(f.indexOf(n)<0&&(n="float32"),this.type===this.gl.ELEMENT_ARRAY_BUFFER){var r=gl.getExtension("OES_element_index_uint");n=r&&"uint16"!==n?"uint32":"uint16"}if(n===t.dtype&&o(t.shape,t.stride))0===t.offset&&t.data.length===t.shape[0]?this.length=a(this.gl,this.type,this.length,this.usage,t.data,e):this.length=a(this.gl,this.type,this.length,this.usage,t.data.subarray(t.offset,t.shape[0]),e);else{var s=u.malloc(t.size,n),h=c(s,t.shape);l.assign(h,t),e<0?this.length=a(this.gl,this.type,this.length,this.usage,s,e):this.length=a(this.gl,this.type,this.length,this.usage,s.subarray(0,t.size),e),u.free(s)}}else if(Array.isArray(t)){var d;d=this.type===this.gl.ELEMENT_ARRAY_BUFFER?i(t,"uint16"):i(t,"float32"),e<0?this.length=a(this.gl,this.type,this.length,this.usage,d,e):this.length=a(this.gl,this.type,this.length,this.usage,d.subarray(0,t.length),e),u.free(d)}else if("object"==typeof t&&"number"==typeof t.length)this.length=a(this.gl,this.type,this.length,this.usage,t,e);else{if("number"!=typeof t&&void 0!==t)throw new Error("gl-buffer: Invalid data type");if(e>=0)throw new Error("gl-buffer: Cannot specify offset when resizing buffer");t|=0,t<=0&&(t=1),this.gl.bufferData(this.type,0|t,this.usage),this.length=t}},e.exports=s},{ndarray:65,"ndarray-ops":64,"typedarray-pool":78}],21:[function(t,e,n){e.exports={0:"NONE",1:"ONE",2:"LINE_LOOP",3:"LINE_STRIP",4:"TRIANGLES",5:"TRIANGLE_STRIP",6:"TRIANGLE_FAN",256:"DEPTH_BUFFER_BIT",512:"NEVER",513:"LESS",514:"EQUAL",515:"LEQUAL",516:"GREATER",517:"NOTEQUAL",518:"GEQUAL",519:"ALWAYS",768:"SRC_COLOR",769:"ONE_MINUS_SRC_COLOR",770:"SRC_ALPHA",771:"ONE_MINUS_SRC_ALPHA",772:"DST_ALPHA",773:"ONE_MINUS_DST_ALPHA",774:"DST_COLOR",775:"ONE_MINUS_DST_COLOR",776:"SRC_ALPHA_SATURATE",1024:"STENCIL_BUFFER_BIT",1028:"FRONT",1029:"BACK",1032:"FRONT_AND_BACK",1280:"INVALID_ENUM",1281:"INVALID_VALUE",1282:"INVALID_OPERATION",1285:"OUT_OF_MEMORY",1286:"INVALID_FRAMEBUFFER_OPERATION",2304:"CW",2305:"CCW",2849:"LINE_WIDTH",2884:"CULL_FACE",2885:"CULL_FACE_MODE",2886:"FRONT_FACE",2928:"DEPTH_RANGE",2929:"DEPTH_TEST",2930:"DEPTH_WRITEMASK",2931:"DEPTH_CLEAR_VALUE",2932:"DEPTH_FUNC",2960:"STENCIL_TEST",2961:"STENCIL_CLEAR_VALUE",2962:"STENCIL_FUNC",2963:"STENCIL_VALUE_MASK",2964:"STENCIL_FAIL",2965:"STENCIL_PASS_DEPTH_FAIL",2966:"STENCIL_PASS_DEPTH_PASS",2967:"STENCIL_REF",2968:"STENCIL_WRITEMASK",2978:"VIEWPORT",3024:"DITHER",3042:"BLEND",3088:"SCISSOR_BOX",3089:"SCISSOR_TEST",3106:"COLOR_CLEAR_VALUE",3107:"COLOR_WRITEMASK",3317:"UNPACK_ALIGNMENT",3333:"PACK_ALIGNMENT",3379:"MAX_TEXTURE_SIZE",3386:"MAX_VIEWPORT_DIMS",3408:"SUBPIXEL_BITS",3410:"RED_BITS",3411:"GREEN_BITS",3412:"BLUE_BITS",3413:"ALPHA_BITS",3414:"DEPTH_BITS",3415:"STENCIL_BITS",3553:"TEXTURE_2D",4352:"DONT_CARE",4353:"FASTEST",4354:"NICEST",5120:"BYTE",5121:"UNSIGNED_BYTE",5122:"SHORT",5123:"UNSIGNED_SHORT",5124:"INT",5125:"UNSIGNED_INT",5126:"FLOAT",5386:"INVERT",5890:"TEXTURE",6401:"STENCIL_INDEX",6402:"DEPTH_COMPONENT",6406:"ALPHA",6407:"RGB",6408:"RGBA",6409:"LUMINANCE",6410:"LUMINANCE_ALPHA",7680:"KEEP",7681:"REPLACE",7682:"INCR",7683:"DECR",7936:"VENDOR",7937:"RENDERER",7938:"VERSION",9728:"NEAREST",9729:"LINEAR",9984:"NEAREST_MIPMAP_NEAREST",9985:"LINEAR_MIPMAP_NEAREST",9986:"NEAREST_MIPMAP_LINEAR",9987:"LINEAR_MIPMAP_LINEAR",10240:"TEXTURE_MAG_FILTER",10241:"TEXTURE_MIN_FILTER",10242:"TEXTURE_WRAP_S",10243:"TEXTURE_WRAP_T",10497:"REPEAT",10752:"POLYGON_OFFSET_UNITS",16384:"COLOR_BUFFER_BIT",32769:"CONSTANT_COLOR",32770:"ONE_MINUS_CONSTANT_COLOR",32771:"CONSTANT_ALPHA",32772:"ONE_MINUS_CONSTANT_ALPHA",32773:"BLEND_COLOR",32774:"FUNC_ADD",32777:"BLEND_EQUATION_RGB",32778:"FUNC_SUBTRACT",32779:"FUNC_REVERSE_SUBTRACT",32819:"UNSIGNED_SHORT_4_4_4_4",32820:"UNSIGNED_SHORT_5_5_5_1",32823:"POLYGON_OFFSET_FILL",32824:"POLYGON_OFFSET_FACTOR",32854:"RGBA4",32855:"RGB5_A1",32873:"TEXTURE_BINDING_2D",32926:"SAMPLE_ALPHA_TO_COVERAGE",32928:"SAMPLE_COVERAGE",32936:"SAMPLE_BUFFERS",32937:"SAMPLES",32938:"SAMPLE_COVERAGE_VALUE",32939:"SAMPLE_COVERAGE_INVERT",32968:"BLEND_DST_RGB",32969:"BLEND_SRC_RGB",32970:"BLEND_DST_ALPHA",32971:"BLEND_SRC_ALPHA",33071:"CLAMP_TO_EDGE",33170:"GENERATE_MIPMAP_HINT",33189:"DEPTH_COMPONENT16",33306:"DEPTH_STENCIL_ATTACHMENT",33635:"UNSIGNED_SHORT_5_6_5",33648:"MIRRORED_REPEAT",33901:"ALIASED_POINT_SIZE_RANGE",33902:"ALIASED_LINE_WIDTH_RANGE",33984:"TEXTURE0",33985:"TEXTURE1",33986:"TEXTURE2",33987:"TEXTURE3",33988:"TEXTURE4",33989:"TEXTURE5",33990:"TEXTURE6",33991:"TEXTURE7",33992:"TEXTURE8",33993:"TEXTURE9",33994:"TEXTURE10",33995:"TEXTURE11",33996:"TEXTURE12",33997:"TEXTURE13",33998:"TEXTURE14",33999:"TEXTURE15",34e3:"TEXTURE16",34001:"TEXTURE17",34002:"TEXTURE18",34003:"TEXTURE19",34004:"TEXTURE20",34005:"TEXTURE21",34006:"TEXTURE22",34007:"TEXTURE23",34008:"TEXTURE24",34009:"TEXTURE25",34010:"TEXTURE26",34011:"TEXTURE27",34012:"TEXTURE28",34013:"TEXTURE29",34014:"TEXTURE30",34015:"TEXTURE31",34016:"ACTIVE_TEXTURE",34024:"MAX_RENDERBUFFER_SIZE",34041:"DEPTH_STENCIL",34055:"INCR_WRAP",34056:"DECR_WRAP",34067:"TEXTURE_CUBE_MAP",34068:"TEXTURE_BINDING_CUBE_MAP",34069:"TEXTURE_CUBE_MAP_POSITIVE_X",34070:"TEXTURE_CUBE_MAP_NEGATIVE_X",34071:"TEXTURE_CUBE_MAP_POSITIVE_Y",34072:"TEXTURE_CUBE_MAP_NEGATIVE_Y",34073:"TEXTURE_CUBE_MAP_POSITIVE_Z",34074:"TEXTURE_CUBE_MAP_NEGATIVE_Z",34076:"MAX_CUBE_MAP_TEXTURE_SIZE",34338:"VERTEX_ATTRIB_ARRAY_ENABLED",34339:"VERTEX_ATTRIB_ARRAY_SIZE",34340:"VERTEX_ATTRIB_ARRAY_STRIDE",34341:"VERTEX_ATTRIB_ARRAY_TYPE",34342:"CURRENT_VERTEX_ATTRIB",34373:"VERTEX_ATTRIB_ARRAY_POINTER",34466:"NUM_COMPRESSED_TEXTURE_FORMATS",34467:"COMPRESSED_TEXTURE_FORMATS",34660:"BUFFER_SIZE",34661:"BUFFER_USAGE",34816:"STENCIL_BACK_FUNC",34817:"STENCIL_BACK_FAIL",34818:"STENCIL_BACK_PASS_DEPTH_FAIL",34819:"STENCIL_BACK_PASS_DEPTH_PASS",34877:"BLEND_EQUATION_ALPHA",34921:"MAX_VERTEX_ATTRIBS",34922:"VERTEX_ATTRIB_ARRAY_NORMALIZED",34930:"MAX_TEXTURE_IMAGE_UNITS",34962:"ARRAY_BUFFER",34963:"ELEMENT_ARRAY_BUFFER",34964:"ARRAY_BUFFER_BINDING",34965:"ELEMENT_ARRAY_BUFFER_BINDING",34975:"VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",35040:"STREAM_DRAW",35044:"STATIC_DRAW",35048:"DYNAMIC_DRAW",35632:"FRAGMENT_SHADER",35633:"VERTEX_SHADER",35660:"MAX_VERTEX_TEXTURE_IMAGE_UNITS",35661:"MAX_COMBINED_TEXTURE_IMAGE_UNITS",35663:"SHADER_TYPE",35664:"FLOAT_VEC2",35665:"FLOAT_VEC3",35666:"FLOAT_VEC4",35667:"INT_VEC2",35668:"INT_VEC3",35669:"INT_VEC4",35670:"BOOL",35671:"BOOL_VEC2",35672:"BOOL_VEC3",35673:"BOOL_VEC4",35674:"FLOAT_MAT2",35675:"FLOAT_MAT3",35676:"FLOAT_MAT4",35678:"SAMPLER_2D",35680:"SAMPLER_CUBE",35712:"DELETE_STATUS",35713:"COMPILE_STATUS",35714:"LINK_STATUS",35715:"VALIDATE_STATUS",35716:"INFO_LOG_LENGTH",35717:"ATTACHED_SHADERS",35718:"ACTIVE_UNIFORMS",35719:"ACTIVE_UNIFORM_MAX_LENGTH",35720:"SHADER_SOURCE_LENGTH",35721:"ACTIVE_ATTRIBUTES",35722:"ACTIVE_ATTRIBUTE_MAX_LENGTH",35724:"SHADING_LANGUAGE_VERSION",35725:"CURRENT_PROGRAM",36003:"STENCIL_BACK_REF",36004:"STENCIL_BACK_VALUE_MASK",36005:"STENCIL_BACK_WRITEMASK",36006:"FRAMEBUFFER_BINDING",36007:"RENDERBUFFER_BINDING",36048:"FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",36049:"FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",36050:"FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",36051:"FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",36053:"FRAMEBUFFER_COMPLETE",36054:"FRAMEBUFFER_INCOMPLETE_ATTACHMENT",36055:"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",36057:"FRAMEBUFFER_INCOMPLETE_DIMENSIONS",36061:"FRAMEBUFFER_UNSUPPORTED",36064:"COLOR_ATTACHMENT0",36096:"DEPTH_ATTACHMENT",36128:"STENCIL_ATTACHMENT",36160:"FRAMEBUFFER",36161:"RENDERBUFFER",36162:"RENDERBUFFER_WIDTH",36163:"RENDERBUFFER_HEIGHT",36164:"RENDERBUFFER_INTERNAL_FORMAT",36168:"STENCIL_INDEX8",36176:"RENDERBUFFER_RED_SIZE",36177:"RENDERBUFFER_GREEN_SIZE",36178:"RENDERBUFFER_BLUE_SIZE",36179:"RENDERBUFFER_ALPHA_SIZE",36180:"RENDERBUFFER_DEPTH_SIZE",36181:"RENDERBUFFER_STENCIL_SIZE",36194:"RGB565",36336:"LOW_FLOAT",36337:"MEDIUM_FLOAT",36338:"HIGH_FLOAT",36339:"LOW_INT",36340:"MEDIUM_INT",36341:"HIGH_INT",36346:"SHADER_COMPILER",36347:"MAX_VERTEX_UNIFORM_VECTORS",36348:"MAX_VARYING_VECTORS",36349:"MAX_FRAGMENT_UNIFORM_VECTORS",37440:"UNPACK_FLIP_Y_WEBGL",37441:"UNPACK_PREMULTIPLY_ALPHA_WEBGL",37442:"CONTEXT_LOST_WEBGL",37443:"UNPACK_COLORSPACE_CONVERSION_WEBGL",37444:"BROWSER_DEFAULT_WEBGL"}},{}],22:[function(t,e,n){var r=t("./1.0/numbers");e.exports=function(t){return r[t]}},{"./1.0/numbers":21}],23:[function(t,e,n){function r(t,e,n){function r(){n(i),a(r)}"function"==typeof e?(n=e,e={}):e=e||{};var i=t.getContext("webgl",e)||t.getContext("webgl-experimental",e)||t.getContext("experimental-webgl",e);if(!i)throw new Error("Unable to initialize WebGL");return n&&a(r),i}var a=t("raf-component");e.exports=r},{"raf-component":72}],24:[function(t,e,n){"use strict";function r(t){var e=t.getParameter(t.FRAMEBUFFER_BINDING),n=t.getParameter(t.RENDERBUFFER_BINDING),r=t.getParameter(t.TEXTURE_BINDING_2D);return[e,n,r]}function a(t,e){t.bindFramebuffer(t.FRAMEBUFFER,e[0]),t.bindRenderbuffer(t.RENDERBUFFER,e[1]),t.bindTexture(t.TEXTURE_2D,e[2])}function i(t,e){var n=t.getParameter(e.MAX_COLOR_ATTACHMENTS_WEBGL);y=new Array(n+1);for(var r=0;r<=n;++r){for(var a=new Array(n),i=0;i<r;++i)a[i]=t.COLOR_ATTACHMENT0+i;for(var i=r;i<n;++i)a[i]=t.NONE;y[r]=a}}function o(t){switch(t){case p:throw new Error("gl-fbo: Framebuffer unsupported");case g:throw new Error("gl-fbo: Framebuffer incomplete attachment");case m:throw new Error("gl-fbo: Framebuffer incomplete dimensions");case v:throw new Error("gl-fbo: Framebuffer incomplete missing attachment");default:throw new Error("gl-fbo: Framebuffer failed for unspecified reason")}}function s(t,e,n,r,a,i){if(!r)return null;var o=d(t,e,n,a,r);return o.magFilter=t.NEAREST,o.minFilter=t.NEAREST,o.mipSamples=1,o.bind(),t.framebufferTexture2D(t.FRAMEBUFFER,i,t.TEXTURE_2D,o.handle,0),o}function u(t,e,n,r,a){var i=t.createRenderbuffer();return t.bindRenderbuffer(t.RENDERBUFFER,i),t.renderbufferStorage(t.RENDERBUFFER,r,e,n),t.framebufferRenderbuffer(t.FRAMEBUFFER,a,t.RENDERBUFFER,i),i}function l(t){var e=r(t.gl),n=t.gl,i=t.handle=n.createFramebuffer(),l=t._shape[0],c=t._shape[1],f=t.color.length,h=t._ext,d=t._useStencil,p=t._useDepth,g=t._colorType;n.bindFramebuffer(n.FRAMEBUFFER,i);for(var m=0;m<f;++m)t.color[m]=s(n,l,c,g,n.RGBA,n.COLOR_ATTACHMENT0+m);0===f?(t._color_rb=u(n,l,c,n.RGBA4,n.COLOR_ATTACHMENT0),h&&h.drawBuffersWEBGL(y[0])):f>1&&h.drawBuffersWEBGL(y[f]);var v=n.getExtension("WEBGL_depth_texture");v?d?t.depth=s(n,l,c,v.UNSIGNED_INT_24_8_WEBGL,n.DEPTH_STENCIL,n.DEPTH_STENCIL_ATTACHMENT):p&&(t.depth=s(n,l,c,n.UNSIGNED_SHORT,n.DEPTH_COMPONENT,n.DEPTH_ATTACHMENT)):p&&d?t._depth_rb=u(n,l,c,n.DEPTH_STENCIL,n.DEPTH_STENCIL_ATTACHMENT):p?t._depth_rb=u(n,l,c,n.DEPTH_COMPONENT16,n.DEPTH_ATTACHMENT):d&&(t._depth_rb=u(n,l,c,n.STENCIL_INDEX,n.STENCIL_ATTACHMENT));var _=n.checkFramebufferStatus(n.FRAMEBUFFER);if(_!==n.FRAMEBUFFER_COMPLETE){t._destroyed=!0,n.bindFramebuffer(n.FRAMEBUFFER,null),n.deleteFramebuffer(t.handle),t.handle=null,t.depth&&(t.depth.dispose(),t.depth=null),t._depth_rb&&(n.deleteRenderbuffer(t._depth_rb),t._depth_rb=null);for(var m=0;m<t.color.length;++m)t.color[m].dispose(),t.color[m]=null;t._color_rb&&(n.deleteRenderbuffer(t._color_rb),t._color_rb=null),a(n,e),o(_)}a(n,e)}function c(t,e,n,r,a,i,o,s){this.gl=t,this._shape=[0|e,0|n],this._destroyed=!1,this._ext=s,this.color=new Array(a);for(var u=0;u<a;++u)this.color[u]=null;this._color_rb=null,this.depth=null,this._depth_rb=null,this._colorType=r,this._useDepth=i,this._useStencil=o;var c=this,f=[0|e,0|n];Object.defineProperties(f,{0:{get:function(){return c._shape[0]},set:function(t){return c.width=t}},1:{get:function(){return c._shape[1]},set:function(t){return c.height=t}}}),this._shapeVector=f,l(this)}function f(t,e,n){if(t._destroyed)throw new Error("gl-fbo: Can't resize destroyed FBO");if(t._shape[0]!==e||t._shape[1]!==n){var i=t.gl,s=i.getParameter(i.MAX_RENDERBUFFER_SIZE);if(e<0||e>s||n<0||n>s)throw new Error("gl-fbo: Can't resize FBO, invalid dimensions");t._shape[0]=e,t._shape[1]=n;for(var u=r(i),l=0;l<t.color.length;++l)t.color[l].shape=t._shape;t._color_rb&&(i.bindRenderbuffer(i.RENDERBUFFER,t._color_rb),i.renderbufferStorage(i.RENDERBUFFER,i.RGBA4,t._shape[0],t._shape[1])),t.depth&&(t.depth.shape=t._shape),t._depth_rb&&(i.bindRenderbuffer(i.RENDERBUFFER,t._depth_rb),t._useDepth&&t._useStencil?i.renderbufferStorage(i.RENDERBUFFER,i.DEPTH_STENCIL,t._shape[0],t._shape[1]):t._useDepth?i.renderbufferStorage(i.RENDERBUFFER,i.DEPTH_COMPONENT16,t._shape[0],t._shape[1]):t._useStencil&&i.renderbufferStorage(i.RENDERBUFFER,i.STENCIL_INDEX,t._shape[0],t._shape[1])),i.bindFramebuffer(i.FRAMEBUFFER,t.handle);var c=i.checkFramebufferStatus(i.FRAMEBUFFER);c!==i.FRAMEBUFFER_COMPLETE&&(t.dispose(),a(i,u),o(c)),a(i,u)}}function h(t,e,n,r){p||(p=t.FRAMEBUFFER_UNSUPPORTED,g=t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT,m=t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS,v=t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT);var a=t.getExtension("WEBGL_draw_buffers");if(!y&&a&&i(t,a),Array.isArray(e)&&(r=n,n=0|e[1],e=0|e[0]),"number"!=typeof e)throw new Error("gl-fbo: Missing shape parameter");var o=t.getParameter(t.MAX_RENDERBUFFER_SIZE);if(e<0||e>o||n<0||n>o)throw new Error("gl-fbo: Parameters are too large for FBO");r=r||{};var s=1;if("color"in r){if(s=Math.max(0|r.color,0),s<0)throw new Error("gl-fbo: Must specify a nonnegative number of colors");if(s>1){if(!a)throw new Error("gl-fbo: Multiple draw buffer extension not supported");if(s>t.getParameter(a.MAX_COLOR_ATTACHMENTS_WEBGL))throw new Error("gl-fbo: Context does not support "+s+" draw buffers")}}var u=t.UNSIGNED_BYTE,l=t.getExtension("OES_texture_float");if(r.float&&s>0){if(!l)throw new Error("gl-fbo: Context does not support floating point textures");u=t.FLOAT}else r.preferFloat&&s>0&&l&&(u=t.FLOAT);var f=!0;"depth"in r&&(f=!!r.depth);var h=!1;return"stencil"in r&&(h=!!r.stencil),new c(t,e,n,u,s,f,h,a)}var d=t("gl-texture2d");e.exports=h;var p,g,m,v,y=null,_=c.prototype;Object.defineProperties(_,{shape:{get:function(){return this._destroyed?[0,0]:this._shapeVector},set:function(t){if(Array.isArray(t)||(t=[0|t,0|t]),2!==t.length)throw new Error("gl-fbo: Shape vector must be length 2");var e=0|t[0],n=0|t[1];return f(this,e,n),[e,n]},enumerable:!1},width:{get:function(){return this._destroyed?0:this._shape[0]},set:function(t){return t|=0,f(this,t,this._shape[1]),t},enumerable:!1},height:{get:function(){return this._destroyed?0:this._shape[1]},set:function(t){return t|=0,f(this,this._shape[0],t),t},enumerable:!1}}),_.bind=function(){if(!this._destroyed){var t=this.gl;t.bindFramebuffer(t.FRAMEBUFFER,this.handle),t.viewport(0,0,this._shape[0],this._shape[1])}},_.dispose=function(){if(!this._destroyed){this._destroyed=!0;var t=this.gl;t.deleteFramebuffer(this.handle),this.handle=null,this.depth&&(this.depth.dispose(),this.depth=null),this._depth_rb&&(t.deleteRenderbuffer(this._depth_rb),this._depth_rb=null);for(var e=0;e<this.color.length;++e)this.color[e].dispose(),this.color[e]=null;this._color_rb&&(t.deleteRenderbuffer(this._color_rb),this._color_rb=null)}}},{"gl-texture2d":43}],25:[function(t,e,n){function r(t,e,n){"use strict";var r=o(e)||"of unknown name (see npm glsl-shader-name)",u="unknown type";void 0!==n&&(u=n===i.FRAGMENT_SHADER?"fragment":"vertex");for(var l=a("Error compiling %s shader %s:\n",u,r),c=a("%s%s",l,t),f=t.split("\n"),h={},d=0;d<f.length;d++){var p=f[d];if(""!==p){var g=parseInt(p.split(":")[2]);if(isNaN(g))throw new Error(a("Could not parse error: %s",p));h[g]=p}}for(var m=s(e).split("\n"),d=0;d<m.length;d++)if(h[d+3]||h[d+2]||h[d+1]){var v=m[d];if(l+=v+"\n",h[d+1]){var y=h[d+1];y=y.substr(y.split(":",3).join(":").length+1).trim(),l+=a("^^^ %s\n\n",y)}}return{long:l.trim(),short:c.trim()}}var a=t("sprintf-js").sprintf,i=t("gl-constants/lookup"),o=t("glsl-shader-name"),s=t("add-line-numbers");e.exports=r},{"add-line-numbers":5,"gl-constants/lookup":22,"glsl-shader-name":49,"sprintf-js":76}],26:[function(t,e,n){n.glMatrix=t("./gl-matrix/common.js"),n.mat2=t("./gl-matrix/mat2.js"),n.mat2d=t("./gl-matrix/mat2d.js"),n.mat3=t("./gl-matrix/mat3.js"),n.mat4=t("./gl-matrix/mat4.js"),n.quat=t("./gl-matrix/quat.js"),n.vec2=t("./gl-matrix/vec2.js"),n.vec3=t("./gl-matrix/vec3.js"),n.vec4=t("./gl-matrix/vec4.js")},{"./gl-matrix/common.js":27,"./gl-matrix/mat2.js":28,"./gl-matrix/mat2d.js":29,"./gl-matrix/mat3.js":30,"./gl-matrix/mat4.js":31,"./gl-matrix/quat.js":32,"./gl-matrix/vec2.js":33,"./gl-matrix/vec3.js":34,"./gl-matrix/vec4.js":35}],27:[function(t,e,n){var r={};r.EPSILON=1e-6,r.ARRAY_TYPE="undefined"!=typeof Float32Array?Float32Array:Array,r.RANDOM=Math.random,r.ENABLE_SIMD=!1,r.SIMD_AVAILABLE=r.ARRAY_TYPE===Float32Array&&"SIMD"in this,r.USE_SIMD=r.ENABLE_SIMD&&r.SIMD_AVAILABLE,r.setMatrixArrayType=function(t){r.ARRAY_TYPE=t};var a=Math.PI/180;r.toRadian=function(t){return t*a},r.equals=function(t,e){return Math.abs(t-e)<=r.EPSILON*Math.max(1,Math.abs(t),Math.abs(e))},e.exports=r},{}],28:[function(t,e,n){var r=t("./common.js"),a={};a.create=function(){var t=new r.ARRAY_TYPE(4);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},a.clone=function(t){var e=new r.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},a.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},a.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},a.fromValues=function(t,e,n,a){var i=new r.ARRAY_TYPE(4);return i[0]=t,i[1]=e,i[2]=n,i[3]=a,i},a.set=function(t,e,n,r,a){return t[0]=e,t[1]=n,t[2]=r,t[3]=a,t},a.transpose=function(t,e){if(t===e){var n=e[1];t[1]=e[2],t[2]=n}else t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3];return t},a.invert=function(t,e){var n=e[0],r=e[1],a=e[2],i=e[3],o=n*i-a*r;return o?(o=1/o,t[0]=i*o,t[1]=-r*o,t[2]=-a*o,t[3]=n*o,t):null},a.adjoint=function(t,e){var n=e[0];return t[0]=e[3],t[1]=-e[1],t[2]=-e[2],t[3]=n,t},a.determinant=function(t){return t[0]*t[3]-t[2]*t[1]},a.multiply=function(t,e,n){var r=e[0],a=e[1],i=e[2],o=e[3],s=n[0],u=n[1],l=n[2],c=n[3];return t[0]=r*s+i*u,t[1]=a*s+o*u,t[2]=r*l+i*c,t[3]=a*l+o*c,t},a.mul=a.multiply,a.rotate=function(t,e,n){var r=e[0],a=e[1],i=e[2],o=e[3],s=Math.sin(n),u=Math.cos(n);return t[0]=r*u+i*s,t[1]=a*u+o*s,t[2]=r*-s+i*u,
t[3]=a*-s+o*u,t},a.scale=function(t,e,n){var r=e[0],a=e[1],i=e[2],o=e[3],s=n[0],u=n[1];return t[0]=r*s,t[1]=a*s,t[2]=i*u,t[3]=o*u,t},a.fromRotation=function(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=-n,t[3]=r,t},a.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t},a.str=function(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},a.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2))},a.LDU=function(t,e,n,r){return t[2]=r[2]/r[0],n[0]=r[0],n[1]=r[1],n[3]=r[3]-t[2]*n[1],[t,e,n]},a.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t},a.subtract=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t},a.sub=a.subtract,a.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},a.equals=function(t,e){var n=t[0],a=t[1],i=t[2],o=t[3],s=e[0],u=e[1],l=e[2],c=e[3];return Math.abs(n-s)<=r.EPSILON*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(a-u)<=r.EPSILON*Math.max(1,Math.abs(a),Math.abs(u))&&Math.abs(i-l)<=r.EPSILON*Math.max(1,Math.abs(i),Math.abs(l))&&Math.abs(o-c)<=r.EPSILON*Math.max(1,Math.abs(o),Math.abs(c))},a.multiplyScalar=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t},a.multiplyScalarAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t},e.exports=a},{"./common.js":27}],29:[function(t,e,n){var r=t("./common.js"),a={};a.create=function(){var t=new r.ARRAY_TYPE(6);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},a.clone=function(t){var e=new r.ARRAY_TYPE(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},a.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},a.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},a.fromValues=function(t,e,n,a,i,o){var s=new r.ARRAY_TYPE(6);return s[0]=t,s[1]=e,s[2]=n,s[3]=a,s[4]=i,s[5]=o,s},a.set=function(t,e,n,r,a,i,o){return t[0]=e,t[1]=n,t[2]=r,t[3]=a,t[4]=i,t[5]=o,t},a.invert=function(t,e){var n=e[0],r=e[1],a=e[2],i=e[3],o=e[4],s=e[5],u=n*i-r*a;return u?(u=1/u,t[0]=i*u,t[1]=-r*u,t[2]=-a*u,t[3]=n*u,t[4]=(a*s-i*o)*u,t[5]=(r*o-n*s)*u,t):null},a.determinant=function(t){return t[0]*t[3]-t[1]*t[2]},a.multiply=function(t,e,n){var r=e[0],a=e[1],i=e[2],o=e[3],s=e[4],u=e[5],l=n[0],c=n[1],f=n[2],h=n[3],d=n[4],p=n[5];return t[0]=r*l+i*c,t[1]=a*l+o*c,t[2]=r*f+i*h,t[3]=a*f+o*h,t[4]=r*d+i*p+s,t[5]=a*d+o*p+u,t},a.mul=a.multiply,a.rotate=function(t,e,n){var r=e[0],a=e[1],i=e[2],o=e[3],s=e[4],u=e[5],l=Math.sin(n),c=Math.cos(n);return t[0]=r*c+i*l,t[1]=a*c+o*l,t[2]=r*-l+i*c,t[3]=a*-l+o*c,t[4]=s,t[5]=u,t},a.scale=function(t,e,n){var r=e[0],a=e[1],i=e[2],o=e[3],s=e[4],u=e[5],l=n[0],c=n[1];return t[0]=r*l,t[1]=a*l,t[2]=i*c,t[3]=o*c,t[4]=s,t[5]=u,t},a.translate=function(t,e,n){var r=e[0],a=e[1],i=e[2],o=e[3],s=e[4],u=e[5],l=n[0],c=n[1];return t[0]=r,t[1]=a,t[2]=i,t[3]=o,t[4]=r*l+i*c+s,t[5]=a*l+o*c+u,t},a.fromRotation=function(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=-n,t[3]=r,t[4]=0,t[5]=0,t},a.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t[4]=0,t[5]=0,t},a.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0],t[5]=e[1],t},a.str=function(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"},a.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+1)},a.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t},a.subtract=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t},a.sub=a.subtract,a.multiplyScalar=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t},a.multiplyScalarAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t},a.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]},a.equals=function(t,e){var n=t[0],a=t[1],i=t[2],o=t[3],s=t[4],u=t[5],l=e[0],c=e[1],f=e[2],h=e[3],d=e[4],p=e[5];return Math.abs(n-l)<=r.EPSILON*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(a-c)<=r.EPSILON*Math.max(1,Math.abs(a),Math.abs(c))&&Math.abs(i-f)<=r.EPSILON*Math.max(1,Math.abs(i),Math.abs(f))&&Math.abs(o-h)<=r.EPSILON*Math.max(1,Math.abs(o),Math.abs(h))&&Math.abs(s-d)<=r.EPSILON*Math.max(1,Math.abs(s),Math.abs(d))&&Math.abs(u-p)<=r.EPSILON*Math.max(1,Math.abs(u),Math.abs(p))},e.exports=a},{"./common.js":27}],30:[function(t,e,n){var r=t("./common.js"),a={};a.create=function(){var t=new r.ARRAY_TYPE(9);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},a.fromMat4=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},a.clone=function(t){var e=new r.ARRAY_TYPE(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},a.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},a.fromValues=function(t,e,n,a,i,o,s,u,l){var c=new r.ARRAY_TYPE(9);return c[0]=t,c[1]=e,c[2]=n,c[3]=a,c[4]=i,c[5]=o,c[6]=s,c[7]=u,c[8]=l,c},a.set=function(t,e,n,r,a,i,o,s,u,l){return t[0]=e,t[1]=n,t[2]=r,t[3]=a,t[4]=i,t[5]=o,t[6]=s,t[7]=u,t[8]=l,t},a.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},a.transpose=function(t,e){if(t===e){var n=e[1],r=e[2],a=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=r,t[7]=a}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t},a.invert=function(t,e){var n=e[0],r=e[1],a=e[2],i=e[3],o=e[4],s=e[5],u=e[6],l=e[7],c=e[8],f=c*o-s*l,h=-c*i+s*u,d=l*i-o*u,p=n*f+r*h+a*d;return p?(p=1/p,t[0]=f*p,t[1]=(-c*r+a*l)*p,t[2]=(s*r-a*o)*p,t[3]=h*p,t[4]=(c*n-a*u)*p,t[5]=(-s*n+a*i)*p,t[6]=d*p,t[7]=(-l*n+r*u)*p,t[8]=(o*n-r*i)*p,t):null},a.adjoint=function(t,e){var n=e[0],r=e[1],a=e[2],i=e[3],o=e[4],s=e[5],u=e[6],l=e[7],c=e[8];return t[0]=o*c-s*l,t[1]=a*l-r*c,t[2]=r*s-a*o,t[3]=s*u-i*c,t[4]=n*c-a*u,t[5]=a*i-n*s,t[6]=i*l-o*u,t[7]=r*u-n*l,t[8]=n*o-r*i,t},a.determinant=function(t){var e=t[0],n=t[1],r=t[2],a=t[3],i=t[4],o=t[5],s=t[6],u=t[7],l=t[8];return e*(l*i-o*u)+n*(-l*a+o*s)+r*(u*a-i*s)},a.multiply=function(t,e,n){var r=e[0],a=e[1],i=e[2],o=e[3],s=e[4],u=e[5],l=e[6],c=e[7],f=e[8],h=n[0],d=n[1],p=n[2],g=n[3],m=n[4],v=n[5],y=n[6],_=n[7],b=n[8];return t[0]=h*r+d*o+p*l,t[1]=h*a+d*s+p*c,t[2]=h*i+d*u+p*f,t[3]=g*r+m*o+v*l,t[4]=g*a+m*s+v*c,t[5]=g*i+m*u+v*f,t[6]=y*r+_*o+b*l,t[7]=y*a+_*s+b*c,t[8]=y*i+_*u+b*f,t},a.mul=a.multiply,a.translate=function(t,e,n){var r=e[0],a=e[1],i=e[2],o=e[3],s=e[4],u=e[5],l=e[6],c=e[7],f=e[8],h=n[0],d=n[1];return t[0]=r,t[1]=a,t[2]=i,t[3]=o,t[4]=s,t[5]=u,t[6]=h*r+d*o+l,t[7]=h*a+d*s+c,t[8]=h*i+d*u+f,t},a.rotate=function(t,e,n){var r=e[0],a=e[1],i=e[2],o=e[3],s=e[4],u=e[5],l=e[6],c=e[7],f=e[8],h=Math.sin(n),d=Math.cos(n);return t[0]=d*r+h*o,t[1]=d*a+h*s,t[2]=d*i+h*u,t[3]=d*o-h*r,t[4]=d*s-h*a,t[5]=d*u-h*i,t[6]=l,t[7]=c,t[8]=f,t},a.scale=function(t,e,n){var r=n[0],a=n[1];return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=a*e[3],t[4]=a*e[4],t[5]=a*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},a.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t},a.fromRotation=function(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=-n,t[4]=r,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},a.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},a.fromMat2d=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t},a.fromQuat=function(t,e){var n=e[0],r=e[1],a=e[2],i=e[3],o=n+n,s=r+r,u=a+a,l=n*o,c=r*o,f=r*s,h=a*o,d=a*s,p=a*u,g=i*o,m=i*s,v=i*u;return t[0]=1-f-p,t[3]=c-v,t[6]=h+m,t[1]=c+v,t[4]=1-l-p,t[7]=d-g,t[2]=h-m,t[5]=d+g,t[8]=1-l-f,t},a.normalFromMat4=function(t,e){var n=e[0],r=e[1],a=e[2],i=e[3],o=e[4],s=e[5],u=e[6],l=e[7],c=e[8],f=e[9],h=e[10],d=e[11],p=e[12],g=e[13],m=e[14],v=e[15],y=n*s-r*o,_=n*u-a*o,b=n*l-i*o,x=r*u-a*s,w=r*l-i*s,E=a*l-i*u,M=c*g-f*p,I=c*m-h*p,A=c*v-d*p,S=f*m-h*g,T=f*v-d*g,R=h*v-d*m,D=y*R-_*T+b*S+x*A-w*I+E*M;return D?(D=1/D,t[0]=(s*R-u*T+l*S)*D,t[1]=(u*A-o*R-l*I)*D,t[2]=(o*T-s*A+l*M)*D,t[3]=(a*T-r*R-i*S)*D,t[4]=(n*R-a*A+i*I)*D,t[5]=(r*A-n*T-i*M)*D,t[6]=(g*E-m*w+v*x)*D,t[7]=(m*b-p*E-v*_)*D,t[8]=(p*w-g*b+v*y)*D,t):null},a.str=function(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"},a.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2))},a.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t},a.subtract=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t},a.sub=a.subtract,a.multiplyScalar=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t},a.multiplyScalarAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t[6]=e[6]+n[6]*r,t[7]=e[7]+n[7]*r,t[8]=e[8]+n[8]*r,t},a.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]},a.equals=function(t,e){var n=t[0],a=t[1],i=t[2],o=t[3],s=t[4],u=t[5],l=t[6],c=t[7],f=t[8],h=e[0],d=e[1],p=e[2],g=e[3],m=e[4],v=e[5],y=t[6],_=e[7],b=e[8];return Math.abs(n-h)<=r.EPSILON*Math.max(1,Math.abs(n),Math.abs(h))&&Math.abs(a-d)<=r.EPSILON*Math.max(1,Math.abs(a),Math.abs(d))&&Math.abs(i-p)<=r.EPSILON*Math.max(1,Math.abs(i),Math.abs(p))&&Math.abs(o-g)<=r.EPSILON*Math.max(1,Math.abs(o),Math.abs(g))&&Math.abs(s-m)<=r.EPSILON*Math.max(1,Math.abs(s),Math.abs(m))&&Math.abs(u-v)<=r.EPSILON*Math.max(1,Math.abs(u),Math.abs(v))&&Math.abs(l-y)<=r.EPSILON*Math.max(1,Math.abs(l),Math.abs(y))&&Math.abs(c-_)<=r.EPSILON*Math.max(1,Math.abs(c),Math.abs(_))&&Math.abs(f-b)<=r.EPSILON*Math.max(1,Math.abs(f),Math.abs(b))},e.exports=a},{"./common.js":27}],31:[function(t,e,n){var r=t("./common.js"),a={scalar:{},SIMD:{}};a.create=function(){var t=new r.ARRAY_TYPE(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},a.clone=function(t){var e=new r.ARRAY_TYPE(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},a.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},a.fromValues=function(t,e,n,a,i,o,s,u,l,c,f,h,d,p,g,m){var v=new r.ARRAY_TYPE(16);return v[0]=t,v[1]=e,v[2]=n,v[3]=a,v[4]=i,v[5]=o,v[6]=s,v[7]=u,v[8]=l,v[9]=c,v[10]=f,v[11]=h,v[12]=d,v[13]=p,v[14]=g,v[15]=m,v},a.set=function(t,e,n,r,a,i,o,s,u,l,c,f,h,d,p,g,m){return t[0]=e,t[1]=n,t[2]=r,t[3]=a,t[4]=i,t[5]=o,t[6]=s,t[7]=u,t[8]=l,t[9]=c,t[10]=f,t[11]=h,t[12]=d,t[13]=p,t[14]=g,t[15]=m,t},a.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},a.scalar.transpose=function(t,e){if(t===e){var n=e[1],r=e[2],a=e[3],i=e[6],o=e[7],s=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=i,t[11]=e[14],t[12]=a,t[13]=o,t[14]=s}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t},a.SIMD.transpose=function(t,e){var n,r,a,i,o,s,u,l,c,f;return n=SIMD.Float32x4.load(e,0),r=SIMD.Float32x4.load(e,4),a=SIMD.Float32x4.load(e,8),i=SIMD.Float32x4.load(e,12),o=SIMD.Float32x4.shuffle(n,r,0,1,4,5),s=SIMD.Float32x4.shuffle(a,i,0,1,4,5),u=SIMD.Float32x4.shuffle(o,s,0,2,4,6),l=SIMD.Float32x4.shuffle(o,s,1,3,5,7),SIMD.Float32x4.store(t,0,u),SIMD.Float32x4.store(t,4,l),o=SIMD.Float32x4.shuffle(n,r,2,3,6,7),s=SIMD.Float32x4.shuffle(a,i,2,3,6,7),c=SIMD.Float32x4.shuffle(o,s,0,2,4,6),f=SIMD.Float32x4.shuffle(o,s,1,3,5,7),SIMD.Float32x4.store(t,8,c),SIMD.Float32x4.store(t,12,f),t},a.transpose=r.USE_SIMD?a.SIMD.transpose:a.scalar.transpose,a.scalar.invert=function(t,e){var n=e[0],r=e[1],a=e[2],i=e[3],o=e[4],s=e[5],u=e[6],l=e[7],c=e[8],f=e[9],h=e[10],d=e[11],p=e[12],g=e[13],m=e[14],v=e[15],y=n*s-r*o,_=n*u-a*o,b=n*l-i*o,x=r*u-a*s,w=r*l-i*s,E=a*l-i*u,M=c*g-f*p,I=c*m-h*p,A=c*v-d*p,S=f*m-h*g,T=f*v-d*g,R=h*v-d*m,D=y*R-_*T+b*S+x*A-w*I+E*M;return D?(D=1/D,t[0]=(s*R-u*T+l*S)*D,t[1]=(a*T-r*R-i*S)*D,t[2]=(g*E-m*w+v*x)*D,t[3]=(h*w-f*E-d*x)*D,t[4]=(u*A-o*R-l*I)*D,t[5]=(n*R-a*A+i*I)*D,t[6]=(m*b-p*E-v*_)*D,t[7]=(c*E-h*b+d*_)*D,t[8]=(o*T-s*A+l*M)*D,t[9]=(r*A-n*T-i*M)*D,t[10]=(p*w-g*b+v*y)*D,t[11]=(f*b-c*w-d*y)*D,t[12]=(s*I-o*S-u*M)*D,t[13]=(n*S-r*I+a*M)*D,t[14]=(g*_-p*x-m*y)*D,t[15]=(c*x-f*_+h*y)*D,t):null},a.SIMD.invert=function(t,e){var n,r,a,i,o,s,u,l,c,f,h=SIMD.Float32x4.load(e,0),d=SIMD.Float32x4.load(e,4),p=SIMD.Float32x4.load(e,8),g=SIMD.Float32x4.load(e,12);return o=SIMD.Float32x4.shuffle(h,d,0,1,4,5),r=SIMD.Float32x4.shuffle(p,g,0,1,4,5),n=SIMD.Float32x4.shuffle(o,r,0,2,4,6),r=SIMD.Float32x4.shuffle(r,o,1,3,5,7),o=SIMD.Float32x4.shuffle(h,d,2,3,6,7),i=SIMD.Float32x4.shuffle(p,g,2,3,6,7),a=SIMD.Float32x4.shuffle(o,i,0,2,4,6),i=SIMD.Float32x4.shuffle(i,o,1,3,5,7),o=SIMD.Float32x4.mul(a,i),o=SIMD.Float32x4.swizzle(o,1,0,3,2),s=SIMD.Float32x4.mul(r,o),u=SIMD.Float32x4.mul(n,o),o=SIMD.Float32x4.swizzle(o,2,3,0,1),s=SIMD.Float32x4.sub(SIMD.Float32x4.mul(r,o),s),u=SIMD.Float32x4.sub(SIMD.Float32x4.mul(n,o),u),u=SIMD.Float32x4.swizzle(u,2,3,0,1),o=SIMD.Float32x4.mul(r,a),o=SIMD.Float32x4.swizzle(o,1,0,3,2),s=SIMD.Float32x4.add(SIMD.Float32x4.mul(i,o),s),c=SIMD.Float32x4.mul(n,o),o=SIMD.Float32x4.swizzle(o,2,3,0,1),s=SIMD.Float32x4.sub(s,SIMD.Float32x4.mul(i,o)),c=SIMD.Float32x4.sub(SIMD.Float32x4.mul(n,o),c),c=SIMD.Float32x4.swizzle(c,2,3,0,1),o=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(r,2,3,0,1),i),o=SIMD.Float32x4.swizzle(o,1,0,3,2),a=SIMD.Float32x4.swizzle(a,2,3,0,1),s=SIMD.Float32x4.add(SIMD.Float32x4.mul(a,o),s),l=SIMD.Float32x4.mul(n,o),o=SIMD.Float32x4.swizzle(o,2,3,0,1),s=SIMD.Float32x4.sub(s,SIMD.Float32x4.mul(a,o)),l=SIMD.Float32x4.sub(SIMD.Float32x4.mul(n,o),l),l=SIMD.Float32x4.swizzle(l,2,3,0,1),o=SIMD.Float32x4.mul(n,r),o=SIMD.Float32x4.swizzle(o,1,0,3,2),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(i,o),l),c=SIMD.Float32x4.sub(SIMD.Float32x4.mul(a,o),c),o=SIMD.Float32x4.swizzle(o,2,3,0,1),l=SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,o),l),c=SIMD.Float32x4.sub(c,SIMD.Float32x4.mul(a,o)),o=SIMD.Float32x4.mul(n,i),o=SIMD.Float32x4.swizzle(o,1,0,3,2),u=SIMD.Float32x4.sub(u,SIMD.Float32x4.mul(a,o)),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(r,o),l),o=SIMD.Float32x4.swizzle(o,2,3,0,1),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(a,o),u),l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(r,o)),o=SIMD.Float32x4.mul(n,a),o=SIMD.Float32x4.swizzle(o,1,0,3,2),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(i,o),u),c=SIMD.Float32x4.sub(c,SIMD.Float32x4.mul(r,o)),o=SIMD.Float32x4.swizzle(o,2,3,0,1),u=SIMD.Float32x4.sub(u,SIMD.Float32x4.mul(i,o)),c=SIMD.Float32x4.add(SIMD.Float32x4.mul(r,o),c),f=SIMD.Float32x4.mul(n,s),f=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(f,2,3,0,1),f),f=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(f,1,0,3,2),f),o=SIMD.Float32x4.reciprocalApproximation(f),f=SIMD.Float32x4.sub(SIMD.Float32x4.add(o,o),SIMD.Float32x4.mul(f,SIMD.Float32x4.mul(o,o))),(f=SIMD.Float32x4.swizzle(f,0,0,0,0))?(SIMD.Float32x4.store(t,0,SIMD.Float32x4.mul(f,s)),SIMD.Float32x4.store(t,4,SIMD.Float32x4.mul(f,u)),SIMD.Float32x4.store(t,8,SIMD.Float32x4.mul(f,l)),SIMD.Float32x4.store(t,12,SIMD.Float32x4.mul(f,c)),t):null},a.invert=r.USE_SIMD?a.SIMD.invert:a.scalar.invert,a.scalar.adjoint=function(t,e){var n=e[0],r=e[1],a=e[2],i=e[3],o=e[4],s=e[5],u=e[6],l=e[7],c=e[8],f=e[9],h=e[10],d=e[11],p=e[12],g=e[13],m=e[14],v=e[15];return t[0]=s*(h*v-d*m)-f*(u*v-l*m)+g*(u*d-l*h),t[1]=-(r*(h*v-d*m)-f*(a*v-i*m)+g*(a*d-i*h)),t[2]=r*(u*v-l*m)-s*(a*v-i*m)+g*(a*l-i*u),t[3]=-(r*(u*d-l*h)-s*(a*d-i*h)+f*(a*l-i*u)),t[4]=-(o*(h*v-d*m)-c*(u*v-l*m)+p*(u*d-l*h)),t[5]=n*(h*v-d*m)-c*(a*v-i*m)+p*(a*d-i*h),t[6]=-(n*(u*v-l*m)-o*(a*v-i*m)+p*(a*l-i*u)),t[7]=n*(u*d-l*h)-o*(a*d-i*h)+c*(a*l-i*u),t[8]=o*(f*v-d*g)-c*(s*v-l*g)+p*(s*d-l*f),t[9]=-(n*(f*v-d*g)-c*(r*v-i*g)+p*(r*d-i*f)),t[10]=n*(s*v-l*g)-o*(r*v-i*g)+p*(r*l-i*s),t[11]=-(n*(s*d-l*f)-o*(r*d-i*f)+c*(r*l-i*s)),t[12]=-(o*(f*m-h*g)-c*(s*m-u*g)+p*(s*h-u*f)),t[13]=n*(f*m-h*g)-c*(r*m-a*g)+p*(r*h-a*f),t[14]=-(n*(s*m-u*g)-o*(r*m-a*g)+p*(r*u-a*s)),t[15]=n*(s*h-u*f)-o*(r*h-a*f)+c*(r*u-a*s),t},a.SIMD.adjoint=function(t,e){var n,r,a,i,o,s,u,l,c,f,h,d,p,n=SIMD.Float32x4.load(e,0),r=SIMD.Float32x4.load(e,4),a=SIMD.Float32x4.load(e,8),i=SIMD.Float32x4.load(e,12);return c=SIMD.Float32x4.shuffle(n,r,0,1,4,5),s=SIMD.Float32x4.shuffle(a,i,0,1,4,5),o=SIMD.Float32x4.shuffle(c,s,0,2,4,6),s=SIMD.Float32x4.shuffle(s,c,1,3,5,7),c=SIMD.Float32x4.shuffle(n,r,2,3,6,7),l=SIMD.Float32x4.shuffle(a,i,2,3,6,7),u=SIMD.Float32x4.shuffle(c,l,0,2,4,6),l=SIMD.Float32x4.shuffle(l,c,1,3,5,7),c=SIMD.Float32x4.mul(u,l),c=SIMD.Float32x4.swizzle(c,1,0,3,2),f=SIMD.Float32x4.mul(s,c),h=SIMD.Float32x4.mul(o,c),c=SIMD.Float32x4.swizzle(c,2,3,0,1),f=SIMD.Float32x4.sub(SIMD.Float32x4.mul(s,c),f),h=SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,c),h),h=SIMD.Float32x4.swizzle(h,2,3,0,1),c=SIMD.Float32x4.mul(s,u),c=SIMD.Float32x4.swizzle(c,1,0,3,2),f=SIMD.Float32x4.add(SIMD.Float32x4.mul(l,c),f),p=SIMD.Float32x4.mul(o,c),c=SIMD.Float32x4.swizzle(c,2,3,0,1),f=SIMD.Float32x4.sub(f,SIMD.Float32x4.mul(l,c)),p=SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,c),p),p=SIMD.Float32x4.swizzle(p,2,3,0,1),c=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,2,3,0,1),l),c=SIMD.Float32x4.swizzle(c,1,0,3,2),u=SIMD.Float32x4.swizzle(u,2,3,0,1),f=SIMD.Float32x4.add(SIMD.Float32x4.mul(u,c),f),d=SIMD.Float32x4.mul(o,c),c=SIMD.Float32x4.swizzle(c,2,3,0,1),f=SIMD.Float32x4.sub(f,SIMD.Float32x4.mul(u,c)),d=SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,c),d),d=SIMD.Float32x4.swizzle(d,2,3,0,1),c=SIMD.Float32x4.mul(o,s),c=SIMD.Float32x4.swizzle(c,1,0,3,2),d=SIMD.Float32x4.add(SIMD.Float32x4.mul(l,c),d),p=SIMD.Float32x4.sub(SIMD.Float32x4.mul(u,c),p),c=SIMD.Float32x4.swizzle(c,2,3,0,1),d=SIMD.Float32x4.sub(SIMD.Float32x4.mul(l,c),d),p=SIMD.Float32x4.sub(p,SIMD.Float32x4.mul(u,c)),c=SIMD.Float32x4.mul(o,l),c=SIMD.Float32x4.swizzle(c,1,0,3,2),h=SIMD.Float32x4.sub(h,SIMD.Float32x4.mul(u,c)),d=SIMD.Float32x4.add(SIMD.Float32x4.mul(s,c),d),c=SIMD.Float32x4.swizzle(c,2,3,0,1),h=SIMD.Float32x4.add(SIMD.Float32x4.mul(u,c),h),d=SIMD.Float32x4.sub(d,SIMD.Float32x4.mul(s,c)),c=SIMD.Float32x4.mul(o,u),c=SIMD.Float32x4.swizzle(c,1,0,3,2),h=SIMD.Float32x4.add(SIMD.Float32x4.mul(l,c),h),p=SIMD.Float32x4.sub(p,SIMD.Float32x4.mul(s,c)),c=SIMD.Float32x4.swizzle(c,2,3,0,1),h=SIMD.Float32x4.sub(h,SIMD.Float32x4.mul(l,c)),p=SIMD.Float32x4.add(SIMD.Float32x4.mul(s,c),p),SIMD.Float32x4.store(t,0,f),SIMD.Float32x4.store(t,4,h),SIMD.Float32x4.store(t,8,d),SIMD.Float32x4.store(t,12,p),t},a.adjoint=r.USE_SIMD?a.SIMD.adjoint:a.scalar.adjoint,a.determinant=function(t){var e=t[0],n=t[1],r=t[2],a=t[3],i=t[4],o=t[5],s=t[6],u=t[7],l=t[8],c=t[9],f=t[10],h=t[11],d=t[12],p=t[13],g=t[14],m=t[15],v=e*o-n*i,y=e*s-r*i,_=e*u-a*i,b=n*s-r*o,x=n*u-a*o,w=r*u-a*s,E=l*p-c*d,M=l*g-f*d,I=l*m-h*d,A=c*g-f*p,S=c*m-h*p,T=f*m-h*g;return v*T-y*S+_*A+b*I-x*M+w*E},a.SIMD.multiply=function(t,e,n){var r=SIMD.Float32x4.load(e,0),a=SIMD.Float32x4.load(e,4),i=SIMD.Float32x4.load(e,8),o=SIMD.Float32x4.load(e,12),s=SIMD.Float32x4.load(n,0),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,0,0,0,0),r),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,1,1,1,1),a),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,2,2,2,2),i),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,3,3,3,3),o))));SIMD.Float32x4.store(t,0,u);var l=SIMD.Float32x4.load(n,4),c=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(l,0,0,0,0),r),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(l,1,1,1,1),a),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(l,2,2,2,2),i),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(l,3,3,3,3),o))));SIMD.Float32x4.store(t,4,c);var f=SIMD.Float32x4.load(n,8),h=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(f,0,0,0,0),r),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(f,1,1,1,1),a),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(f,2,2,2,2),i),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(f,3,3,3,3),o))));SIMD.Float32x4.store(t,8,h);var d=SIMD.Float32x4.load(n,12),p=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(d,0,0,0,0),r),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(d,1,1,1,1),a),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(d,2,2,2,2),i),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(d,3,3,3,3),o))));return SIMD.Float32x4.store(t,12,p),t},a.scalar.multiply=function(t,e,n){var r=e[0],a=e[1],i=e[2],o=e[3],s=e[4],u=e[5],l=e[6],c=e[7],f=e[8],h=e[9],d=e[10],p=e[11],g=e[12],m=e[13],v=e[14],y=e[15],_=n[0],b=n[1],x=n[2],w=n[3];return t[0]=_*r+b*s+x*f+w*g,t[1]=_*a+b*u+x*h+w*m,t[2]=_*i+b*l+x*d+w*v,t[3]=_*o+b*c+x*p+w*y,_=n[4],b=n[5],x=n[6],w=n[7],t[4]=_*r+b*s+x*f+w*g,t[5]=_*a+b*u+x*h+w*m,t[6]=_*i+b*l+x*d+w*v,t[7]=_*o+b*c+x*p+w*y,_=n[8],b=n[9],x=n[10],w=n[11],t[8]=_*r+b*s+x*f+w*g,t[9]=_*a+b*u+x*h+w*m,t[10]=_*i+b*l+x*d+w*v,t[11]=_*o+b*c+x*p+w*y,_=n[12],b=n[13],x=n[14],w=n[15],t[12]=_*r+b*s+x*f+w*g,t[13]=_*a+b*u+x*h+w*m,t[14]=_*i+b*l+x*d+w*v,t[15]=_*o+b*c+x*p+w*y,t},a.multiply=r.USE_SIMD?a.SIMD.multiply:a.scalar.multiply,a.mul=a.multiply,a.scalar.translate=function(t,e,n){var r,a,i,o,s,u,l,c,f,h,d,p,g=n[0],m=n[1],v=n[2];return e===t?(t[12]=e[0]*g+e[4]*m+e[8]*v+e[12],t[13]=e[1]*g+e[5]*m+e[9]*v+e[13],t[14]=e[2]*g+e[6]*m+e[10]*v+e[14],t[15]=e[3]*g+e[7]*m+e[11]*v+e[15]):(r=e[0],a=e[1],i=e[2],o=e[3],s=e[4],u=e[5],l=e[6],c=e[7],f=e[8],h=e[9],d=e[10],p=e[11],t[0]=r,t[1]=a,t[2]=i,t[3]=o,t[4]=s,t[5]=u,t[6]=l,t[7]=c,t[8]=f,t[9]=h,t[10]=d,t[11]=p,t[12]=r*g+s*m+f*v+e[12],t[13]=a*g+u*m+h*v+e[13],t[14]=i*g+l*m+d*v+e[14],t[15]=o*g+c*m+p*v+e[15]),t},a.SIMD.translate=function(t,e,n){var r=SIMD.Float32x4.load(e,0),a=SIMD.Float32x4.load(e,4),i=SIMD.Float32x4.load(e,8),o=SIMD.Float32x4.load(e,12),s=SIMD.Float32x4(n[0],n[1],n[2],0);e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11]),r=SIMD.Float32x4.mul(r,SIMD.Float32x4.swizzle(s,0,0,0,0)),a=SIMD.Float32x4.mul(a,SIMD.Float32x4.swizzle(s,1,1,1,1)),i=SIMD.Float32x4.mul(i,SIMD.Float32x4.swizzle(s,2,2,2,2));var u=SIMD.Float32x4.add(r,SIMD.Float32x4.add(a,SIMD.Float32x4.add(i,o)));return SIMD.Float32x4.store(t,12,u),t},a.translate=r.USE_SIMD?a.SIMD.translate:a.scalar.translate,a.scalar.scale=function(t,e,n){var r=n[0],a=n[1],i=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*a,t[5]=e[5]*a,t[6]=e[6]*a,t[7]=e[7]*a,t[8]=e[8]*i,t[9]=e[9]*i,t[10]=e[10]*i,t[11]=e[11]*i,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},a.SIMD.scale=function(t,e,n){var r,a,i,o=SIMD.Float32x4(n[0],n[1],n[2],0);return r=SIMD.Float32x4.load(e,0),SIMD.Float32x4.store(t,0,SIMD.Float32x4.mul(r,SIMD.Float32x4.swizzle(o,0,0,0,0))),a=SIMD.Float32x4.load(e,4),SIMD.Float32x4.store(t,4,SIMD.Float32x4.mul(a,SIMD.Float32x4.swizzle(o,1,1,1,1))),i=SIMD.Float32x4.load(e,8),SIMD.Float32x4.store(t,8,SIMD.Float32x4.mul(i,SIMD.Float32x4.swizzle(o,2,2,2,2))),t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},a.scale=r.USE_SIMD?a.SIMD.scale:a.scalar.scale,a.rotate=function(t,e,n,a){var i,o,s,u,l,c,f,h,d,p,g,m,v,y,_,b,x,w,E,M,I,A,S,T,R=a[0],D=a[1],F=a[2],N=Math.sqrt(R*R+D*D+F*F);return Math.abs(N)<r.EPSILON?null:(N=1/N,R*=N,D*=N,F*=N,i=Math.sin(n),o=Math.cos(n),s=1-o,u=e[0],l=e[1],c=e[2],f=e[3],h=e[4],d=e[5],p=e[6],g=e[7],m=e[8],v=e[9],y=e[10],_=e[11],b=R*R*s+o,x=D*R*s+F*i,w=F*R*s-D*i,E=R*D*s-F*i,M=D*D*s+o,I=F*D*s+R*i,A=R*F*s+D*i,S=D*F*s-R*i,T=F*F*s+o,t[0]=u*b+h*x+m*w,t[1]=l*b+d*x+v*w,t[2]=c*b+p*x+y*w,t[3]=f*b+g*x+_*w,t[4]=u*E+h*M+m*I,t[5]=l*E+d*M+v*I,t[6]=c*E+p*M+y*I,t[7]=f*E+g*M+_*I,t[8]=u*A+h*S+m*T,t[9]=l*A+d*S+v*T,t[10]=c*A+p*S+y*T,t[11]=f*A+g*S+_*T,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)},a.scalar.rotateX=function(t,e,n){var r=Math.sin(n),a=Math.cos(n),i=e[4],o=e[5],s=e[6],u=e[7],l=e[8],c=e[9],f=e[10],h=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=i*a+l*r,t[5]=o*a+c*r,t[6]=s*a+f*r,t[7]=u*a+h*r,t[8]=l*a-i*r,t[9]=c*a-o*r,t[10]=f*a-s*r,t[11]=h*a-u*r,t},a.SIMD.rotateX=function(t,e,n){var r=SIMD.Float32x4.splat(Math.sin(n)),a=SIMD.Float32x4.splat(Math.cos(n));e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);var i=SIMD.Float32x4.load(e,4),o=SIMD.Float32x4.load(e,8);return SIMD.Float32x4.store(t,4,SIMD.Float32x4.add(SIMD.Float32x4.mul(i,a),SIMD.Float32x4.mul(o,r))),SIMD.Float32x4.store(t,8,SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,a),SIMD.Float32x4.mul(i,r))),t},a.rotateX=r.USE_SIMD?a.SIMD.rotateX:a.scalar.rotateX,a.scalar.rotateY=function(t,e,n){var r=Math.sin(n),a=Math.cos(n),i=e[0],o=e[1],s=e[2],u=e[3],l=e[8],c=e[9],f=e[10],h=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=i*a-l*r,t[1]=o*a-c*r,t[2]=s*a-f*r,t[3]=u*a-h*r,t[8]=i*r+l*a,t[9]=o*r+c*a,t[10]=s*r+f*a,t[11]=u*r+h*a,t},a.SIMD.rotateY=function(t,e,n){var r=SIMD.Float32x4.splat(Math.sin(n)),a=SIMD.Float32x4.splat(Math.cos(n));e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);var i=SIMD.Float32x4.load(e,0),o=SIMD.Float32x4.load(e,8);return SIMD.Float32x4.store(t,0,SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,a),SIMD.Float32x4.mul(o,r))),SIMD.Float32x4.store(t,8,SIMD.Float32x4.add(SIMD.Float32x4.mul(i,r),SIMD.Float32x4.mul(o,a))),t},a.rotateY=r.USE_SIMD?a.SIMD.rotateY:a.scalar.rotateY,a.scalar.rotateZ=function(t,e,n){var r=Math.sin(n),a=Math.cos(n),i=e[0],o=e[1],s=e[2],u=e[3],l=e[4],c=e[5],f=e[6],h=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=i*a+l*r,t[1]=o*a+c*r,t[2]=s*a+f*r,t[3]=u*a+h*r,t[4]=l*a-i*r,t[5]=c*a-o*r,t[6]=f*a-s*r,t[7]=h*a-u*r,t},a.SIMD.rotateZ=function(t,e,n){var r=SIMD.Float32x4.splat(Math.sin(n)),a=SIMD.Float32x4.splat(Math.cos(n));e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);var i=SIMD.Float32x4.load(e,0),o=SIMD.Float32x4.load(e,4);return SIMD.Float32x4.store(t,0,SIMD.Float32x4.add(SIMD.Float32x4.mul(i,a),SIMD.Float32x4.mul(o,r))),SIMD.Float32x4.store(t,4,SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,a),SIMD.Float32x4.mul(i,r))),t},a.rotateZ=r.USE_SIMD?a.SIMD.rotateZ:a.scalar.rotateZ,a.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t},a.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},a.fromRotation=function(t,e,n){var a,i,o,s=n[0],u=n[1],l=n[2],c=Math.sqrt(s*s+u*u+l*l);return Math.abs(c)<r.EPSILON?null:(c=1/c,s*=c,u*=c,l*=c,a=Math.sin(e),i=Math.cos(e),o=1-i,t[0]=s*s*o+i,t[1]=u*s*o+l*a,t[2]=l*s*o-u*a,t[3]=0,t[4]=s*u*o-l*a,t[5]=u*u*o+i,t[6]=l*u*o+s*a,t[7]=0,t[8]=s*l*o+u*a,t[9]=u*l*o-s*a,t[10]=l*l*o+i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)},a.fromXRotation=function(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r,t[6]=n,t[7]=0,t[8]=0,t[9]=-n,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},a.fromYRotation=function(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=0,t[2]=-n,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=n,t[9]=0,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},a.fromZRotation=function(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=0,t[4]=-n,t[5]=r,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},a.fromRotationTranslation=function(t,e,n){var r=e[0],a=e[1],i=e[2],o=e[3],s=r+r,u=a+a,l=i+i,c=r*s,f=r*u,h=r*l,d=a*u,p=a*l,g=i*l,m=o*s,v=o*u,y=o*l;return t[0]=1-(d+g),t[1]=f+y,t[2]=h-v,t[3]=0,t[4]=f-y,t[5]=1-(c+g),t[6]=p+m,t[7]=0,t[8]=h+v,t[9]=p-m,t[10]=1-(c+d),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t},a.getTranslation=function(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t},a.getRotation=function(t,e){var n=e[0]+e[5]+e[10],r=0;return n>0?(r=2*Math.sqrt(n+1),t[3]=.25*r,t[0]=(e[6]-e[9])/r,t[1]=(e[8]-e[2])/r,t[2]=(e[1]-e[4])/r):e[0]>e[5]&e[0]>e[10]?(r=2*Math.sqrt(1+e[0]-e[5]-e[10]),t[3]=(e[6]-e[9])/r,t[0]=.25*r,t[1]=(e[1]+e[4])/r,t[2]=(e[8]+e[2])/r):e[5]>e[10]?(r=2*Math.sqrt(1+e[5]-e[0]-e[10]),t[3]=(e[8]-e[2])/r,t[0]=(e[1]+e[4])/r,t[1]=.25*r,t[2]=(e[6]+e[9])/r):(r=2*Math.sqrt(1+e[10]-e[0]-e[5]),t[3]=(e[1]-e[4])/r,t[0]=(e[8]+e[2])/r,t[1]=(e[6]+e[9])/r,t[2]=.25*r),t},a.fromRotationTranslationScale=function(t,e,n,r){var a=e[0],i=e[1],o=e[2],s=e[3],u=a+a,l=i+i,c=o+o,f=a*u,h=a*l,d=a*c,p=i*l,g=i*c,m=o*c,v=s*u,y=s*l,_=s*c,b=r[0],x=r[1],w=r[2];return t[0]=(1-(p+m))*b,t[1]=(h+_)*b,t[2]=(d-y)*b,t[3]=0,t[4]=(h-_)*x,t[5]=(1-(f+m))*x,t[6]=(g+v)*x,t[7]=0,t[8]=(d+y)*w,t[9]=(g-v)*w,t[10]=(1-(f+p))*w,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t},a.fromRotationTranslationScaleOrigin=function(t,e,n,r,a){var i=e[0],o=e[1],s=e[2],u=e[3],l=i+i,c=o+o,f=s+s,h=i*l,d=i*c,p=i*f,g=o*c,m=o*f,v=s*f,y=u*l,_=u*c,b=u*f,x=r[0],w=r[1],E=r[2],M=a[0],I=a[1],A=a[2];return t[0]=(1-(g+v))*x,t[1]=(d+b)*x,t[2]=(p-_)*x,t[3]=0,t[4]=(d-b)*w,t[5]=(1-(h+v))*w,t[6]=(m+y)*w,t[7]=0,t[8]=(p+_)*E,t[9]=(m-y)*E,t[10]=(1-(h+g))*E,t[11]=0,t[12]=n[0]+M-(t[0]*M+t[4]*I+t[8]*A),t[13]=n[1]+I-(t[1]*M+t[5]*I+t[9]*A),t[14]=n[2]+A-(t[2]*M+t[6]*I+t[10]*A),t[15]=1,t},a.fromQuat=function(t,e){var n=e[0],r=e[1],a=e[2],i=e[3],o=n+n,s=r+r,u=a+a,l=n*o,c=r*o,f=r*s,h=a*o,d=a*s,p=a*u,g=i*o,m=i*s,v=i*u;return t[0]=1-f-p,t[1]=c+v,t[2]=h-m,t[3]=0,t[4]=c-v,t[5]=1-l-p,t[6]=d+g,t[7]=0,t[8]=h+m,t[9]=d-g,t[10]=1-l-f,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},a.frustum=function(t,e,n,r,a,i,o){var s=1/(n-e),u=1/(a-r),l=1/(i-o);return t[0]=2*i*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*i*u,t[6]=0,t[7]=0,t[8]=(n+e)*s,t[9]=(a+r)*u,t[10]=(o+i)*l,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*i*2*l,t[15]=0,t},a.perspective=function(t,e,n,r,a){var i=1/Math.tan(e/2),o=1/(r-a);return t[0]=i/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(a+r)*o,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*a*r*o,t[15]=0,t},a.perspectiveFromFieldOfView=function(t,e,n,r){var a=Math.tan(e.upDegrees*Math.PI/180),i=Math.tan(e.downDegrees*Math.PI/180),o=Math.tan(e.leftDegrees*Math.PI/180),s=Math.tan(e.rightDegrees*Math.PI/180),u=2/(o+s),l=2/(a+i);return t[0]=u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=l,t[6]=0,t[7]=0,t[8]=-((o-s)*u*.5),t[9]=(a-i)*l*.5,t[10]=r/(n-r),t[11]=-1,t[12]=0,t[13]=0,t[14]=r*n/(n-r),t[15]=0,t},a.ortho=function(t,e,n,r,a,i,o){var s=1/(e-n),u=1/(r-a),l=1/(i-o);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*l,t[11]=0,t[12]=(e+n)*s,t[13]=(a+r)*u,t[14]=(o+i)*l,t[15]=1,t},a.lookAt=function(t,e,n,i){var o,s,u,l,c,f,h,d,p,g,m=e[0],v=e[1],y=e[2],_=i[0],b=i[1],x=i[2],w=n[0],E=n[1],M=n[2];return Math.abs(m-w)<r.EPSILON&&Math.abs(v-E)<r.EPSILON&&Math.abs(y-M)<r.EPSILON?a.identity(t):(h=m-w,d=v-E,p=y-M,g=1/Math.sqrt(h*h+d*d+p*p),h*=g,d*=g,p*=g,o=b*p-x*d,s=x*h-_*p,u=_*d-b*h,g=Math.sqrt(o*o+s*s+u*u),g?(g=1/g,
o*=g,s*=g,u*=g):(o=0,s=0,u=0),l=d*u-p*s,c=p*o-h*u,f=h*s-d*o,g=Math.sqrt(l*l+c*c+f*f),g?(g=1/g,l*=g,c*=g,f*=g):(l=0,c=0,f=0),t[0]=o,t[1]=l,t[2]=h,t[3]=0,t[4]=s,t[5]=c,t[6]=d,t[7]=0,t[8]=u,t[9]=f,t[10]=p,t[11]=0,t[12]=-(o*m+s*v+u*y),t[13]=-(l*m+c*v+f*y),t[14]=-(h*m+d*v+p*y),t[15]=1,t)},a.str=function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"},a.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2)+Math.pow(t[9],2)+Math.pow(t[10],2)+Math.pow(t[11],2)+Math.pow(t[12],2)+Math.pow(t[13],2)+Math.pow(t[14],2)+Math.pow(t[15],2))},a.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t[9]=e[9]+n[9],t[10]=e[10]+n[10],t[11]=e[11]+n[11],t[12]=e[12]+n[12],t[13]=e[13]+n[13],t[14]=e[14]+n[14],t[15]=e[15]+n[15],t},a.subtract=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t[9]=e[9]-n[9],t[10]=e[10]-n[10],t[11]=e[11]-n[11],t[12]=e[12]-n[12],t[13]=e[13]-n[13],t[14]=e[14]-n[14],t[15]=e[15]-n[15],t},a.sub=a.subtract,a.multiplyScalar=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12]*n,t[13]=e[13]*n,t[14]=e[14]*n,t[15]=e[15]*n,t},a.multiplyScalarAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t[6]=e[6]+n[6]*r,t[7]=e[7]+n[7]*r,t[8]=e[8]+n[8]*r,t[9]=e[9]+n[9]*r,t[10]=e[10]+n[10]*r,t[11]=e[11]+n[11]*r,t[12]=e[12]+n[12]*r,t[13]=e[13]+n[13]*r,t[14]=e[14]+n[14]*r,t[15]=e[15]+n[15]*r,t},a.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]},a.equals=function(t,e){var n=t[0],a=t[1],i=t[2],o=t[3],s=t[4],u=t[5],l=t[6],c=t[7],f=t[8],h=t[9],d=t[10],p=t[11],g=t[12],m=t[13],v=t[14],y=t[15],_=e[0],b=e[1],x=e[2],w=e[3],E=e[4],M=e[5],I=e[6],A=e[7],S=e[8],T=e[9],R=e[10],D=e[11],F=e[12],N=e[13],L=e[14],P=e[15];return Math.abs(n-_)<=r.EPSILON*Math.max(1,Math.abs(n),Math.abs(_))&&Math.abs(a-b)<=r.EPSILON*Math.max(1,Math.abs(a),Math.abs(b))&&Math.abs(i-x)<=r.EPSILON*Math.max(1,Math.abs(i),Math.abs(x))&&Math.abs(o-w)<=r.EPSILON*Math.max(1,Math.abs(o),Math.abs(w))&&Math.abs(s-E)<=r.EPSILON*Math.max(1,Math.abs(s),Math.abs(E))&&Math.abs(u-M)<=r.EPSILON*Math.max(1,Math.abs(u),Math.abs(M))&&Math.abs(l-I)<=r.EPSILON*Math.max(1,Math.abs(l),Math.abs(I))&&Math.abs(c-A)<=r.EPSILON*Math.max(1,Math.abs(c),Math.abs(A))&&Math.abs(f-S)<=r.EPSILON*Math.max(1,Math.abs(f),Math.abs(S))&&Math.abs(h-T)<=r.EPSILON*Math.max(1,Math.abs(h),Math.abs(T))&&Math.abs(d-R)<=r.EPSILON*Math.max(1,Math.abs(d),Math.abs(R))&&Math.abs(p-D)<=r.EPSILON*Math.max(1,Math.abs(p),Math.abs(D))&&Math.abs(g-F)<=r.EPSILON*Math.max(1,Math.abs(g),Math.abs(F))&&Math.abs(m-N)<=r.EPSILON*Math.max(1,Math.abs(m),Math.abs(N))&&Math.abs(v-L)<=r.EPSILON*Math.max(1,Math.abs(v),Math.abs(L))&&Math.abs(y-P)<=r.EPSILON*Math.max(1,Math.abs(y),Math.abs(P))},e.exports=a},{"./common.js":27}],32:[function(t,e,n){var r=t("./common.js"),a=t("./mat3.js"),i=t("./vec3.js"),o=t("./vec4.js"),s={};s.create=function(){var t=new r.ARRAY_TYPE(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},s.rotationTo=function(){var t=i.create(),e=i.fromValues(1,0,0),n=i.fromValues(0,1,0);return function(r,a,o){var u=i.dot(a,o);return u<-.999999?(i.cross(t,e,a),i.length(t)<1e-6&&i.cross(t,n,a),i.normalize(t,t),s.setAxisAngle(r,t,Math.PI),r):u>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):(i.cross(t,a,o),r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=1+u,s.normalize(r,r))}}(),s.setAxes=function(){var t=a.create();return function(e,n,r,a){return t[0]=r[0],t[3]=r[1],t[6]=r[2],t[1]=a[0],t[4]=a[1],t[7]=a[2],t[2]=-n[0],t[5]=-n[1],t[8]=-n[2],s.normalize(e,s.fromMat3(e,t))}}(),s.clone=o.clone,s.fromValues=o.fromValues,s.copy=o.copy,s.set=o.set,s.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},s.setAxisAngle=function(t,e,n){n*=.5;var r=Math.sin(n);return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(n),t},s.getAxisAngle=function(t,e){var n=2*Math.acos(e[3]),r=Math.sin(n/2);return 0!=r?(t[0]=e[0]/r,t[1]=e[1]/r,t[2]=e[2]/r):(t[0]=1,t[1]=0,t[2]=0),n},s.add=o.add,s.multiply=function(t,e,n){var r=e[0],a=e[1],i=e[2],o=e[3],s=n[0],u=n[1],l=n[2],c=n[3];return t[0]=r*c+o*s+a*l-i*u,t[1]=a*c+o*u+i*s-r*l,t[2]=i*c+o*l+r*u-a*s,t[3]=o*c-r*s-a*u-i*l,t},s.mul=s.multiply,s.scale=o.scale,s.rotateX=function(t,e,n){n*=.5;var r=e[0],a=e[1],i=e[2],o=e[3],s=Math.sin(n),u=Math.cos(n);return t[0]=r*u+o*s,t[1]=a*u+i*s,t[2]=i*u-a*s,t[3]=o*u-r*s,t},s.rotateY=function(t,e,n){n*=.5;var r=e[0],a=e[1],i=e[2],o=e[3],s=Math.sin(n),u=Math.cos(n);return t[0]=r*u-i*s,t[1]=a*u+o*s,t[2]=i*u+r*s,t[3]=o*u-a*s,t},s.rotateZ=function(t,e,n){n*=.5;var r=e[0],a=e[1],i=e[2],o=e[3],s=Math.sin(n),u=Math.cos(n);return t[0]=r*u+a*s,t[1]=a*u-r*s,t[2]=i*u+o*s,t[3]=o*u-i*s,t},s.calculateW=function(t,e){var n=e[0],r=e[1],a=e[2];return t[0]=n,t[1]=r,t[2]=a,t[3]=Math.sqrt(Math.abs(1-n*n-r*r-a*a)),t},s.dot=o.dot,s.lerp=o.lerp,s.slerp=function(t,e,n,r){var a,i,o,s,u,l=e[0],c=e[1],f=e[2],h=e[3],d=n[0],p=n[1],g=n[2],m=n[3];return i=l*d+c*p+f*g+h*m,i<0&&(i=-i,d=-d,p=-p,g=-g,m=-m),1-i>1e-6?(a=Math.acos(i),o=Math.sin(a),s=Math.sin((1-r)*a)/o,u=Math.sin(r*a)/o):(s=1-r,u=r),t[0]=s*l+u*d,t[1]=s*c+u*p,t[2]=s*f+u*g,t[3]=s*h+u*m,t},s.sqlerp=function(){var t=s.create(),e=s.create();return function(n,r,a,i,o,u){return s.slerp(t,r,o,u),s.slerp(e,a,i,u),s.slerp(n,t,e,2*u*(1-u)),n}}(),s.invert=function(t,e){var n=e[0],r=e[1],a=e[2],i=e[3],o=n*n+r*r+a*a+i*i,s=o?1/o:0;return t[0]=-n*s,t[1]=-r*s,t[2]=-a*s,t[3]=i*s,t},s.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t},s.length=o.length,s.len=s.length,s.squaredLength=o.squaredLength,s.sqrLen=s.squaredLength,s.normalize=o.normalize,s.fromMat3=function(t,e){var n,r=e[0]+e[4]+e[8];if(r>0)n=Math.sqrt(r+1),t[3]=.5*n,n=.5/n,t[0]=(e[5]-e[7])*n,t[1]=(e[6]-e[2])*n,t[2]=(e[1]-e[3])*n;else{var a=0;e[4]>e[0]&&(a=1),e[8]>e[3*a+a]&&(a=2);var i=(a+1)%3,o=(a+2)%3;n=Math.sqrt(e[3*a+a]-e[3*i+i]-e[3*o+o]+1),t[a]=.5*n,n=.5/n,t[3]=(e[3*i+o]-e[3*o+i])*n,t[i]=(e[3*i+a]+e[3*a+i])*n,t[o]=(e[3*o+a]+e[3*a+o])*n}return t},s.str=function(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},s.exactEquals=o.exactEquals,s.equals=o.equals,e.exports=s},{"./common.js":27,"./mat3.js":30,"./vec3.js":34,"./vec4.js":35}],33:[function(t,e,n){var r=t("./common.js"),a={};a.create=function(){var t=new r.ARRAY_TYPE(2);return t[0]=0,t[1]=0,t},a.clone=function(t){var e=new r.ARRAY_TYPE(2);return e[0]=t[0],e[1]=t[1],e},a.fromValues=function(t,e){var n=new r.ARRAY_TYPE(2);return n[0]=t,n[1]=e,n},a.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t},a.set=function(t,e,n){return t[0]=e,t[1]=n,t},a.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t},a.subtract=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t},a.sub=a.subtract,a.multiply=function(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t},a.mul=a.multiply,a.divide=function(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t},a.div=a.divide,a.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t},a.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t},a.min=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t},a.max=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t},a.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t},a.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t},a.scaleAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t},a.distance=function(t,e){var n=e[0]-t[0],r=e[1]-t[1];return Math.sqrt(n*n+r*r)},a.dist=a.distance,a.squaredDistance=function(t,e){var n=e[0]-t[0],r=e[1]-t[1];return n*n+r*r},a.sqrDist=a.squaredDistance,a.length=function(t){var e=t[0],n=t[1];return Math.sqrt(e*e+n*n)},a.len=a.length,a.squaredLength=function(t){var e=t[0],n=t[1];return e*e+n*n},a.sqrLen=a.squaredLength,a.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t},a.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t},a.normalize=function(t,e){var n=e[0],r=e[1],a=n*n+r*r;return a>0&&(a=1/Math.sqrt(a),t[0]=e[0]*a,t[1]=e[1]*a),t},a.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]},a.cross=function(t,e,n){var r=e[0]*n[1]-e[1]*n[0];return t[0]=t[1]=0,t[2]=r,t},a.lerp=function(t,e,n,r){var a=e[0],i=e[1];return t[0]=a+r*(n[0]-a),t[1]=i+r*(n[1]-i),t},a.random=function(t,e){e=e||1;var n=2*r.RANDOM()*Math.PI;return t[0]=Math.cos(n)*e,t[1]=Math.sin(n)*e,t},a.transformMat2=function(t,e,n){var r=e[0],a=e[1];return t[0]=n[0]*r+n[2]*a,t[1]=n[1]*r+n[3]*a,t},a.transformMat2d=function(t,e,n){var r=e[0],a=e[1];return t[0]=n[0]*r+n[2]*a+n[4],t[1]=n[1]*r+n[3]*a+n[5],t},a.transformMat3=function(t,e,n){var r=e[0],a=e[1];return t[0]=n[0]*r+n[3]*a+n[6],t[1]=n[1]*r+n[4]*a+n[7],t},a.transformMat4=function(t,e,n){var r=e[0],a=e[1];return t[0]=n[0]*r+n[4]*a+n[12],t[1]=n[1]*r+n[5]*a+n[13],t},a.forEach=function(){var t=a.create();return function(e,n,r,a,i,o){var s,u;for(n||(n=2),r||(r=0),u=a?Math.min(a*n+r,e.length):e.length,s=r;s<u;s+=n)t[0]=e[s],t[1]=e[s+1],i(t,t,o),e[s]=t[0],e[s+1]=t[1];return e}}(),a.str=function(t){return"vec2("+t[0]+", "+t[1]+")"},a.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]},a.equals=function(t,e){var n=t[0],a=t[1],i=e[0],o=e[1];return Math.abs(n-i)<=r.EPSILON*Math.max(1,Math.abs(n),Math.abs(i))&&Math.abs(a-o)<=r.EPSILON*Math.max(1,Math.abs(a),Math.abs(o))},e.exports=a},{"./common.js":27}],34:[function(t,e,n){var r=t("./common.js"),a={};a.create=function(){var t=new r.ARRAY_TYPE(3);return t[0]=0,t[1]=0,t[2]=0,t},a.clone=function(t){var e=new r.ARRAY_TYPE(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},a.fromValues=function(t,e,n){var a=new r.ARRAY_TYPE(3);return a[0]=t,a[1]=e,a[2]=n,a},a.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},a.set=function(t,e,n,r){return t[0]=e,t[1]=n,t[2]=r,t},a.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t},a.subtract=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t},a.sub=a.subtract,a.multiply=function(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t},a.mul=a.multiply,a.divide=function(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t},a.div=a.divide,a.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t},a.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t},a.min=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t},a.max=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t},a.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t},a.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t},a.scaleAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t},a.distance=function(t,e){var n=e[0]-t[0],r=e[1]-t[1],a=e[2]-t[2];return Math.sqrt(n*n+r*r+a*a)},a.dist=a.distance,a.squaredDistance=function(t,e){var n=e[0]-t[0],r=e[1]-t[1],a=e[2]-t[2];return n*n+r*r+a*a},a.sqrDist=a.squaredDistance,a.length=function(t){var e=t[0],n=t[1],r=t[2];return Math.sqrt(e*e+n*n+r*r)},a.len=a.length,a.squaredLength=function(t){var e=t[0],n=t[1],r=t[2];return e*e+n*n+r*r},a.sqrLen=a.squaredLength,a.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t},a.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t},a.normalize=function(t,e){var n=e[0],r=e[1],a=e[2],i=n*n+r*r+a*a;return i>0&&(i=1/Math.sqrt(i),t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i),t},a.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},a.cross=function(t,e,n){var r=e[0],a=e[1],i=e[2],o=n[0],s=n[1],u=n[2];return t[0]=a*u-i*s,t[1]=i*o-r*u,t[2]=r*s-a*o,t},a.lerp=function(t,e,n,r){var a=e[0],i=e[1],o=e[2];return t[0]=a+r*(n[0]-a),t[1]=i+r*(n[1]-i),t[2]=o+r*(n[2]-o),t},a.hermite=function(t,e,n,r,a,i){var o=i*i,s=o*(2*i-3)+1,u=o*(i-2)+i,l=o*(i-1),c=o*(3-2*i);return t[0]=e[0]*s+n[0]*u+r[0]*l+a[0]*c,t[1]=e[1]*s+n[1]*u+r[1]*l+a[1]*c,t[2]=e[2]*s+n[2]*u+r[2]*l+a[2]*c,t},a.bezier=function(t,e,n,r,a,i){var o=1-i,s=o*o,u=i*i,l=s*o,c=3*i*s,f=3*u*o,h=u*i;return t[0]=e[0]*l+n[0]*c+r[0]*f+a[0]*h,t[1]=e[1]*l+n[1]*c+r[1]*f+a[1]*h,t[2]=e[2]*l+n[2]*c+r[2]*f+a[2]*h,t},a.random=function(t,e){e=e||1;var n=2*r.RANDOM()*Math.PI,a=2*r.RANDOM()-1,i=Math.sqrt(1-a*a)*e;return t[0]=Math.cos(n)*i,t[1]=Math.sin(n)*i,t[2]=a*e,t},a.transformMat4=function(t,e,n){var r=e[0],a=e[1],i=e[2],o=n[3]*r+n[7]*a+n[11]*i+n[15];return o=o||1,t[0]=(n[0]*r+n[4]*a+n[8]*i+n[12])/o,t[1]=(n[1]*r+n[5]*a+n[9]*i+n[13])/o,t[2]=(n[2]*r+n[6]*a+n[10]*i+n[14])/o,t},a.transformMat3=function(t,e,n){var r=e[0],a=e[1],i=e[2];return t[0]=r*n[0]+a*n[3]+i*n[6],t[1]=r*n[1]+a*n[4]+i*n[7],t[2]=r*n[2]+a*n[5]+i*n[8],t},a.transformQuat=function(t,e,n){var r=e[0],a=e[1],i=e[2],o=n[0],s=n[1],u=n[2],l=n[3],c=l*r+s*i-u*a,f=l*a+u*r-o*i,h=l*i+o*a-s*r,d=-o*r-s*a-u*i;return t[0]=c*l+d*-o+f*-u-h*-s,t[1]=f*l+d*-s+h*-o-c*-u,t[2]=h*l+d*-u+c*-s-f*-o,t},a.rotateX=function(t,e,n,r){var a=[],i=[];return a[0]=e[0]-n[0],a[1]=e[1]-n[1],a[2]=e[2]-n[2],i[0]=a[0],i[1]=a[1]*Math.cos(r)-a[2]*Math.sin(r),i[2]=a[1]*Math.sin(r)+a[2]*Math.cos(r),t[0]=i[0]+n[0],t[1]=i[1]+n[1],t[2]=i[2]+n[2],t},a.rotateY=function(t,e,n,r){var a=[],i=[];return a[0]=e[0]-n[0],a[1]=e[1]-n[1],a[2]=e[2]-n[2],i[0]=a[2]*Math.sin(r)+a[0]*Math.cos(r),i[1]=a[1],i[2]=a[2]*Math.cos(r)-a[0]*Math.sin(r),t[0]=i[0]+n[0],t[1]=i[1]+n[1],t[2]=i[2]+n[2],t},a.rotateZ=function(t,e,n,r){var a=[],i=[];return a[0]=e[0]-n[0],a[1]=e[1]-n[1],a[2]=e[2]-n[2],i[0]=a[0]*Math.cos(r)-a[1]*Math.sin(r),i[1]=a[0]*Math.sin(r)+a[1]*Math.cos(r),i[2]=a[2],t[0]=i[0]+n[0],t[1]=i[1]+n[1],t[2]=i[2]+n[2],t},a.forEach=function(){var t=a.create();return function(e,n,r,a,i,o){var s,u;for(n||(n=3),r||(r=0),u=a?Math.min(a*n+r,e.length):e.length,s=r;s<u;s+=n)t[0]=e[s],t[1]=e[s+1],t[2]=e[s+2],i(t,t,o),e[s]=t[0],e[s+1]=t[1],e[s+2]=t[2];return e}}(),a.angle=function(t,e){var n=a.fromValues(t[0],t[1],t[2]),r=a.fromValues(e[0],e[1],e[2]);a.normalize(n,n),a.normalize(r,r);var i=a.dot(n,r);return i>1?0:Math.acos(i)},a.str=function(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"},a.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]},a.equals=function(t,e){var n=t[0],a=t[1],i=t[2],o=e[0],s=e[1],u=e[2];return Math.abs(n-o)<=r.EPSILON*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(a-s)<=r.EPSILON*Math.max(1,Math.abs(a),Math.abs(s))&&Math.abs(i-u)<=r.EPSILON*Math.max(1,Math.abs(i),Math.abs(u))},e.exports=a},{"./common.js":27}],35:[function(t,e,n){var r=t("./common.js"),a={};a.create=function(){var t=new r.ARRAY_TYPE(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t},a.clone=function(t){var e=new r.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},a.fromValues=function(t,e,n,a){var i=new r.ARRAY_TYPE(4);return i[0]=t,i[1]=e,i[2]=n,i[3]=a,i},a.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},a.set=function(t,e,n,r,a){return t[0]=e,t[1]=n,t[2]=r,t[3]=a,t},a.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t},a.subtract=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t},a.sub=a.subtract,a.multiply=function(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t[3]=e[3]*n[3],t},a.mul=a.multiply,a.divide=function(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t[3]=e[3]/n[3],t},a.div=a.divide,a.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t},a.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t},a.min=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t[3]=Math.min(e[3],n[3]),t},a.max=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t[3]=Math.max(e[3],n[3]),t},a.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t},a.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t},a.scaleAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t},a.distance=function(t,e){var n=e[0]-t[0],r=e[1]-t[1],a=e[2]-t[2],i=e[3]-t[3];return Math.sqrt(n*n+r*r+a*a+i*i)},a.dist=a.distance,a.squaredDistance=function(t,e){var n=e[0]-t[0],r=e[1]-t[1],a=e[2]-t[2],i=e[3]-t[3];return n*n+r*r+a*a+i*i},a.sqrDist=a.squaredDistance,a.length=function(t){var e=t[0],n=t[1],r=t[2],a=t[3];return Math.sqrt(e*e+n*n+r*r+a*a)},a.len=a.length,a.squaredLength=function(t){var e=t[0],n=t[1],r=t[2],a=t[3];return e*e+n*n+r*r+a*a},a.sqrLen=a.squaredLength,a.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},a.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t},a.normalize=function(t,e){var n=e[0],r=e[1],a=e[2],i=e[3],o=n*n+r*r+a*a+i*i;return o>0&&(o=1/Math.sqrt(o),t[0]=n*o,t[1]=r*o,t[2]=a*o,t[3]=i*o),t},a.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},a.lerp=function(t,e,n,r){var a=e[0],i=e[1],o=e[2],s=e[3];return t[0]=a+r*(n[0]-a),t[1]=i+r*(n[1]-i),t[2]=o+r*(n[2]-o),t[3]=s+r*(n[3]-s),t},a.random=function(t,e){return e=e||1,t[0]=r.RANDOM(),t[1]=r.RANDOM(),t[2]=r.RANDOM(),t[3]=r.RANDOM(),a.normalize(t,t),a.scale(t,t,e),t},a.transformMat4=function(t,e,n){var r=e[0],a=e[1],i=e[2],o=e[3];return t[0]=n[0]*r+n[4]*a+n[8]*i+n[12]*o,t[1]=n[1]*r+n[5]*a+n[9]*i+n[13]*o,t[2]=n[2]*r+n[6]*a+n[10]*i+n[14]*o,t[3]=n[3]*r+n[7]*a+n[11]*i+n[15]*o,t},a.transformQuat=function(t,e,n){var r=e[0],a=e[1],i=e[2],o=n[0],s=n[1],u=n[2],l=n[3],c=l*r+s*i-u*a,f=l*a+u*r-o*i,h=l*i+o*a-s*r,d=-o*r-s*a-u*i;return t[0]=c*l+d*-o+f*-u-h*-s,t[1]=f*l+d*-s+h*-o-c*-u,t[2]=h*l+d*-u+c*-s-f*-o,t[3]=e[3],t},a.forEach=function(){var t=a.create();return function(e,n,r,a,i,o){var s,u;for(n||(n=4),r||(r=0),u=a?Math.min(a*n+r,e.length):e.length,s=r;s<u;s+=n)t[0]=e[s],t[1]=e[s+1],t[2]=e[s+2],t[3]=e[s+3],i(t,t,o),e[s]=t[0],e[s+1]=t[1],e[s+2]=t[2],e[s+3]=t[3];return e}}(),a.str=function(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},a.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},a.equals=function(t,e){var n=t[0],a=t[1],i=t[2],o=t[3],s=e[0],u=e[1],l=e[2],c=e[3];return Math.abs(n-s)<=r.EPSILON*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(a-u)<=r.EPSILON*Math.max(1,Math.abs(a),Math.abs(u))&&Math.abs(i-l)<=r.EPSILON*Math.max(1,Math.abs(i),Math.abs(l))&&Math.abs(o-c)<=r.EPSILON*Math.max(1,Math.abs(o),Math.abs(c))},e.exports=a},{"./common.js":27}],36:[function(t,e,n){"use strict";function r(t){this.gl=t,this.gl.lastAttribCount=0,this._vref=this._fref=this._relink=this.vertShader=this.fragShader=this.program=this.attributes=this.uniforms=this.types=null}function a(t,e){return t.name<e.name?-1:1}function i(t,e,n,a,i){var o=new r(t);return o.update(e,n,a,i),o}var o=t("./lib/create-uniforms"),s=t("./lib/create-attributes"),u=t("./lib/reflect"),l=t("./lib/shader-cache"),c=t("./lib/runtime-reflect"),f=t("./lib/GLError"),h=r.prototype;h.bind=function(){this.program||this._relink();var t,e=this.gl.getProgramParameter(this.program,this.gl.ACTIVE_ATTRIBUTES),n=this.gl.lastAttribCount;if(e>n)for(t=n;t<e;t++)this.gl.enableVertexAttribArray(t);else if(n>e)for(t=e;t<n;t++)this.gl.disableVertexAttribArray(t);this.gl.lastAttribCount=e,this.gl.useProgram(this.program)},h.dispose=function(){for(var t=this.gl.lastAttribCount,e=0;e<t;e++)this.gl.disableVertexAttribArray(e);this.gl.lastAttribCount=0,this._fref&&this._fref.dispose(),this._vref&&this._vref.dispose(),this.attributes=this.types=this.vertShader=this.fragShader=this.program=this._relink=this._fref=this._vref=null},h.update=function(t,e,n,r){function i(){d.program=l.program(p,d._vref,d._fref,x,w);for(var t=0;t<n.length;++t)T[t]=p.getUniformLocation(d.program,n[t].name)}if(!e||1===arguments.length){var h=t;t=h.vertex,e=h.fragment,n=h.uniforms,r=h.attributes}var d=this,p=d.gl,g=d._vref;d._vref=l.shader(p,p.VERTEX_SHADER,t),g&&g.dispose(),d.vertShader=d._vref.shader;var m=this._fref;if(d._fref=l.shader(p,p.FRAGMENT_SHADER,e),m&&m.dispose(),d.fragShader=d._fref.shader,!n||!r){var v=p.createProgram();if(p.attachShader(v,d.fragShader),p.attachShader(v,d.vertShader),p.linkProgram(v),!p.getProgramParameter(v,p.LINK_STATUS)){var y=p.getProgramInfoLog(v);throw new f(y,"Error linking program:"+y)}n=n||c.uniforms(p,v),r=r||c.attributes(p,v),p.deleteProgram(v)}r=r.slice(),r.sort(a);var _,b=[],x=[],w=[];for(_=0;_<r.length;++_){var E=r[_];if(E.type.indexOf("mat")>=0){for(var M=0|E.type.charAt(E.type.length-1),I=new Array(M),A=0;A<M;++A)I[A]=w.length,x.push(E.name+"["+A+"]"),"number"==typeof E.location?w.push(E.location+A):Array.isArray(E.location)&&E.location.length===M&&"number"==typeof E.location[A]?w.push(0|E.location[A]):w.push(-1);b.push({name:E.name,type:E.type,locations:I})}else b.push({name:E.name,type:E.type,locations:[w.length]}),x.push(E.name),"number"==typeof E.location?w.push(0|E.location):w.push(-1)}var S=0;for(_=0;_<w.length;++_)if(w[_]<0){for(;w.indexOf(S)>=0;)S+=1;w[_]=S}var T=new Array(n.length);i(),d._relink=i,d.types={uniforms:u(n),attributes:u(r)},d.attributes=s(p,d,b,w),Object.defineProperty(d,"uniforms",o(p,d,n,T))},e.exports=i},{"./lib/GLError":37,"./lib/create-attributes":38,"./lib/create-uniforms":39,"./lib/reflect":40,"./lib/runtime-reflect":41,"./lib/shader-cache":42}],37:[function(t,e,n){function r(t,e,n){this.shortMessage=e||"",this.longMessage=n||"",this.rawError=t||"",this.message="gl-shader: "+(e||t||"")+(n?"\n"+n:""),this.stack=(new Error).stack}r.prototype=new Error,r.prototype.name="GLError",r.prototype.constructor=r,e.exports=r},{}],38:[function(t,e,n){"use strict";function r(t,e,n,r,a,i){this._gl=t,this._wrapper=e,this._index=n,this._locations=r,this._dimension=a,this._constFunc=i}function a(t,e,n,a,i,o,s){for(var u=["gl","v"],l=[],c=0;c<i;++c)u.push("x"+c),l.push("x"+c);u.push("if(x0.length===void 0){return gl.vertexAttrib"+i+"f(v,"+l.join()+")}else{return gl.vertexAttrib"+i+"fv(v,x0)}");var f=Function.apply(null,u),h=new r(t,e,n,a,i,f);Object.defineProperty(o,s,{set:function(e){return t.disableVertexAttribArray(a[n]),f(t,a[n],e),e},get:function(){return h},enumerable:!0})}function i(t,e,n,r,i,o,s){for(var u=new Array(i),l=new Array(i),c=0;c<i;++c)a(t,e,n[c],r,i,u,c),l[c]=u[c];Object.defineProperty(u,"location",{set:function(t){if(Array.isArray(t))for(var e=0;e<i;++e)l[e].location=t[e];else for(var e=0;e<i;++e)l[e].location=t+e;return t},get:function(){for(var t=new Array(i),e=0;e<i;++e)t[e]=r[n[e]];return t},enumerable:!0}),u.pointer=function(e,a,o,s){e=e||t.FLOAT,a=!!a,o=o||i*i,s=s||0;for(var u=0;u<i;++u){var l=r[n[u]];t.vertexAttribPointer(l,i,e,a,o,s+u*i),t.enableVertexAttribArray(l)}};var f=new Array(i),h=t["vertexAttrib"+i+"fv"];Object.defineProperty(o,s,{set:function(e){for(var a=0;a<i;++a){var o=r[n[a]];if(t.disableVertexAttribArray(o),Array.isArray(e[0]))h.call(t,o,e[a]);else{for(var s=0;s<i;++s)f[s]=e[i*a+s];h.call(t,o,f)}}return e},get:function(){return u},enumerable:!0})}function o(t,e,n,r){for(var o={},u=0,l=n.length;u<l;++u){var c=n[u],f=c.name,h=c.type,d=c.locations;switch(h){case"bool":case"int":case"float":a(t,e,d[0],r,1,o,f);break;default:if(h.indexOf("vec")>=0){var p=h.charCodeAt(h.length-1)-48;if(p<2||p>4)throw new s("","Invalid data type for attribute "+f+": "+h);a(t,e,d[0],r,p,o,f)}else{if(!(h.indexOf("mat")>=0))throw new s("","Unknown data type for attribute "+f+": "+h);var p=h.charCodeAt(h.length-1)-48;if(p<2||p>4)throw new s("","Invalid data type for attribute "+f+": "+h);i(t,e,d,r,p,o,f)}}}return o}e.exports=o;var s=t("./GLError"),u=r.prototype;u.pointer=function(t,e,n,r){var a=this,i=a._gl,o=a._locations[a._index];i.vertexAttribPointer(o,a._dimension,t||i.FLOAT,!!e,n||0,r||0),i.enableVertexAttribArray(o)},u.set=function(t,e,n,r){return this._constFunc(this._locations[this._index],t,e,n,r)},Object.defineProperty(u,"location",{get:function(){return this._locations[this._index]},set:function(t){return t!==this._locations[this._index]&&(this._locations[this._index]=0|t,this._wrapper.program=null),0|t}})},{"./GLError":37}],39:[function(t,e,n){"use strict";function r(t){var e=new Function("y","return function(){return y}");return e(t)}function a(t,e){for(var n=new Array(t),r=0;r<t;++r)n[r]=e;return n}function i(t,e,n,i){function u(n){var r=new Function("gl","wrapper","locations","return function(){return gl.getUniform(wrapper.program,locations["+n+"])}");return r(t,e,i)}function l(t,e,n){switch(n){case"bool":case"int":case"sampler2D":case"samplerCube":return"gl.uniform1i(locations["+e+"],obj"+t+")";case"float":return"gl.uniform1f(locations["+e+"],obj"+t+")";default:var r=n.indexOf("vec");if(!(0<=r&&r<=1&&n.length===4+r)){if(0===n.indexOf("mat")&&4===n.length){var a=n.charCodeAt(n.length-1)-48;if(a<2||a>4)throw new s("","Invalid uniform dimension type for matrix "+name+": "+n);return"gl.uniformMatrix"+a+"fv(locations["+e+"],false,obj"+t+")"}throw new s("","Unknown uniform data type for "+name+": "+n)}var a=n.charCodeAt(n.length-1)-48;if(a<2||a>4)throw new s("","Invalid data type");switch(n.charAt(0)){case"b":case"i":return"gl.uniform"+a+"iv(locations["+e+"],obj"+t+")";case"v":return"gl.uniform"+a+"fv(locations["+e+"],obj"+t+")";default:throw new s("","Unrecognized data type for vector "+name+": "+n)}}}function c(t,e){if("object"!=typeof e)return[[t,e]];var n=[];for(var r in e){var a=e[r],i=t;i+=parseInt(r)+""===r?"["+r+"]":"."+r,"object"==typeof a?n.push.apply(n,c(i,a)):n.push([i,a])}return n}function f(e){for(var r=["return function updateProperty(obj){"],a=c("",e),o=0;o<a.length;++o){var s=a[o],u=s[0],f=s[1];i[f]&&r.push(l(u,f,n[f].type))}r.push("return obj}");var h=new Function("gl","locations",r.join("\n"));return h(t,i)}function h(t){switch(t){case"bool":return!1;case"int":case"sampler2D":case"samplerCube":return 0;case"float":return 0;default:var e=t.indexOf("vec");if(0<=e&&e<=1&&t.length===4+e){var n=t.charCodeAt(t.length-1)-48;if(n<2||n>4)throw new s("","Invalid data type");return"b"===t.charAt(0)?a(n,!1):a(n,0)}if(0===t.indexOf("mat")&&4===t.length){var n=t.charCodeAt(t.length-1)-48;if(n<2||n>4)throw new s("","Invalid uniform dimension type for matrix "+name+": "+t);return a(n*n,0)}throw new s("","Unknown uniform data type for "+name+": "+t)}}function d(t,e,a){if("object"==typeof a){var o=p(a);Object.defineProperty(t,e,{get:r(o),set:f(a),enumerable:!0,configurable:!1})}else i[a]?Object.defineProperty(t,e,{get:u(a),set:f(a),enumerable:!0,configurable:!1}):t[e]=h(n[a].type)}function p(t){var e;if(Array.isArray(t)){e=new Array(t.length);for(var n=0;n<t.length;++n)d(e,n,t[n])}else{e={};for(var r in t)d(e,r,t[r])}return e}var g=o(n,!0);return{get:r(p(g)),set:f(g),enumerable:!0,configurable:!0}}var o=t("./reflect"),s=t("./GLError");e.exports=i},{"./GLError":37,"./reflect":40}],40:[function(t,e,n){"use strict";function r(t,e){for(var n={},r=0;r<t.length;++r)for(var a=t[r].name,i=a.split("."),o=n,s=0;s<i.length;++s){var u=i[s].split("[");if(u.length>1){u[0]in o||(o[u[0]]=[]),o=o[u[0]];for(var l=1;l<u.length;++l){var c=parseInt(u[l]);l<u.length-1||s<i.length-1?(c in o||(l<u.length-1?o[c]=[]:o[c]={}),o=o[c]):e?o[c]=r:o[c]=t[r].type}}else s<i.length-1?(u[0]in o||(o[u[0]]={}),o=o[u[0]]):e?o[u[0]]=r:o[u[0]]=t[r].type}return n}e.exports=r},{}],41:[function(t,e,n){"use strict";function r(t,e){if(!s){var n=Object.keys(o);s={};for(var r=0;r<n.length;++r){var a=n[r];s[t[a]]=o[a]}}return s[e]}function a(t,e){for(var n=t.getProgramParameter(e,t.ACTIVE_UNIFORMS),a=[],i=0;i<n;++i){var o=t.getActiveUniform(e,i);if(o){var s=r(t,o.type);if(o.size>1)for(var u=0;u<o.size;++u)a.push({name:o.name.replace("[0]","["+u+"]"),type:s});else a.push({name:o.name,type:s})}}return a}function i(t,e){for(var n=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES),a=[],i=0;i<n;++i){var o=t.getActiveAttrib(e,i);o&&a.push({name:o.name,type:r(t,o.type)})}return a}n.uniforms=a,n.attributes=i;var o={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube"},s=null},{}],42:[function(t,e,n){"use strict";function r(t,e,n,r,a,i,o){this.id=t,this.src=e,this.type=n,this.shader=r,this.count=i,this.programs=[],this.cache=o}function a(t){this.gl=t,this.shaders=[{},{}],this.programs={}}function i(t){var e=t.split("\n"),n=1;return e.map(function(t){var e=n<100&&n>=10?"0"+n:n<10?"00"+n:n;return e+=": ",n++,e+t}).join("\n")}function o(t,e,n){var r=t.createShader(e);if(t.shaderSource(r,n),t.compileShader(r),!t.getShaderParameter(r,t.COMPILE_STATUS)){var a=t.getShaderInfoLog(r);try{var o=h(a,n,e)}catch(t){throw console.warn("Failed to format compiler error: "+t),console.warn(i(n)),new f(a,"Error compiling shader:\n"+a)}throw new f(a,o.short,o.long)}return r}function s(t,e,n,r,a){var i=t.createProgram();t.attachShader(i,e),t.attachShader(i,n);for(var o=0;o<r.length;++o)t.bindAttribLocation(i,a[o],r[o]);if(t.linkProgram(i),!t.getProgramParameter(i,t.LINK_STATUS)){var s=t.getProgramInfoLog(i);throw new f(s,"Error linking program: "+s)}return i}function u(t){var e=p.get(t);return e||(e=new a(t),p.set(t,e)),e}function l(t,e,n){return u(t).getShaderReference(e,n)}function c(t,e,n,r,a){return u(t).getProgram(e,n,r,a)}n.shader=l,n.program=c;var f=t("./GLError"),h=t("gl-format-compiler-error"),d="undefined"==typeof WeakMap?t("weakmap-shim"):WeakMap,p=new d,g=0;r.prototype.dispose=function(){if(0===--this.count){for(var t=this.cache,e=t.gl,n=this.programs,r=0,a=n.length;r<a;++r){var i=t.programs[n[r]];i&&(delete t.programs[r],e.deleteProgram(i))}e.deleteShader(this.shader),delete t.shaders[this.type===e.FRAGMENT_SHADER|0][this.src]}};var m=a.prototype;m.getShaderReference=function(t,e){var n=this.gl,a=this.shaders[t===n.FRAGMENT_SHADER|0],i=a[e];if(i&&n.isShader(i.shader))i.count+=1;else{var s=o(n,t,e);i=a[e]=new r(g++,e,t,s,[],1,this)}return i},m.getProgram=function(t,e,n,r){var a=[t.id,e.id,n.join(":"),r.join(":")].join("@"),i=this.programs[a];return i&&this.gl.isProgram(i)||(this.programs[a]=i=s(this.gl,t.shader,e.shader,n,r),t.programs.push(a),e.programs.push(a)),i}},{"./GLError":37,"gl-format-compiler-error":25,"weakmap-shim":83}],43:[function(t,e,n){"use strict";function r(t){v=[t.LINEAR,t.NEAREST_MIPMAP_LINEAR,t.LINEAR_MIPMAP_NEAREST,t.LINEAR_MIPMAP_NEAREST],y=[t.NEAREST,t.LINEAR,t.NEAREST_MIPMAP_NEAREST,t.NEAREST_MIPMAP_LINEAR,t.LINEAR_MIPMAP_NEAREST,t.LINEAR_MIPMAP_LINEAR],_=[t.REPEAT,t.CLAMP_TO_EDGE,t.MIRRORED_REPEAT]}function a(t){return"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!=typeof HTMLVideoElement&&t instanceof HTMLVideoElement||"undefined"!=typeof ImageData&&t instanceof ImageData}function i(t,e,n){var r=t.gl,a=r.getParameter(r.MAX_TEXTURE_SIZE);if(e<0||e>a||n<0||n>a)throw new Error("gl-texture2d: Invalid texture size");return t._shape=[e,n],t.bind(),r.texImage2D(r.TEXTURE_2D,0,t.format,e,n,0,t.format,t.type,null),t._mipLevels=[0],t}function o(t,e,n,r,a,i){this.gl=t,this.handle=e,this.format=a,this.type=i,this._shape=[n,r],this._mipLevels=[0],this._magFilter=t.NEAREST,this._minFilter=t.NEAREST,this._wrapS=t.CLAMP_TO_EDGE,this._wrapT=t.CLAMP_TO_EDGE,this._anisoSamples=1;var o=this,s=[this._wrapS,this._wrapT];Object.defineProperties(s,[{get:function(){
return o._wrapS},set:function(t){return o.wrapS=t}},{get:function(){return o._wrapT},set:function(t){return o.wrapT=t}}]),this._wrapVector=s;var u=[this._shape[0],this._shape[1]];Object.defineProperties(u,[{get:function(){return o._shape[0]},set:function(t){return o.width=t}},{get:function(){return o._shape[1]},set:function(t){return o.height=t}}]),this._shapeVector=u}function s(t,e){return 3===t.length?1===e[2]&&e[1]===t[0]*t[2]&&e[0]===t[2]:1===e[0]&&e[1]===t[0]}function u(t,e,n,r,a,i,o,u){var l=u.dtype,c=u.shape.slice();if(c.length<2||c.length>3)throw new Error("gl-texture2d: Invalid ndarray, must be 2d or 3d");var f=0,h=0,d=s(c,u.stride.slice());"float32"===l?f=t.FLOAT:"float64"===l?(f=t.FLOAT,d=!1,l="float32"):"uint8"===l?f=t.UNSIGNED_BYTE:(f=t.UNSIGNED_BYTE,d=!1,l="uint8");var v=1;if(2===c.length)h=t.LUMINANCE,c=[c[0],c[1],1],u=p(u.data,c,[u.stride[0],u.stride[1],1],u.offset);else{if(3!==c.length)throw new Error("gl-texture2d: Invalid shape for texture");if(1===c[2])h=t.ALPHA;else if(2===c[2])h=t.LUMINANCE_ALPHA;else if(3===c[2])h=t.RGB;else{if(4!==c[2])throw new Error("gl-texture2d: Invalid shape for pixel coords");h=t.RGBA}v=c[2]}if(h!==t.LUMINANCE&&h!==t.ALPHA||a!==t.LUMINANCE&&a!==t.ALPHA||(h=a),h!==a)throw new Error("gl-texture2d: Incompatible texture format for setPixels");var y=u.size,_=o.indexOf(r)<0;if(_&&o.push(r),f===i&&d)0===u.offset&&u.data.length===y?_?t.texImage2D(t.TEXTURE_2D,r,a,c[0],c[1],0,a,i,u.data):t.texSubImage2D(t.TEXTURE_2D,r,e,n,c[0],c[1],a,i,u.data):_?t.texImage2D(t.TEXTURE_2D,r,a,c[0],c[1],0,a,i,u.data.subarray(u.offset,u.offset+y)):t.texSubImage2D(t.TEXTURE_2D,r,e,n,c[0],c[1],a,i,u.data.subarray(u.offset,u.offset+y));else{var x;x=i===t.FLOAT?m.mallocFloat32(y):m.mallocUint8(y);var w=p(x,c,[c[2],c[2]*c[0],1]);f===t.FLOAT&&i===t.UNSIGNED_BYTE?b(w,u):g.assign(w,u),_?t.texImage2D(t.TEXTURE_2D,r,a,c[0],c[1],0,a,i,x.subarray(0,y)):t.texSubImage2D(t.TEXTURE_2D,r,e,n,c[0],c[1],a,i,x.subarray(0,y)),i===t.FLOAT?m.freeFloat32(x):m.freeUint8(x)}}function l(t){var e=t.createTexture();return t.bindTexture(t.TEXTURE_2D,e),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),e}function c(t,e,n,r,a){var i=t.getParameter(t.MAX_TEXTURE_SIZE);if(e<0||e>i||n<0||n>i)throw new Error("gl-texture2d: Invalid texture shape");if(a===t.FLOAT&&!t.getExtension("OES_texture_float"))throw new Error("gl-texture2d: Floating point textures not supported on this platform");var s=l(t);return t.texImage2D(t.TEXTURE_2D,0,r,e,n,0,r,a,null),new o(t,s,e,n,r,a)}function f(t,e,n,r,a,i){var s=l(t);return t.texImage2D(t.TEXTURE_2D,0,a,a,i,e),new o(t,s,n,r,a,i)}function h(t,e){var n=e.dtype,r=e.shape.slice(),a=t.getParameter(t.MAX_TEXTURE_SIZE);if(r[0]<0||r[0]>a||r[1]<0||r[1]>a)throw new Error("gl-texture2d: Invalid texture size");var i=s(r,e.stride.slice()),u=0;"float32"===n?u=t.FLOAT:"float64"===n?(u=t.FLOAT,i=!1,n="float32"):"uint8"===n?u=t.UNSIGNED_BYTE:(u=t.UNSIGNED_BYTE,i=!1,n="uint8");var c=0;if(2===r.length)c=t.LUMINANCE,r=[r[0],r[1],1],e=p(e.data,r,[e.stride[0],e.stride[1],1],e.offset);else{if(3!==r.length)throw new Error("gl-texture2d: Invalid shape for texture");if(1===r[2])c=t.ALPHA;else if(2===r[2])c=t.LUMINANCE_ALPHA;else if(3===r[2])c=t.RGB;else{if(4!==r[2])throw new Error("gl-texture2d: Invalid shape for pixel coords");c=t.RGBA}}u!==t.FLOAT||t.getExtension("OES_texture_float")||(u=t.UNSIGNED_BYTE,i=!1);var f,h,d=e.size;if(i)f=0===e.offset&&e.data.length===d?e.data:e.data.subarray(e.offset,e.offset+d);else{var v=[r[2],r[2]*r[0],1];h=m.malloc(d,n);var y=p(h,r,v,0);"float32"!==n&&"float64"!==n||u!==t.UNSIGNED_BYTE?g.assign(y,e):b(y,e),f=h.subarray(0,d)}var _=l(t);return t.texImage2D(t.TEXTURE_2D,0,c,r[0],r[1],0,c,u,f),i||m.free(h),new o(t,_,r[0],r[1],c,u)}function d(t){if(arguments.length<=1)throw new Error("gl-texture2d: Missing arguments for texture2d constructor");if(v||r(t),"number"==typeof arguments[1])return c(t,arguments[1],arguments[2],arguments[3]||t.RGBA,arguments[4]||t.UNSIGNED_BYTE);if(Array.isArray(arguments[1]))return c(t,0|arguments[1][0],0|arguments[1][1],arguments[2]||t.RGBA,arguments[3]||t.UNSIGNED_BYTE);if("object"==typeof arguments[1]){var e=arguments[1],n=a(e)?e:e.raw;if(n)return f(t,n,0|e.width,0|e.height,arguments[2]||t.RGBA,arguments[3]||t.UNSIGNED_BYTE);if(e.shape&&e.data&&e.stride)return h(t,e)}throw new Error("gl-texture2d: Invalid arguments for texture2d constructor")}var p=t("ndarray"),g=t("ndarray-ops"),m=t("typedarray-pool");e.exports=d;var v=null,y=null,_=null,b=function(t,e){g.muls(t,e,255)},x=o.prototype;Object.defineProperties(x,{minFilter:{get:function(){return this._minFilter},set:function(t){this.bind();var e=this.gl;if(this.type===e.FLOAT&&v.indexOf(t)>=0&&(e.getExtension("OES_texture_float_linear")||(t=e.NEAREST)),y.indexOf(t)<0)throw new Error("gl-texture2d: Unknown filter mode "+t);return e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,t),this._minFilter=t}},magFilter:{get:function(){return this._magFilter},set:function(t){this.bind();var e=this.gl;if(this.type===e.FLOAT&&v.indexOf(t)>=0&&(e.getExtension("OES_texture_float_linear")||(t=e.NEAREST)),y.indexOf(t)<0)throw new Error("gl-texture2d: Unknown filter mode "+t);return e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,t),this._magFilter=t}},mipSamples:{get:function(){return this._anisoSamples},set:function(t){var e=this._anisoSamples;if(this._anisoSamples=0|Math.max(t,1),e!==this._anisoSamples){var n=this.gl.getExtension("EXT_texture_filter_anisotropic");n&&this.gl.texParameterf(this.gl.TEXTURE_2D,n.TEXTURE_MAX_ANISOTROPY_EXT,this._anisoSamples)}return this._anisoSamples}},wrapS:{get:function(){return this._wrapS},set:function(t){if(this.bind(),_.indexOf(t)<0)throw new Error("gl-texture2d: Unknown wrap mode "+t);return this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,t),this._wrapS=t}},wrapT:{get:function(){return this._wrapT},set:function(t){if(this.bind(),_.indexOf(t)<0)throw new Error("gl-texture2d: Unknown wrap mode "+t);return this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,t),this._wrapT=t}},wrap:{get:function(){return this._wrapVector},set:function(t){if(Array.isArray(t)||(t=[t,t]),2!==t.length)throw new Error("gl-texture2d: Must specify wrap mode for rows and columns");for(var e=0;e<2;++e)if(_.indexOf(t[e])<0)throw new Error("gl-texture2d: Unknown wrap mode "+t);this._wrapS=t[0],this._wrapT=t[1];var n=this.gl;return this.bind(),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,this._wrapS),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,this._wrapT),t}},shape:{get:function(){return this._shapeVector},set:function(t){if(Array.isArray(t)){if(2!==t.length)throw new Error("gl-texture2d: Invalid texture shape")}else t=[0|t,0|t];return i(this,0|t[0],0|t[1]),[0|t[0],0|t[1]]}},width:{get:function(){return this._shape[0]},set:function(t){return t|=0,i(this,t,this._shape[1]),t}},height:{get:function(){return this._shape[1]},set:function(t){return t|=0,i(this,this._shape[0],t),t}}}),x.bind=function(t){var e=this.gl;return void 0!==t&&e.activeTexture(e.TEXTURE0+(0|t)),e.bindTexture(e.TEXTURE_2D,this.handle),void 0!==t?0|t:e.getParameter(e.ACTIVE_TEXTURE)-e.TEXTURE0},x.dispose=function(){this.gl.deleteTexture(this.handle)},x.generateMipmap=function(){this.bind(),this.gl.generateMipmap(this.gl.TEXTURE_2D);for(var t=Math.min(this._shape[0],this._shape[1]),e=0;t>0;++e,t>>>=1)this._mipLevels.indexOf(e)<0&&this._mipLevels.push(e)},x.setPixels=function(t,e,n,r){var i=this.gl;this.bind(),Array.isArray(e)?(r=n,n=0|e[1],e=0|e[0]):(e=e||0,n=n||0),r=r||0;var o=a(t)?t:t.raw;if(o){var s=this._mipLevels.indexOf(r)<0;s?(i.texImage2D(i.TEXTURE_2D,0,this.format,this.format,this.type,o),this._mipLevels.push(r)):i.texSubImage2D(i.TEXTURE_2D,r,e,n,this.format,this.type,o)}else{if(!(t.shape&&t.stride&&t.data))throw new Error("gl-texture2d: Unsupported data type");if(t.shape.length<2||e+t.shape[1]>this._shape[1]>>>r||n+t.shape[0]>this._shape[0]>>>r||e<0||n<0)throw new Error("gl-texture2d: Texture dimensions are out of bounds");u(i,e,n,r,this.format,this.type,this._mipLevels,t)}}},{ndarray:65,"ndarray-ops":64,"typedarray-pool":78}],44:[function(t,e,n){"use strict";function r(t,e,n){e?e.bind():t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null);var r=0|t.getParameter(t.MAX_VERTEX_ATTRIBS);if(n){if(n.length>r)throw new Error("gl-vao: Too many vertex attributes");for(var a=0;a<n.length;++a){var i=n[a];if(i.buffer){var o=i.buffer,s=i.size||4,u=i.type||t.FLOAT,l=!!i.normalized,c=i.stride||0,f=i.offset||0;o.bind(),t.enableVertexAttribArray(a),t.vertexAttribPointer(a,s,u,l,c,f)}else{if("number"==typeof i)t.vertexAttrib1f(a,i);else if(1===i.length)t.vertexAttrib1f(a,i[0]);else if(2===i.length)t.vertexAttrib2f(a,i[0],i[1]);else if(3===i.length)t.vertexAttrib3f(a,i[0],i[1],i[2]);else{if(4!==i.length)throw new Error("gl-vao: Invalid vertex attribute");t.vertexAttrib4f(a,i[0],i[1],i[2],i[3])}t.disableVertexAttribArray(a)}}for(;a<r;++a)t.disableVertexAttribArray(a)}else{t.bindBuffer(t.ARRAY_BUFFER,null);for(var a=0;a<r;++a)t.disableVertexAttribArray(a)}}e.exports=r},{}],45:[function(t,e,n){"use strict";function r(t){this.gl=t,this._elements=null,this._attributes=null,this._elementsType=t.UNSIGNED_SHORT}function a(t){return new r(t)}var i=t("./do-bind.js");r.prototype.bind=function(){i(this.gl,this._elements,this._attributes)},r.prototype.update=function(t,e,n){this._elements=e,this._attributes=t,this._elementsType=n||this.gl.UNSIGNED_SHORT},r.prototype.dispose=function(){},r.prototype.unbind=function(){},r.prototype.draw=function(t,e,n){n=n||0;var r=this.gl;this._elements?r.drawElements(t,e,this._elementsType,n):r.drawArrays(t,n,e)},e.exports=a},{"./do-bind.js":44}],46:[function(t,e,n){"use strict";function r(t,e,n,r,a,i){this.location=t,this.dimension=e,this.a=n,this.b=r,this.c=a,this.d=i}function a(t,e,n){this.gl=t,this._ext=e,this.handle=n,this._attribs=[],this._useElements=!1,this._elementsType=t.UNSIGNED_SHORT}function i(t,e){return new a(t,e,e.createVertexArrayOES())}var o=t("./do-bind.js");r.prototype.bind=function(t){switch(this.dimension){case 1:t.vertexAttrib1f(this.location,this.a);break;case 2:t.vertexAttrib2f(this.location,this.a,this.b);break;case 3:t.vertexAttrib3f(this.location,this.a,this.b,this.c);break;case 4:t.vertexAttrib4f(this.location,this.a,this.b,this.c,this.d)}},a.prototype.bind=function(){this._ext.bindVertexArrayOES(this.handle);for(var t=0;t<this._attribs.length;++t)this._attribs[t].bind(this.gl)},a.prototype.unbind=function(){this._ext.bindVertexArrayOES(null)},a.prototype.dispose=function(){this._ext.deleteVertexArrayOES(this.handle)},a.prototype.update=function(t,e,n){if(this.bind(),o(this.gl,e,t),this.unbind(),this._attribs.length=0,t)for(var a=0;a<t.length;++a){var i=t[a];"number"==typeof i?this._attribs.push(new r(a,1,i)):Array.isArray(i)&&this._attribs.push(new r(a,i.length,i[0],i[1],i[2],i[3]))}this._useElements=!!e,this._elementsType=n||this.gl.UNSIGNED_SHORT},a.prototype.draw=function(t,e,n){n=n||0;var r=this.gl;this._useElements?r.drawElements(t,e,this._elementsType,n):r.drawArrays(t,n,e)},e.exports=i},{"./do-bind.js":44}],47:[function(t,e,n){"use strict";function r(t){this.bindVertexArrayOES=t.bindVertexArray.bind(t),this.createVertexArrayOES=t.createVertexArray.bind(t),this.deleteVertexArrayOES=t.deleteVertexArray.bind(t)}function a(t,e,n,a){var s,u=t.createVertexArray?new r(t):t.getExtension("OES_vertex_array_object");return s=u?i(t,u):o(t),s.update(e,n,a),s}var i=t("./lib/vao-native.js"),o=t("./lib/vao-emulated.js");e.exports=a},{"./lib/vao-emulated.js":45,"./lib/vao-native.js":46}],48:[function(t,e,n){(function(t){"undefined"!=typeof window?e.exports=window:"undefined"!=typeof t?e.exports=t:e.exports={}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],49:[function(t,e,n){function r(t){for(var e=Array.isArray(t)?t:a(t),n=0;n<e.length;n++){var r=e[n];if("preprocessor"===r.type){var o=r.data.match(/\#define\s+SHADER_NAME(_B64)?\s+(.+)$/);if(o&&o[2]){var s=o[1],u=o[2];return(s?i(u):u).trim()}}}}var a=t("glsl-tokenizer"),i=t("atob-lite");e.exports=r},{"atob-lite":6,"glsl-tokenizer":56}],50:[function(t,e,n){function r(t){function e(t){t.length&&V.push({type:E[k],data:t,position:H,line:q,column:Y})}function n(t){U=0,W+=t,j=W.length;for(var e;C=W[U],U<j;){switch(e=U,k){case f:U=T();break;case h:U=S();break;case d:U=A();break;case p:U=R();break;case g:U=N();break;case w:U=F();break;case m:U=L();break;case c:U=P();break;case b:U=I();break;case l:U=M()}if(e!==U)switch(W[e]){case"\n":Y=0,++q;break;default:++Y}}return z+=U,W=W.slice(U),V}function r(t){return B.length&&e(B.join("")),k=x,e("(eof)"),V}function M(){return B=B.length?[]:B,"/"===O&&"*"===C?(H=z+U-1,k=f,O=C,U+1):"/"===O&&"/"===C?(H=z+U-1,k=h,O=C,U+1):"#"===C?(k=d,H=z+U,U):/\s/.test(C)?(k=b,H=z+U,U):(G=/\d/.test(C),X=/[^\w_]/.test(C),H=z+U,k=G?g:X?p:c,U)}function I(){return/[^\s]/g.test(C)?(e(B.join("")),k=l,U):(B.push(C),O=C,U+1)}function A(){return"\r"!==C&&"\n"!==C||"\\"===O?(B.push(C),O=C,U+1):(e(B.join("")),k=l,U)}function S(){return A()}function T(){return"/"===C&&"*"===O?(B.push(C),e(B.join("")),k=l,U+1):(B.push(C),O=C,U+1)}function R(){if("."===O&&/\d/.test(C))return k=m,U;if("/"===O&&"*"===C)return k=f,U;if("/"===O&&"/"===C)return k=h,U;if("."===C&&B.length){for(;D(B););return k=m,U}if(";"===C||")"===C||"("===C){if(B.length)for(;D(B););return e(C),k=l,U+1}var t=2===B.length&&"="!==C;if(/[\w_\d\s]/.test(C)||t){for(;D(B););return k=l,U}return B.push(C),O=C,U+1}function D(t){for(var n,r,a=0;;){if(n=i.indexOf(t.slice(0,t.length+a).join("")),r=i[n],n===-1){if(a--+t.length>0)continue;r=t.slice(0,1).join("")}return e(r),H+=r.length,B=B.slice(r.length),B.length}}function F(){return/[^a-fA-F0-9]/.test(C)?(e(B.join("")),k=l,U):(B.push(C),O=C,U+1)}function N(){return"."===C?(B.push(C),k=m,O=C,U+1):/[eE]/.test(C)?(B.push(C),k=m,O=C,U+1):"x"===C&&1===B.length&&"0"===B[0]?(k=w,B.push(C),O=C,U+1):/[^\d]/.test(C)?(e(B.join("")),k=l,U):(B.push(C),O=C,U+1)}function L(){return"f"===C&&(B.push(C),O=C,U+=1),/[eE]/.test(C)?(B.push(C),O=C,U+1):"-"===C&&/[eE]/.test(O)?(B.push(C),O=C,U+1):/[^\d]/.test(C)?(e(B.join("")),k=l,U):(B.push(C),O=C,U+1)}function P(){if(/[^\d\w_]/.test(C)){var t=B.join("");return k=Q.indexOf(t)>-1?_:Z.indexOf(t)>-1?y:v,e(B.join("")),k=l,U}return B.push(C),O=C,U+1}var C,O,j,U=0,z=0,k=l,B=[],V=[],q=1,Y=0,H=0,G=!1,X=!1,W="";t=t||{};var Z=o,Q=a;return"300 es"===t.version&&(Z=u,Q=s),function(t){return V=[],null!==t?n(t.replace?t.replace(/\r\n/g,"\n"):t):r()}}e.exports=r;var a=t("./lib/literals"),i=t("./lib/operators"),o=t("./lib/builtins"),s=t("./lib/literals-300es"),u=t("./lib/builtins-300es"),l=999,c=9999,f=0,h=1,d=2,p=3,g=4,m=5,v=6,y=7,_=8,b=9,x=10,w=11,E=["block-comment","line-comment","preprocessor","operator","integer","float","ident","builtin","keyword","whitespace","eof","integer"]},{"./lib/builtins":52,"./lib/builtins-300es":51,"./lib/literals":54,"./lib/literals-300es":53,"./lib/operators":55}],51:[function(t,e,n){var r=t("./builtins");r=r.slice().filter(function(t){return!/^(gl\_|texture)/.test(t)}),e.exports=r.concat(["gl_VertexID","gl_InstanceID","gl_Position","gl_PointSize","gl_FragCoord","gl_FrontFacing","gl_FragDepth","gl_PointCoord","gl_MaxVertexAttribs","gl_MaxVertexUniformVectors","gl_MaxVertexOutputVectors","gl_MaxFragmentInputVectors","gl_MaxVertexTextureImageUnits","gl_MaxCombinedTextureImageUnits","gl_MaxTextureImageUnits","gl_MaxFragmentUniformVectors","gl_MaxDrawBuffers","gl_MinProgramTexelOffset","gl_MaxProgramTexelOffset","gl_DepthRangeParameters","gl_DepthRange","trunc","round","roundEven","isnan","isinf","floatBitsToInt","floatBitsToUint","intBitsToFloat","uintBitsToFloat","packSnorm2x16","unpackSnorm2x16","packUnorm2x16","unpackUnorm2x16","packHalf2x16","unpackHalf2x16","outerProduct","transpose","determinant","inverse","texture","textureSize","textureProj","textureLod","textureOffset","texelFetch","texelFetchOffset","textureProjOffset","textureLodOffset","textureProjLod","textureProjLodOffset","textureGrad","textureGradOffset","textureProjGrad","textureProjGradOffset"])},{"./builtins":52}],52:[function(t,e,n){e.exports=["abs","acos","all","any","asin","atan","ceil","clamp","cos","cross","dFdx","dFdy","degrees","distance","dot","equal","exp","exp2","faceforward","floor","fract","gl_BackColor","gl_BackLightModelProduct","gl_BackLightProduct","gl_BackMaterial","gl_BackSecondaryColor","gl_ClipPlane","gl_ClipVertex","gl_Color","gl_DepthRange","gl_DepthRangeParameters","gl_EyePlaneQ","gl_EyePlaneR","gl_EyePlaneS","gl_EyePlaneT","gl_Fog","gl_FogCoord","gl_FogFragCoord","gl_FogParameters","gl_FragColor","gl_FragCoord","gl_FragData","gl_FragDepth","gl_FragDepthEXT","gl_FrontColor","gl_FrontFacing","gl_FrontLightModelProduct","gl_FrontLightProduct","gl_FrontMaterial","gl_FrontSecondaryColor","gl_LightModel","gl_LightModelParameters","gl_LightModelProducts","gl_LightProducts","gl_LightSource","gl_LightSourceParameters","gl_MaterialParameters","gl_MaxClipPlanes","gl_MaxCombinedTextureImageUnits","gl_MaxDrawBuffers","gl_MaxFragmentUniformComponents","gl_MaxLights","gl_MaxTextureCoords","gl_MaxTextureImageUnits","gl_MaxTextureUnits","gl_MaxVaryingFloats","gl_MaxVertexAttribs","gl_MaxVertexTextureImageUnits","gl_MaxVertexUniformComponents","gl_ModelViewMatrix","gl_ModelViewMatrixInverse","gl_ModelViewMatrixInverseTranspose","gl_ModelViewMatrixTranspose","gl_ModelViewProjectionMatrix","gl_ModelViewProjectionMatrixInverse","gl_ModelViewProjectionMatrixInverseTranspose","gl_ModelViewProjectionMatrixTranspose","gl_MultiTexCoord0","gl_MultiTexCoord1","gl_MultiTexCoord2","gl_MultiTexCoord3","gl_MultiTexCoord4","gl_MultiTexCoord5","gl_MultiTexCoord6","gl_MultiTexCoord7","gl_Normal","gl_NormalMatrix","gl_NormalScale","gl_ObjectPlaneQ","gl_ObjectPlaneR","gl_ObjectPlaneS","gl_ObjectPlaneT","gl_Point","gl_PointCoord","gl_PointParameters","gl_PointSize","gl_Position","gl_ProjectionMatrix","gl_ProjectionMatrixInverse","gl_ProjectionMatrixInverseTranspose","gl_ProjectionMatrixTranspose","gl_SecondaryColor","gl_TexCoord","gl_TextureEnvColor","gl_TextureMatrix","gl_TextureMatrixInverse","gl_TextureMatrixInverseTranspose","gl_TextureMatrixTranspose","gl_Vertex","greaterThan","greaterThanEqual","inversesqrt","length","lessThan","lessThanEqual","log","log2","matrixCompMult","max","min","mix","mod","normalize","not","notEqual","pow","radians","reflect","refract","sign","sin","smoothstep","sqrt","step","tan","texture2D","texture2DLod","texture2DProj","texture2DProjLod","textureCube","textureCubeLod","texture2DLodEXT","texture2DProjLodEXT","textureCubeLodEXT","texture2DGradEXT","texture2DProjGradEXT","textureCubeGradEXT"]},{}],53:[function(t,e,n){var r=t("./literals");e.exports=r.slice().concat(["layout","centroid","smooth","case","mat2x2","mat2x3","mat2x4","mat3x2","mat3x3","mat3x4","mat4x2","mat4x3","mat4x4","uint","uvec2","uvec3","uvec4","samplerCubeShadow","sampler2DArray","sampler2DArrayShadow","isampler2D","isampler3D","isamplerCube","isampler2DArray","usampler2D","usampler3D","usamplerCube","usampler2DArray","coherent","restrict","readonly","writeonly","resource","atomic_uint","noperspective","patch","sample","subroutine","common","partition","active","filter","image1D","image2D","image3D","imageCube","iimage1D","iimage2D","iimage3D","iimageCube","uimage1D","uimage2D","uimage3D","uimageCube","image1DArray","image2DArray","iimage1DArray","iimage2DArray","uimage1DArray","uimage2DArray","image1DShadow","image2DShadow","image1DArrayShadow","image2DArrayShadow","imageBuffer","iimageBuffer","uimageBuffer","sampler1DArray","sampler1DArrayShadow","isampler1D","isampler1DArray","usampler1D","usampler1DArray","isampler2DRect","usampler2DRect","samplerBuffer","isamplerBuffer","usamplerBuffer","sampler2DMS","isampler2DMS","usampler2DMS","sampler2DMSArray","isampler2DMSArray","usampler2DMSArray"])},{"./literals":54}],54:[function(t,e,n){e.exports=["precision","highp","mediump","lowp","attribute","const","uniform","varying","break","continue","do","for","while","if","else","in","out","inout","float","int","void","bool","true","false","discard","return","mat2","mat3","mat4","vec2","vec3","vec4","ivec2","ivec3","ivec4","bvec2","bvec3","bvec4","sampler1D","sampler2D","sampler3D","samplerCube","sampler1DShadow","sampler2DShadow","struct","asm","class","union","enum","typedef","template","this","packed","goto","switch","default","inline","noinline","volatile","public","static","extern","external","interface","long","short","double","half","fixed","unsigned","input","output","hvec2","hvec3","hvec4","dvec2","dvec3","dvec4","fvec2","fvec3","fvec4","sampler2DRect","sampler3DRect","sampler2DRectShadow","sizeof","cast","namespace","using"]},{}],55:[function(t,e,n){e.exports=["<<=",">>=","++","--","<<",">>","<=",">=","==","!=","&&","||","+=","-=","*=","/=","%=","&=","^^","^=","|=","(",")","[","]",".","!","~","*","/","%","+","-","<",">","&","^","|","?",":","=",",",";","{","}"]},{}],56:[function(t,e,n){function r(t,e){var n=a(e),r=[];return r=r.concat(n(t)),r=r.concat(n(null))}var a=t("./index");e.exports=r},{"./index":50}],57:[function(t,e,n){e.exports=function(t){"string"==typeof t&&(t=[t]);for(var e=[].slice.call(arguments,1),n=[],r=0;r<t.length-1;r++)n.push(t[r],e[r]||"");return n.push(t[r]),n.join("")}},{}],58:[function(t,e,n){function r(t){var e=i(t);return'<link href="'+e+'" rel="stylesheet" type="text/css">'}function a(t){var e=i(t),n=document.createElement("link");return n.setAttribute("href",e),n.setAttribute("rel","stylesheet"),n.setAttribute("type","text/css"),n}function i(t){var e=Object.keys(t).map(function(e){var n=t[e];return e=e.replace(/\s+/,"+"),"boolean"==typeof n?e:e+":"+s(n).join(",")}).join("|");return"http://fonts.googleapis.com/css?family="+e}function o(t){var e=a(t);return document.head.appendChild(e),e}function s(t){return Array.isArray(t)?t:[t]}e.exports=r,e.exports.add=o},{}],59:[function(t,e,n){n.read=function(t,e,n,r,a){var i,o,s=8*a-r-1,u=(1<<s)-1,l=u>>1,c=-7,f=n?a-1:0,h=n?-1:1,d=t[e+f];for(f+=h,i=d&(1<<-c)-1,d>>=-c,c+=s;c>0;i=256*i+t[e+f],f+=h,c-=8);for(o=i&(1<<-c)-1,i>>=-c,c+=r;c>0;o=256*o+t[e+f],f+=h,c-=8);if(0===i)i=1-l;else{if(i===u)return o?NaN:(d?-1:1)*(1/0);o+=Math.pow(2,r),i-=l}return(d?-1:1)*o*Math.pow(2,i-r)},n.write=function(t,e,n,r,a,i){var o,s,u,l=8*i-a-1,c=(1<<l)-1,f=c>>1,h=23===a?Math.pow(2,-24)-Math.pow(2,-77):0,d=r?0:i-1,p=r?1:-1,g=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,o=c):(o=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-o))<1&&(o--,u*=2),e+=o+f>=1?h/u:h*Math.pow(2,1-f),e*u>=2&&(o++,u/=2),o+f>=c?(s=0,o=c):o+f>=1?(s=(e*u-1)*Math.pow(2,a),o+=f):(s=e*Math.pow(2,f-1)*Math.pow(2,a),o=0));a>=8;t[n+d]=255&s,d+=p,s/=256,a-=8);for(o=o<<a|s,l+=a;l>0;t[n+d]=255&o,d+=p,o/=256,l-=8);t[n+d-p]|=128*g}},{}],60:[function(t,e,n){var r=[];e.exports=function(t){if(!(r.indexOf(t)>=0)){r.push(t);var e=document.createElement("style"),n=document.createTextNode(t);e.appendChild(n),document.head.childNodes.length?document.head.insertBefore(e,document.head.childNodes[0]):document.head.appendChild(e)}}},{}],61:[function(t,e,n){"use strict";function r(t){for(var e=new Array(t),n=0;n<t;++n)e[n]=n;return e}e.exports=r},{}],62:[function(t,e,n){function r(t){return!!t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)}function a(t){return"function"==typeof t.readFloatLE&&"function"==typeof t.slice&&r(t.slice(0,0))}e.exports=function(t){return null!=t&&(r(t)||a(t)||!!t._isBuffer)}},{}],63:[function(t,e,n){function r(t,e){e=e||{};var n=a(t);return n(e)}function a(t){for(var e,n=[],r=o(t),a=0;a<r.length;++a)if(e=r[a],a%2==0)n.push('"'+e.replace(/"/g,'\\"')+'"');else switch(e[0]){case"/":e=e.slice(1),n.push(") + ");break;case"^":e=e.slice(1),i(e),n.push(' + section(obj, "'+e+'", true, ');break;case"#":e=e.slice(1),i(e),n.push(' + section(obj, "'+e+'", false, ');break;case"!":e=e.slice(1),i(e),n.push(" + obj."+e+" + ");break;default:i(e),n.push(" + escape(obj."+e+") + ")}return n="\n"+s(l.toString())+";\n\n"+s(u.toString())+";\n\n  return "+n.join("").replace(/\n/g,"\\n"),new Function("obj",n)}function i(t){if(!t.match(/^[\w.]+$/))throw new Error('invalid property "'+t+'"')}function o(t){return t.split(/\{\{|\}\}/)}function s(t){return t.replace(/^/gm,"  ")}function u(t,e,n,r){var a=t[e];return"function"==typeof a?a.call(t,r):(n&&(a=!a),a?r:"")}function l(t){return String(t).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}n=e.exports=r,n.compile=a},{}],64:[function(t,e,n){"use strict";function r(t){if(!t)return s;for(var e=0;e<t.args.length;++e){var n=t.args[e];0===e?t.args[e]={name:n,lvalue:!0,rvalue:!!t.rvalue,count:t.count||1}:t.args[e]={name:n,lvalue:!1,rvalue:!0,count:1}}return t.thisVars||(t.thisVars=[]),t.localVars||(t.localVars=[]),t}function a(t){return o({args:t.args,pre:r(t.pre),body:r(t.body),post:r(t.proc),funcName:t.funcName})}function i(t){for(var e=[],n=0;n<t.args.length;++n)e.push("a"+n);var r=new Function("P",["return function ",t.funcName,"_ndarrayops(",e.join(","),") {P(",e.join(","),");return a0}"].join(""));return r(a(t))}var o=t("cwise-compiler"),s={body:"",args:[],thisVars:[],localVars:[]},u={add:"+",sub:"-",mul:"*",div:"/",mod:"%",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"};!function(){for(var t in u){var e=u[t];n[t]=i({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+e+"c"},funcName:t}),n[t+"eq"]=i({args:["array","array"],body:{args:["a","b"],body:"a"+e+"=b"},rvalue:!0,funcName:t+"eq"}),n[t+"s"]=i({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+e+"s"},funcName:t+"s"}),n[t+"seq"]=i({args:["array","scalar"],body:{args:["a","s"],body:"a"+e+"=s"},rvalue:!0,funcName:t+"seq"})}}();var l={not:"!",bnot:"~",neg:"-",recip:"1.0/"};!function(){for(var t in l){var e=l[t];n[t]=i({args:["array","array"],body:{args:["a","b"],body:"a="+e+"b"},funcName:t}),n[t+"eq"]=i({args:["array"],body:{args:["a"],body:"a="+e+"a"},rvalue:!0,count:2,funcName:t+"eq"})}}();var c={and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">="};!function(){for(var t in c){var e=c[t];n[t]=i({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+e+"c"},funcName:t}),n[t+"s"]=i({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+e+"s"},funcName:t+"s"}),n[t+"eq"]=i({args:["array","array"],body:{args:["a","b"],body:"a=a"+e+"b"},rvalue:!0,count:2,funcName:t+"eq"}),n[t+"seq"]=i({args:["array","scalar"],body:{args:["a","s"],body:"a=a"+e+"s"},rvalue:!0,count:2,funcName:t+"seq"})}}();var f=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan"];!function(){for(var t=0;t<f.length;++t){var e=f[t];n[e]=i({args:["array","array"],pre:{args:[],body:"this_f=Math."+e,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b)",thisVars:["this_f"]},funcName:e}),n[e+"eq"]=i({args:["array"],pre:{args:[],body:"this_f=Math."+e,thisVars:["this_f"]},body:{args:["a"],body:"a=this_f(a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:e+"eq"})}}();var h=["max","min","atan2","pow"];!function(){for(var t=0;t<h.length;++t){var e=h[t];n[e]=i({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+e,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:e}),n[e+"s"]=i({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+e,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:e+"s"}),n[e+"eq"]=i({args:["array","array"],pre:{args:[],body:"this_f=Math."+e,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:e+"eq"}),n[e+"seq"]=i({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+e,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:e+"seq"})}}();var d=["atan2","pow"];!function(){for(var t=0;t<d.length;++t){var e=d[t];n[e+"op"]=i({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+e,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:e+"op"}),n[e+"ops"]=i({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+e,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:e+"ops"}),n[e+"opeq"]=i({args:["array","array"],pre:{args:[],body:"this_f=Math."+e,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:e+"opeq"}),n[e+"opseq"]=i({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+e,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:e+"opseq"})}}(),n.any=o({args:["array"],pre:s,body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"if(a){return true}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return false"},funcName:"any"}),n.all=o({args:["array"],pre:s,body:{args:[{name:"x",lvalue:!1,rvalue:!0,count:1}],body:"if(!x){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"all"}),n.sum=o({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"this_s+=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"sum"}),n.prod=o({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=1"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"this_s*=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"prod"}),n.norm2squared=o({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm2squared"}),n.norm2=o({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return Math.sqrt(this_s)"},funcName:"norm2"}),n.norminf=o({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:4}],body:"if(-a>this_s){this_s=-a}else if(a>this_s){this_s=a}",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norminf"}),n.norm1=o({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:3}],body:"this_s+=a<0?-a:a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm1"}),n.sup=o({args:["array"],pre:{body:"this_h=-Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_>this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}}),n.inf=o({args:["array"],pre:{body:"this_h=Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_<this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}}),n.argmin=o({args:["index","array","shape"],pre:{body:"{this_v=Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg2_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{
body:"{if(_inline_1_arg1_<this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}}),n.argmax=o({args:["index","array","shape"],pre:{body:"{this_v=-Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg2_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_>this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}}),n.random=i({args:["array"],pre:{args:[],body:"this_f=Math.random",thisVars:["this_f"]},body:{args:["a"],body:"a=this_f()",thisVars:["this_f"]},funcName:"random"}),n.assign=i({args:["array","array"],body:{args:["a","b"],body:"a=b"},funcName:"assign"}),n.assigns=i({args:["array","scalar"],body:{args:["a","b"],body:"a=b"},funcName:"assigns"}),n.equals=o({args:["array","array"],pre:s,body:{args:[{name:"x",lvalue:!1,rvalue:!0,count:1},{name:"y",lvalue:!1,rvalue:!0,count:1}],body:"if(x!==y){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"equals"})},{"cwise-compiler":13}],65:[function(t,e,n){function r(t,e){return t[0]-e[0]}function a(){var t,e=this.stride,n=new Array(e.length);for(t=0;t<n.length;++t)n[t]=[Math.abs(e[t]),t];n.sort(r);var a=new Array(n.length);for(t=0;t<a.length;++t)a[t]=n[t][1];return a}function i(t,e){var n=["View",e,"d",t].join("");e<0&&(n="View_Nil"+t);var r="generic"===t;if(e===-1){var i="function "+n+"(a){this.data=a;};var proto="+n+".prototype;proto.dtype='"+t+"';proto.index=function(){return -1};proto.size=0;proto.dimension=-1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function(){return new "+n+"(this.data);};proto.get=proto.set=function(){};proto.pick=function(){return null};return function construct_"+n+"(a){return new "+n+"(a);}",o=new Function(i);return o()}if(0===e){var i="function "+n+"(a,d) {this.data = a;this.offset = d};var proto="+n+".prototype;proto.dtype='"+t+"';proto.index=function(){return this.offset};proto.dimension=0;proto.size=1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function "+n+"_copy() {return new "+n+"(this.data,this.offset)};proto.pick=function "+n+"_pick(){return TrivialArray(this.data);};proto.valueOf=proto.get=function "+n+"_get(){return "+(r?"this.data.get(this.offset)":"this.data[this.offset]")+"};proto.set=function "+n+"_set(v){return "+(r?"this.data.set(this.offset,v)":"this.data[this.offset]=v")+"};return function construct_"+n+"(a,b,c,d){return new "+n+"(a,d)}",o=new Function("TrivialArray",i);return o(f[t][0])}var i=["'use strict'"],s=u(e),l=s.map(function(t){return"i"+t}),c="this.offset+"+s.map(function(t){return"this.stride["+t+"]*i"+t}).join("+"),h=s.map(function(t){return"b"+t}).join(","),d=s.map(function(t){return"c"+t}).join(",");i.push("function "+n+"(a,"+h+","+d+",d){this.data=a","this.shape=["+h+"]","this.stride=["+d+"]","this.offset=d|0}","var proto="+n+".prototype","proto.dtype='"+t+"'","proto.dimension="+e),i.push("Object.defineProperty(proto,'size',{get:function "+n+"_size(){return "+s.map(function(t){return"this.shape["+t+"]"}).join("*"),"}})"),1===e?i.push("proto.order=[0]"):(i.push("Object.defineProperty(proto,'order',{get:"),e<4?(i.push("function "+n+"_order(){"),2===e?i.push("return (Math.abs(this.stride[0])>Math.abs(this.stride[1]))?[1,0]:[0,1]}})"):3===e&&i.push("var s0=Math.abs(this.stride[0]),s1=Math.abs(this.stride[1]),s2=Math.abs(this.stride[2]);if(s0>s1){if(s1>s2){return [2,1,0];}else if(s0>s2){return [1,2,0];}else{return [1,0,2];}}else if(s0>s2){return [2,0,1];}else if(s2>s1){return [0,1,2];}else{return [0,2,1];}}})")):i.push("ORDER})")),i.push("proto.set=function "+n+"_set("+l.join(",")+",v){"),r?i.push("return this.data.set("+c+",v)}"):i.push("return this.data["+c+"]=v}"),i.push("proto.get=function "+n+"_get("+l.join(",")+"){"),r?i.push("return this.data.get("+c+")}"):i.push("return this.data["+c+"]}"),i.push("proto.index=function "+n+"_index(",l.join(),"){return "+c+"}"),i.push("proto.hi=function "+n+"_hi("+l.join(",")+"){return new "+n+"(this.data,"+s.map(function(t){return["(typeof i",t,"!=='number'||i",t,"<0)?this.shape[",t,"]:i",t,"|0"].join("")}).join(",")+","+s.map(function(t){return"this.stride["+t+"]"}).join(",")+",this.offset)}");var p=s.map(function(t){return"a"+t+"=this.shape["+t+"]"}),g=s.map(function(t){return"c"+t+"=this.stride["+t+"]"});i.push("proto.lo=function "+n+"_lo("+l.join(",")+"){var b=this.offset,d=0,"+p.join(",")+","+g.join(","));for(var m=0;m<e;++m)i.push("if(typeof i"+m+"==='number'&&i"+m+">=0){d=i"+m+"|0;b+=c"+m+"*d;a"+m+"-=d}");i.push("return new "+n+"(this.data,"+s.map(function(t){return"a"+t}).join(",")+","+s.map(function(t){return"c"+t}).join(",")+",b)}"),i.push("proto.step=function "+n+"_step("+l.join(",")+"){var "+s.map(function(t){return"a"+t+"=this.shape["+t+"]"}).join(",")+","+s.map(function(t){return"b"+t+"=this.stride["+t+"]"}).join(",")+",c=this.offset,d=0,ceil=Math.ceil");for(var m=0;m<e;++m)i.push("if(typeof i"+m+"==='number'){d=i"+m+"|0;if(d<0){c+=b"+m+"*(a"+m+"-1);a"+m+"=ceil(-a"+m+"/d)}else{a"+m+"=ceil(a"+m+"/d)}b"+m+"*=d}");i.push("return new "+n+"(this.data,"+s.map(function(t){return"a"+t}).join(",")+","+s.map(function(t){return"b"+t}).join(",")+",c)}");for(var v=new Array(e),y=new Array(e),m=0;m<e;++m)v[m]="a[i"+m+"]",y[m]="b[i"+m+"]";i.push("proto.transpose=function "+n+"_transpose("+l+"){"+l.map(function(t,e){return t+"=("+t+"===undefined?"+e+":"+t+"|0)"}).join(";"),"var a=this.shape,b=this.stride;return new "+n+"(this.data,"+v.join(",")+","+y.join(",")+",this.offset)}"),i.push("proto.pick=function "+n+"_pick("+l+"){var a=[],b=[],c=this.offset");for(var m=0;m<e;++m)i.push("if(typeof i"+m+"==='number'&&i"+m+">=0){c=(c+this.stride["+m+"]*i"+m+")|0}else{a.push(this.shape["+m+"]);b.push(this.stride["+m+"])}");i.push("var ctor=CTOR_LIST[a.length+1];return ctor(this.data,a,b,c)}"),i.push("return function construct_"+n+"(data,shape,stride,offset){return new "+n+"(data,"+s.map(function(t){return"shape["+t+"]"}).join(",")+","+s.map(function(t){return"stride["+t+"]"}).join(",")+",offset)}");var o=new Function("CTOR_LIST","ORDER",i.join("\n"));return o(f[t],a)}function o(t){if(l(t))return"buffer";if(c)switch(Object.prototype.toString.call(t)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object Uint8ClampedArray]":return"uint8_clamped"}return Array.isArray(t)?"array":"generic"}function s(t,e,n,r){if(void 0===t){var a=f.array[0];return a([])}"number"==typeof t&&(t=[t]),void 0===e&&(e=[t.length]);var s=e.length;if(void 0===n){n=new Array(s);for(var u=s-1,l=1;u>=0;--u)n[u]=l,l*=e[u]}if(void 0===r){r=0;for(var u=0;u<s;++u)n[u]<0&&(r-=(e[u]-1)*n[u])}for(var c=o(t),h=f[c];h.length<=s+1;)h.push(i(c,h.length-1));var a=h[s+1];return a(t,e,n,r)}var u=t("iota-array"),l=t("is-buffer"),c="undefined"!=typeof Float64Array,f={float32:[],float64:[],int8:[],int16:[],int32:[],uint8:[],uint16:[],uint32:[],array:[],uint8_clamped:[],buffer:[],generic:[]};e.exports=s},{"iota-array":61,"is-buffer":62}],66:[function(t,e,n){"use strict";function r(t){if(null===t||void 0===t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}function a(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},n=0;n<10;n++)e["_"+String.fromCharCode(n)]=n;var r=Object.getOwnPropertyNames(e).map(function(t){return e[t]});if("0123456789"!==r.join(""))return!1;var a={};return"abcdefghijklmnopqrst".split("").forEach(function(t){a[t]=t}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},a)).join("")}catch(t){return!1}}var i=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable;e.exports=a()?Object.assign:function(t,e){for(var n,a,s=r(t),u=1;u<arguments.length;u++){n=Object(arguments[u]);for(var l in n)i.call(n,l)&&(s[l]=n[l]);if(Object.getOwnPropertySymbols){a=Object.getOwnPropertySymbols(n);for(var c=0;c<a.length;c++)o.call(n,a[c])&&(s[a[c]]=n[a[c]])}}return s}},{}],67:[function(t,e,n){"use strict";var r=t("repeat-string");e.exports=function(t,e,n){return n="undefined"!=typeof n?n+"":" ",r(n,e)+t}},{"repeat-string":73}],68:[function(t,e,n){function r(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function i(t){if(f===setTimeout)return setTimeout(t,0);if((f===r||!f)&&setTimeout)return f=setTimeout,setTimeout(t,0);try{return f(t,0)}catch(e){try{return f.call(null,t,0)}catch(e){return f.call(this,t,0)}}}function o(t){if(h===clearTimeout)return clearTimeout(t);if((h===a||!h)&&clearTimeout)return h=clearTimeout,clearTimeout(t);try{return h(t)}catch(e){try{return h.call(null,t)}catch(e){return h.call(this,t)}}}function s(){m&&p&&(m=!1,p.length?g=p.concat(g):v=-1,g.length&&u())}function u(){if(!m){var t=i(s);m=!0;for(var e=g.length;e;){for(p=g,g=[];++v<e;)p&&p[v].run();v=-1,e=g.length}p=null,m=!1,o(t)}}function l(t,e){this.fun=t,this.array=e}function c(){}var f,h,d=e.exports={};!function(){try{f="function"==typeof setTimeout?setTimeout:r}catch(t){f=r}try{h="function"==typeof clearTimeout?clearTimeout:a}catch(t){h=a}}();var p,g=[],m=!1,v=-1;d.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];g.push(new l(t,e)),1!==g.length||m||i(u)},l.prototype.run=function(){this.fun.apply(null,this.array)},d.title="browser",d.browser=!0,d.env={},d.argv=[],d.version="",d.versions={},d.on=c,d.addListener=c,d.once=c,d.off=c,d.removeListener=c,d.removeAllListeners=c,d.emit=c,d.binding=function(t){throw new Error("process.binding is not supported")},d.cwd=function(){return"/"},d.chdir=function(t){throw new Error("process.chdir is not supported")},d.umask=function(){return 0}},{}],69:[function(t,e,n){"use strict";function r(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.exports=function(t,e,n,i){e=e||"&",n=n||"=";var o={};if("string"!=typeof t||0===t.length)return o;var s=/\+/g;t=t.split(e);var u=1e3;i&&"number"==typeof i.maxKeys&&(u=i.maxKeys);var l=t.length;u>0&&l>u&&(l=u);for(var c=0;c<l;++c){var f,h,d,p,g=t[c].replace(s,"%20"),m=g.indexOf(n);m>=0?(f=g.substr(0,m),h=g.substr(m+1)):(f=g,h=""),d=decodeURIComponent(f),p=decodeURIComponent(h),r(o,d)?a(o[d])?o[d].push(p):o[d]=[o[d],p]:o[d]=p}return o};var a=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}},{}],70:[function(t,e,n){"use strict";function r(t,e){if(t.map)return t.map(e);for(var n=[],r=0;r<t.length;r++)n.push(e(t[r],r));return n}var a=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}};e.exports=function(t,e,n,s){return e=e||"&",n=n||"=",null===t&&(t=void 0),"object"==typeof t?r(o(t),function(o){var s=encodeURIComponent(a(o))+n;return i(t[o])?r(t[o],function(t){return s+encodeURIComponent(a(t))}).join(e):s+encodeURIComponent(a(t[o]))}).join(e):s?encodeURIComponent(a(s))+n+encodeURIComponent(a(t)):""};var i=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},o=Object.keys||function(t){var e=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.push(n);return e}},{}],71:[function(t,e,n){"use strict";n.decode=n.parse=t("./decode"),n.encode=n.stringify=t("./encode")},{"./decode":69,"./encode":70}],72:[function(t,e,n){function r(t){var e=(new Date).getTime(),n=Math.max(0,16-(e-a)),r=setTimeout(t,n);return a=e,r}n=e.exports=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||r;var a=(new Date).getTime(),i=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.oCancelAnimationFrame||window.msCancelAnimationFrame||window.clearTimeout;n.cancel=function(t){i.call(window,t)}},{}],73:[function(t,e,n){"use strict";function r(t,e){if("string"!=typeof t)throw new TypeError("expected a string");if(1===e)return t;if(2===e)return t+t;var n=t.length*e;if(a!==t||"undefined"==typeof a)a=t,i="";else if(i.length>=n)return i.substr(0,n);for(;n>i.length&&e>1;)1&e&&(i+=t),e>>=1,t+=t;return i+=t,i=i.substr(0,n)}var a,i="";e.exports=r},{}],74:[function(t,e,n){function r(t){if(t)throw t}function a(t,e){c||(u(".npm-scb-wrap {\n  font-family: 'Open Sans', 'Helvetica Neue', Helvetica, Arial, sans-serif;\n  font-weight: 200;\n  position: absolute;\n  top: 0;\n  left: 0;\n  z-index: 999;\n}\n\n.npm-scb-wrap a {\n  text-decoration: none;\n  color: #000;\n}\n.npm-scb-white\n.npm-scb-wrap a {\n  color: #fff;\n}\n\n.npm-scb-inner {\n  position: absolute;\n  top: -120px; left: 0;\n  padding: 8px;\n  width: 100%;\n  height: 150px;\n  z-index: 2;\n  -webkit-transition: width 0.5s cubic-bezier(1, 0, 0, 1), top 0.5s;\n     -moz-transition: width 0.5s cubic-bezier(1, 0, 0, 1), top 0.5s;\n      -ms-transition: width 0.5s cubic-bezier(1, 0, 0, 1), top 0.5s;\n       -o-transition: width 0.5s cubic-bezier(1, 0, 0, 1), top 0.5s;\n          transition: width 0.5s cubic-bezier(1, 0, 0, 1), top 0.5s;\n}\n.npm-scb-wrap:hover\n.npm-scb-inner {\n  top: 0;\n}\n\n.npm-scb-artwork {\n  position: absolute;\n  top: 16px; left: 16px;\n  width: 104px; height: 104px;\n  box-shadow: 0 0 8px -3px #000;\n  outline: 1px solid rgba(0,0,0,0.1);\n  z-index: 2;\n}\n.npm-scb-white\n.npm-scb-artwork {\n  outline: 1px solid rgba(255,255,255,0.1);\n  box-shadow: 0 0 10px -2px rgba(255,255,255,0.9);\n}\n\n.npm-scb-info {\n  position: absolute;\n  top: 16px;\n  left: 120px;\n  width: 300px;\n  z-index: 1;\n}\n\n.npm-scb-info > a {\n  display: block;\n}\n\n.npm-scb-now-playing {\n  font-size: 12px;\n  line-height: 12px;\n  position: absolute;\n  width: 500px;\n  z-index: 1;\n  padding: 15px 0;\n  top: 0; left: 138px;\n  opacity: 1;\n  -webkit-transition: opacity 0.25s;\n     -moz-transition: opacity 0.25s;\n      -ms-transition: opacity 0.25s;\n       -o-transition: opacity 0.25s;\n          transition: opacity 0.25s;\n}\n\n.npm-scb-wrap:hover\n.npm-scb-now-playing {\n  opacity: 0;\n}\n\n.npm-scb-white\n.npm-scb-now-playing {\n  color: #fff;\n}\n.npm-scb-now-playing > a {\n  font-weight: bold;\n}\n\n.npm-scb-info > a > p {\n  margin: 0;\n  padding-bottom: 0.25em;\n  line-height: 1.35em;\n  margin-left: 1em;\n  font-size: 1em;\n}\n\n.npm-scb-title {\n  font-weight: bold;\n}\n\n.npm-scb-icon {\n  position: absolute;\n  top: 120px;\n  padding-top: 0.75em;\n  left: 16px;\n}\n"),c=!0),h||(h=s.compile('<div class="npm-scb-wrap">\n  <div class="npm-scb-inner">\n    <a target="_blank" href="{{!urls.song}}">\n      <img class="npm-scb-icon" src="{{!icon}}">\n      <img class="npm-scb-artwork" src="{{!artwork}}">\n    </a>\n    <div class="npm-scb-info">\n      <a target="_blank" href="{{!urls.song}}">\n        <p class="npm-scb-title">{{!title}}</p>\n      </a>\n      <a target="_blank" href="{{!urls.artist}}">\n        <p class="npm-scb-artist">{{!artist}}</p>\n      </a>\n    </div>\n  </div>\n  <div class="npm-scb-now-playing">\n    Now Playing:\n    <a href="{{!urls.song}}">{{!title}}</a>\n    by\n    <a href="{{!urls.artist}}">{{!artist}}</a>\n  </div>\n</div>')),!f&&t.getFonts&&(o.add({"Open Sans":[300,600]}),f=!0),t=t||{},e=e||r;var n=t.el||document.createElement("div"),a="dark"in t&&!t.dark?"white":"black",d=t.client_id,p=t.song;return i(d,p,function(t,r){if(t)return e(t);if("track"!==r.kind)throw new Error("soundcloud-badge only supports individual tracks at the moment");n.classList["black"===a?"remove":"add"]("npm-scb-white"),n.innerHTML=h({artwork:r.artwork_url||r.user.avatar_url,artist:r.user.username,title:r.title,icon:l[a],urls:{song:r.permalink_url,artist:r.user.permalink_url}}),document.body.appendChild(n),e(null,r.stream_url+"?client_id="+d,r,n)}),n}var i=t("soundcloud-resolve"),o=t("google-fonts"),s=t("minstache"),u=t("insert-css"),l=(t("fs"),{black:"https://developers.soundcloud.com/assets/logo_black.png",white:"https://developers.soundcloud.com/assets/logo_white.png"});e.exports=a;var c=!1,f=!1,h=null},{fs:9,"google-fonts":58,"insert-css":60,minstache:63,"soundcloud-resolve":75}],75:[function(t,e,n){function r(t,e,n){var r="https://api.soundcloud.com/resolve.json?"+a.stringify({url:e,client_id:t});i({uri:r,method:"GET"},function(e,r,a){if(e)return n(e);try{a=JSON.parse(a)}catch(t){return n(t)}if(a.errors)return n(new Error(a.errors[0].error_message));var i="track"===a.kind&&a.stream_url+"?client_id="+t;return n(null,a,i)})}var a=t("querystring"),i=t("xhr");e.exports=r},{querystring:71,xhr:85}],76:[function(e,n,r){!function(e){function n(){var t=arguments[0],e=n.cache;return e[t]&&e.hasOwnProperty(t)||(e[t]=n.parse(t)),n.format.call(null,e[t],arguments)}function a(t){return Object.prototype.toString.call(t).slice(8,-1).toLowerCase()}function i(t,e){return Array(e+1).join(t)}var o={not_string:/[^s]/,number:/[diefg]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijosuxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[\+\-]/};n.format=function(t,e){var r,s,u,l,c,f,h,d=1,p=t.length,g="",m=[],v=!0,y="";for(s=0;s<p;s++)if(g=a(t[s]),"string"===g)m[m.length]=t[s];else if("array"===g){if(l=t[s],l[2])for(r=e[d],u=0;u<l[2].length;u++){if(!r.hasOwnProperty(l[2][u]))throw new Error(n("[sprintf] property '%s' does not exist",l[2][u]));r=r[l[2][u]]}else r=l[1]?e[l[1]]:e[d++];if("function"==a(r)&&(r=r()),o.not_string.test(l[8])&&o.not_json.test(l[8])&&"number"!=a(r)&&isNaN(r))throw new TypeError(n("[sprintf] expecting number but found %s",a(r)));switch(o.number.test(l[8])&&(v=r>=0),l[8]){case"b":r=r.toString(2);break;case"c":r=String.fromCharCode(r);break;case"d":case"i":r=parseInt(r,10);break;case"j":r=JSON.stringify(r,null,l[6]?parseInt(l[6]):0);break;case"e":r=l[7]?r.toExponential(l[7]):r.toExponential();break;case"f":r=l[7]?parseFloat(r).toFixed(l[7]):parseFloat(r);break;case"g":r=l[7]?parseFloat(r).toPrecision(l[7]):parseFloat(r);break;case"o":r=r.toString(8);break;case"s":r=(r=String(r))&&l[7]?r.substring(0,l[7]):r;break;case"u":r>>>=0;break;case"x":r=r.toString(16);break;case"X":r=r.toString(16).toUpperCase()}o.json.test(l[8])?m[m.length]=r:(!o.number.test(l[8])||v&&!l[3]?y="":(y=v?"+":"-",r=r.toString().replace(o.sign,"")),f=l[4]?"0"===l[4]?"0":l[4].charAt(1):" ",h=l[6]-(y+r).length,c=l[6]&&h>0?i(f,h):"",m[m.length]=l[5]?y+r+c:"0"===f?y+c+r:c+y+r)}return m.join("")},n.cache={},n.parse=function(t){for(var e=t,n=[],r=[],a=0;e;){if(null!==(n=o.text.exec(e)))r[r.length]=n[0];else if(null!==(n=o.modulo.exec(e)))r[r.length]="%";else{if(null===(n=o.placeholder.exec(e)))throw new SyntaxError("[sprintf] unexpected placeholder");if(n[2]){a|=1;var i=[],s=n[2],u=[];if(null===(u=o.key.exec(s)))throw new SyntaxError("[sprintf] failed to parse named argument key");for(i[i.length]=u[1];""!==(s=s.substring(u[0].length));)if(null!==(u=o.key_access.exec(s)))i[i.length]=u[1];else{if(null===(u=o.index_access.exec(s)))throw new SyntaxError("[sprintf] failed to parse named argument key");i[i.length]=u[1]}n[2]=i}else a|=2;if(3===a)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");r[r.length]=n}e=e.substring(n[0].length)}return r};var s=function(t,e,r){return r=(e||[]).slice(0),r.splice(0,0,t),n.apply(null,r)};"undefined"!=typeof r?(r.sprintf=n,r.vsprintf=s):(e.sprintf=n,e.vsprintf=s,"function"==typeof t&&t.amd&&t(function(){return{sprintf:n,vsprintf:s}}))}("undefined"==typeof window?this:window)},{}],77:[function(e,n,r){(function(e){var a=a||function(){var t=[];return{getAll:function(){return t},removeAll:function(){t=[]},add:function(e){t.push(e)},remove:function(e){var n=t.indexOf(e);n!==-1&&t.splice(n,1)},update:function(e,n){if(0===t.length)return!1;var r=0;for(e=void 0!==e?e:a.now();r<t.length;)t[r].update(e)||n?r++:t.splice(r,1);return!0}}}();"undefined"==typeof window&&"undefined"!=typeof e?a.now=function(){var t=e.hrtime();return 1e3*t[0]+t[1]/1e6}:"undefined"!=typeof window&&void 0!==window.performance&&void 0!==window.performance.now?a.now=window.performance.now.bind(window.performance):void 0!==Date.now?a.now=Date.now:a.now=function(){return(new Date).getTime()},a.Tween=function(t){var e,n=t,r={},i={},o={},s=1e3,u=0,l=!1,c=!1,f=!1,h=0,d=null,p=a.Easing.Linear.None,g=a.Interpolation.Linear,m=[],v=null,y=!1,_=null,b=null,x=null;this.to=function(t,e){return i=t,void 0!==e&&(s=e),this},this.start=function(t){a.add(this),c=!0,y=!1,d=void 0!==t?t:a.now(),d+=h;for(var e in i){if(i[e]instanceof Array){if(0===i[e].length)continue;i[e]=[n[e]].concat(i[e])}void 0!==n[e]&&(r[e]=n[e],r[e]instanceof Array==!1&&(r[e]*=1),o[e]=r[e]||0)}return this},this.stop=function(){return c?(a.remove(this),c=!1,null!==x&&x.call(n,n),this.stopChainedTweens(),this):this},this.end=function(){return this.update(d+s),this},this.stopChainedTweens=function(){for(var t=0,e=m.length;t<e;t++)m[t].stop()},this.delay=function(t){return h=t,this},this.repeat=function(t){return u=t,this},this.repeatDelay=function(t){return e=t,this},this.yoyo=function(t){return l=t,this},this.easing=function(t){return p=t,this},this.interpolation=function(t){return g=t,this},this.chain=function(){return m=arguments,this},this.onStart=function(t){return v=t,this},this.onUpdate=function(t){return _=t,this},this.onComplete=function(t){return b=t,this},this.onStop=function(t){return x=t,this},this.update=function(t){var a,c,x;if(t<d)return!0;y===!1&&(null!==v&&v.call(n,n),y=!0),c=(t-d)/s,c=c>1?1:c,x=p(c);for(a in i)if(void 0!==r[a]){var w=r[a]||0,E=i[a];E instanceof Array?n[a]=g(E,x):("string"==typeof E&&(E="+"===E.charAt(0)||"-"===E.charAt(0)?w+parseFloat(E):parseFloat(E)),"number"==typeof E&&(n[a]=w+(E-w)*x))}if(null!==_&&_.call(n,x),1===c){if(u>0){isFinite(u)&&u--;for(a in o){if("string"==typeof i[a]&&(o[a]=o[a]+parseFloat(i[a])),l){var M=o[a];o[a]=i[a],i[a]=M}r[a]=o[a]}return l&&(f=!f),d=void 0!==e?t+e:t+h,!0}null!==b&&b.call(n,n);for(var I=0,A=m.length;I<A;I++)m[I].start(d+s);return!1}return!0}},a.Easing={Linear:{None:function(t){return t}},Quadratic:{In:function(t){return t*t},Out:function(t){return t*(2-t)},InOut:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)}},Cubic:{In:function(t){return t*t*t},Out:function(t){return--t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)}},Quartic:{In:function(t){return t*t*t*t},Out:function(t){return 1- --t*t*t*t},InOut:function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)}},Quintic:{In:function(t){return t*t*t*t*t},Out:function(t){return--t*t*t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)}},Sinusoidal:{In:function(t){return 1-Math.cos(t*Math.PI/2)},Out:function(t){return Math.sin(t*Math.PI/2)},InOut:function(t){return.5*(1-Math.cos(Math.PI*t))}},Exponential:{In:function(t){return 0===t?0:Math.pow(1024,t-1)},Out:function(t){return 1===t?1:1-Math.pow(2,-10*t)},InOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(-Math.pow(2,-10*(t-1))+2)}},Circular:{In:function(t){return 1-Math.sqrt(1-t*t)},Out:function(t){return Math.sqrt(1- --t*t)},InOut:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)}},Elastic:{In:function(t){return 0===t?0:1===t?1:-Math.pow(2,10*(t-1))*Math.sin(5*(t-1.1)*Math.PI)},Out:function(t){return 0===t?0:1===t?1:Math.pow(2,-10*t)*Math.sin(5*(t-.1)*Math.PI)+1},InOut:function(t){return 0===t?0:1===t?1:(t*=2,t<1?-.5*Math.pow(2,10*(t-1))*Math.sin(5*(t-1.1)*Math.PI):.5*Math.pow(2,-10*(t-1))*Math.sin(5*(t-1.1)*Math.PI)+1)}},Back:{In:function(t){var e=1.70158;return t*t*((e+1)*t-e)},Out:function(t){var e=1.70158;return--t*t*((e+1)*t+e)+1},InOut:function(t){var e=2.5949095;return(t*=2)<1?.5*(t*t*((e+1)*t-e)):.5*((t-=2)*t*((e+1)*t+e)+2)}},Bounce:{In:function(t){return 1-a.Easing.Bounce.Out(1-t)},Out:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},InOut:function(t){return t<.5?.5*a.Easing.Bounce.In(2*t):.5*a.Easing.Bounce.Out(2*t-1)+.5}}},a.Interpolation={Linear:function(t,e){var n=t.length-1,r=n*e,i=Math.floor(r),o=a.Interpolation.Utils.Linear;return e<0?o(t[0],t[1],r):e>1?o(t[n],t[n-1],n-r):o(t[i],t[i+1>n?n:i+1],r-i)},Bezier:function(t,e){for(var n=0,r=t.length-1,i=Math.pow,o=a.Interpolation.Utils.Bernstein,s=0;s<=r;s++)n+=i(1-e,r-s)*i(e,s)*t[s]*o(r,s);return n},CatmullRom:function(t,e){var n=t.length-1,r=n*e,i=Math.floor(r),o=a.Interpolation.Utils.CatmullRom;return t[0]===t[n]?(e<0&&(i=Math.floor(r=n*(1+e))),o(t[(i-1+n)%n],t[i],t[(i+1)%n],t[(i+2)%n],r-i)):e<0?t[0]-(o(t[0],t[0],t[1],t[1],-r)-t[0]):e>1?t[n]-(o(t[n],t[n],t[n-1],t[n-1],r-n)-t[n]):o(t[i?i-1:0],t[i],t[n<i+1?n:i+1],t[n<i+2?n:i+2],r-i)},Utils:{Linear:function(t,e,n){return(e-t)*n+t},Bernstein:function(t,e){var n=a.Interpolation.Utils.Factorial;return n(t)/n(e)/n(t-e)},Factorial:function(){var t=[1];return function(e){var n=1;if(t[e])return t[e];for(var r=e;r>1;r--)n*=r;return t[e]=n,n}}(),CatmullRom:function(t,e,n,r,a){var i=.5*(n-t),o=.5*(r-e),s=a*a,u=a*s;return(2*e-2*n+i+o)*u+(-3*e+3*n-2*i-o)*s+i*a+e}}},function(e){"function"==typeof t&&t.amd?t([],function(){return a}):"undefined"!=typeof n&&"object"==typeof r?n.exports=a:void 0!==e&&(e.TWEEN=a)}(this)}).call(this,e("_process"))},{_process:68}],78:[function(t,e,n){(function(e,r){"use strict";function a(t){if(t){var e=t.length||t.byteLength,n=y.log2(e);w[n].push(t)}}function i(t){a(t.buffer)}function o(t){var t=y.nextPow2(t),e=y.log2(t),n=w[e];return n.length>0?n.pop():new ArrayBuffer(t)}function s(t){return new Uint8Array(o(t),0,t)}function u(t){return new Uint16Array(o(2*t),0,t)}function l(t){return new Uint32Array(o(4*t),0,t)}function c(t){return new Int8Array(o(t),0,t)}function f(t){return new Int16Array(o(2*t),0,t)}function h(t){return new Int32Array(o(4*t),0,t)}function d(t){return new Float32Array(o(4*t),0,t)}function p(t){return new Float64Array(o(8*t),0,t)}function g(t){return b?new Uint8ClampedArray(o(t),0,t):s(t)}function m(t){return new DataView(o(t),0,t)}function v(t){t=y.nextPow2(t);var e=y.log2(t),n=E[e];return n.length>0?n.pop():new r(t)}var y=t("bit-twiddle"),_=t("dup");e.__TYPEDARRAY_POOL||(e.__TYPEDARRAY_POOL={UINT8:_([32,0]),UINT16:_([32,0]),UINT32:_([32,0]),INT8:_([32,0]),INT16:_([32,0]),INT32:_([32,0]),FLOAT:_([32,0]),DOUBLE:_([32,0]),DATA:_([32,0]),UINT8C:_([32,0]),BUFFER:_([32,0])});var b="undefined"!=typeof Uint8ClampedArray,x=e.__TYPEDARRAY_POOL;x.UINT8C||(x.UINT8C=_([32,0])),x.BUFFER||(x.BUFFER=_([32,0]));var w=x.DATA,E=x.BUFFER;n.free=function(t){if(r.isBuffer(t))E[y.log2(t.length)].push(t);else{if("[object ArrayBuffer]"!==Object.prototype.toString.call(t)&&(t=t.buffer),!t)return;var e=t.length||t.byteLength,n=0|y.log2(e);w[n].push(t)}},n.freeUint8=n.freeUint16=n.freeUint32=n.freeInt8=n.freeInt16=n.freeInt32=n.freeFloat32=n.freeFloat=n.freeFloat64=n.freeDouble=n.freeUint8Clamped=n.freeDataView=i,n.freeArrayBuffer=a,n.freeBuffer=function(t){E[y.log2(t.length)].push(t)},n.malloc=function(t,e){if(void 0===e||"arraybuffer"===e)return o(t);switch(e){case"uint8":return s(t);case"uint16":return u(t);case"uint32":return l(t);case"int8":return c(t);case"int16":return f(t);case"int32":return h(t);case"float":case"float32":return d(t);case"double":case"float64":return p(t);case"uint8_clamped":return g(t);case"buffer":return v(t);case"data":case"dataview":return m(t);default:return null}return null},n.mallocArrayBuffer=o,n.mallocUint8=s,n.mallocUint16=u,n.mallocUint32=l,n.mallocInt8=c,n.mallocInt16=f,n.mallocInt32=h,n.mallocFloat32=n.mallocFloat=d,n.mallocFloat64=n.mallocDouble=p,n.mallocUint8Clamped=g,n.mallocDataView=m,n.mallocBuffer=v,n.clearCache=function(){for(var t=0;t<32;++t)x.UINT8[t].length=0,x.UINT16[t].length=0,x.UINT32[t].length=0,x.INT8[t].length=0,x.INT16[t].length=0,x.INT32[t].length=0,x.FLOAT[t].length=0,x.DOUBLE[t].length=0,x.UINT8C[t].length=0,w[t].length=0,E[t].length=0}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},t("buffer").Buffer)},{"bit-twiddle":8,buffer:10,dup:17}],79:[function(t,e,n){"use strict";function r(t,e){for(var n=1,r=t.length,a=t[0],i=t[0],o=1;o<r;++o)if(i=a,a=t[o],e(a,i)){if(o===n){n++;continue}t[n++]=a}return t.length=n,t}function a(t){for(var e=1,n=t.length,r=t[0],a=t[0],i=1;i<n;++i,a=r)if(a=r,r=t[i],r!==a){if(i===e){e++;continue}t[e++]=r}return t.length=e,t}function i(t,e,n){return 0===t.length?t:e?(n||t.sort(e),r(t,e)):(n||t.sort(),a(t))}e.exports=i},{}],80:[function(t,e,n){!function(){"use strict";function t(e){e.permitHostObjects___&&e.permitHostObjects___(t)}function n(t){return!(t.substr(0,d.length)==d&&"___"===t.substr(t.length-3))}function r(t){if(t!==Object(t))throw new TypeError("Not an object: "+t);var e=t[p];if(e&&e.key===t)return e;if(h(t)){e={key:t};try{return f(t,p,{value:e,writable:!1,enumerable:!1,configurable:!1}),e}catch(t){return}}}function a(t){return t.prototype=null,Object.freeze(t)}function i(){y||"undefined"==typeof console||(y=!0,console.warn("WeakMap should be invoked as new WeakMap(), not WeakMap(). This will be an error in the future."))}if("undefined"==typeof ses||!ses.ok||ses.ok()){"undefined"!=typeof ses&&(ses.weakMapPermitHostObjects=t);var o=!1;if("function"==typeof WeakMap){var s=WeakMap;if("undefined"!=typeof navigator&&/Firefox/.test(navigator.userAgent));else{var u=new s,l=Object.freeze({});if(u.set(l,1),1===u.get(l))return void(e.exports=WeakMap);o=!0}}var c=(Object.prototype.hasOwnProperty,Object.getOwnPropertyNames),f=Object.defineProperty,h=Object.isExtensible,d="weakmap:",p=d+"ident:"+Math.random()+"___";if("undefined"!=typeof crypto&&"function"==typeof crypto.getRandomValues&&"function"==typeof ArrayBuffer&&"function"==typeof Uint8Array){var g=new ArrayBuffer(25),m=new Uint8Array(g);crypto.getRandomValues(m),p=d+"rand:"+Array.prototype.map.call(m,function(t){return(t%36).toString(36)}).join("")+"___"}if(f(Object,"getOwnPropertyNames",{value:function(t){return c(t).filter(n)}}),"getPropertyNames"in Object){var v=Object.getPropertyNames;f(Object,"getPropertyNames",{value:function(t){return v(t).filter(n)}})}!function(){var t=Object.freeze;f(Object,"freeze",{value:function(e){return r(e),t(e)}});var e=Object.seal;f(Object,"seal",{value:function(t){return r(t),e(t)}});var n=Object.preventExtensions;f(Object,"preventExtensions",{value:function(t){return r(t),n(t)}})}();var y=!1,_=0,b=function(){function t(t,e){var n,a=r(t);return a?l in a?a[l]:e:(n=s.indexOf(t),n>=0?u[n]:e)}function e(t){var e=r(t);return e?l in e:s.indexOf(t)>=0}function n(t,e){var n,a=r(t);return a?a[l]=e:(n=s.indexOf(t),n>=0?u[n]=e:(n=s.length,u[n]=e,s[n]=t)),this}function o(t){var e,n,a=r(t);return a?l in a&&delete a[l]:(e=s.indexOf(t),!(e<0)&&(n=s.length-1,s[e]=void 0,u[e]=u[n],s[e]=s[n],s.length=n,u.length=n,!0))}this instanceof b||i();var s=[],u=[],l=_++;return Object.create(b.prototype,{get___:{value:a(t)},has___:{value:a(e)},set___:{value:a(n)
},delete___:{value:a(o)}})};b.prototype=Object.create(Object.prototype,{get:{value:function(t,e){return this.get___(t,e)},writable:!0,configurable:!0},has:{value:function(t){return this.has___(t)},writable:!0,configurable:!0},set:{value:function(t,e){return this.set___(t,e)},writable:!0,configurable:!0},delete:{value:function(t){return this.delete___(t)},writable:!0,configurable:!0}}),"function"==typeof s?!function(){function n(){function e(t,e){return c?l.has(t)?l.get(t):c.get___(t,e):l.get(t,e)}function n(t){return l.has(t)||!!c&&c.has___(t)}function r(t){var e=!!l.delete(t);return c?c.delete___(t)||e:e}this instanceof b||i();var u,l=new s,c=void 0,f=!1;return u=o?function(t,e){return l.set(t,e),l.has(t)||(c||(c=new b),c.set(t,e)),this}:function(t,e){if(f)try{l.set(t,e)}catch(n){c||(c=new b),c.set___(t,e)}else l.set(t,e);return this},Object.create(b.prototype,{get___:{value:a(e)},has___:{value:a(n)},set___:{value:a(u)},delete___:{value:a(r)},permitHostObjects___:{value:a(function(e){if(e!==t)throw new Error("bogus call to permitHostObjects___");f=!0})}})}o&&"undefined"!=typeof Proxy&&(Proxy=void 0),n.prototype=b.prototype,e.exports=n,Object.defineProperty(WeakMap.prototype,"constructor",{value:WeakMap,enumerable:!1,configurable:!0,writable:!0})}():("undefined"!=typeof Proxy&&(Proxy=void 0),e.exports=b)}}()},{}],81:[function(t,e,n){function r(){var t={};return function(e){if(("object"!=typeof e||null===e)&&"function"!=typeof e)throw new Error("Weakmap-shim: Key must be object");var n=e.valueOf(t);return n&&n.identity===t?n:a(e,t)}}var a=t("./hidden-store.js");e.exports=r},{"./hidden-store.js":82}],82:[function(t,e,n){function r(t,e){var n={identity:e},r=t.valueOf;return Object.defineProperty(t,"valueOf",{value:function(t){return t!==e?r.apply(this,arguments):n},writable:!0}),n}e.exports=r},{}],83:[function(t,e,n){function r(){var t=a();return{get:function(e,n){var r=t(e);return r.hasOwnProperty("value")?r.value:n},set:function(e,n){return t(e).value=n,this},has:function(e){return"value"in t(e)},delete:function(e){return delete t(e).value}}}var a=t("./create-store.js");e.exports=r},{"./create-store.js":81}],84:[function(t,e,n){function r(t,e,n){if(!(this instanceof r))return new r(t,e,n);if(e instanceof a||(n=e,e=null),n=n||{},this.ctx=e=e||new a,t instanceof AudioNode||(t=t instanceof Audio||t instanceof HTMLAudioElement?e.createMediaElementSource(t):e.createMediaStreamSource(t)),this.analyser=e.createAnalyser(),this.stereo=!!n.stereo,this.audible=n.audible!==!1,this.wavedata=null,this.freqdata=null,this.splitter=null,this.merger=null,this.source=t,this.stereo){this.analyser=[this.analyser],this.analyser.push(e.createAnalyser()),this.splitter=e.createChannelSplitter(2),this.merger=e.createChannelMerger(2),this.output=this.merger,this.source.connect(this.splitter);for(var i=0;i<2;i++)this.splitter.connect(this.analyser[i],i,0),this.analyser[i].connect(this.merger,0,i);this.audible&&this.merger.connect(e.destination)}else this.output=this.source,this.source.connect(this.analyser),this.audible&&this.analyser.connect(e.destination)}var a=window.AudioContext||window.webkitAudioContext;e.exports=r,r.prototype.waveform=function(t,e){t||(t=this.wavedata||(this.wavedata=new Uint8Array((this.analyser[0]||this.analyser).frequencyBinCount)));var n=this.stereo?this.analyser[e||0]:this.analyser;return n.getByteTimeDomainData(t),t},r.prototype.frequencies=function(t,e){t||(t=this.freqdata||(this.freqdata=new Uint8Array((this.analyser[0]||this.analyser).frequencyBinCount)));var n=this.stereo?this.analyser[e||0]:this.analyser;return n.getByteFrequencyData(t),t}},{}],85:[function(t,e,n){function r(t,e){function n(){4===c.readyState&&r()}function r(){var t=null,n=c.statusCode=c.status,r=c.body=c.response||c.responseText||c.responseXML;if(0===n||n>=400&&n<600){var a=c.responseText||s[String(c.status).charAt(0)];t=new Error(a),t.statusCode=c.status}if(g)try{r=c.body=JSON.parse(r)}catch(t){}e(t,c,r)}function i(t){e(t,c)}"string"==typeof t&&(t={uri:t}),t=t||{},e=o(e);var c;c=t.cors?new l:new u;var f=c.url=t.uri,h=c.method=t.method||"GET",d=t.body||t.data,p=c.headers=t.headers||{},g=!1;return"json"in t&&(g=!0,p["Content-Type"]="application/json",d=JSON.stringify(t.json)),c.onreadystatechange=n,c.onload=r,c.onerror=i,c.onprogress=function(){},c.ontimeout=a,c.open(h,f),t.cors&&(c.withCredentials=!0),c.timeout="timeout"in t?t.timeout:5e3,c.setRequestHeader&&Object.keys(p).forEach(function(t){c.setRequestHeader(t,p[t])}),c.send(d),c}function a(){}var i=t("global/window"),o=t("once"),s={0:"Internal XMLHttpRequest Error",4:"4xx Client Error",5:"5xx Server Error"},u=i.XMLHttpRequest||a,l="withCredentials"in new u?i.XMLHttpRequest:i.XDomainRequest;e.exports=r},{"global/window":48,once:86}],86:[function(t,e,n){function r(t){var e=!1;return function(){if(!e)return e=!0,t.apply(this,arguments)}}e.exports=r,r.proto=r(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return r(this)},configurable:!0})})},{}],87:[function(t,e,n){e.exports=[{name:"islamic lattice",scale:1.6,d:5.1,offset:{x:1.8,y:3.8,z:2.3}},{name:"hive castle",scale:1.56,d:4.1,offset:{x:3.9,y:-.9,z:3.6}},{name:"triangle cake",scale:2.01,d:5,offset:{x:.8,y:2.54,z:1.8}},{name:"mobius sponge",scale:2.08,d:4.6,offset:{x:.78,y:2,z:2.1}},{comment:"FoldInv, FoldInv, Fold"},{name:"sierpinski what?",scale:1.43,d:1.8,angle2:.39269908169872414,offset:{x:.34,y:2,z:.4}},{name:"ornate as fuck",scale:1.23,d:.9,angle2:.39269908169872414,offset:{x:.3400000035762787,y:2,z:.4000000059604645}},{name:"chesser cat",scale:2.85,d:5.79,angle2:1.2,offset:{x:3.1,y:1.8,z:1.55}},{name:"circular banding debug",scale:1.43,d:4.6,angle2:.8,offset:{x:1.33,y:3.4,z:2.1}},{name:"sierpinski laborythn",scale:1.95,d:.2,angle2:3.1,offset:{x:-.3,y:.1,z:3.4}}]},{}],88:[function(t,e,n){"use strict";function r(){return!!navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform)}function a(){var t=navigator.userAgent.toLowerCase();return t.indexOf("android")>-1}function i(t,e){var n=Math.sin(e),r=Math.cos(e),a=1-r;return o.vec3.normalize(t,t),o.mat4.fromValues(a*t[0]*t[0]+r,a*t[0]*t[1]-t[2]*n,a*t[2]*t[0]+t[1]*n,0,a*t[0]*t[1]+t[2]*n,a*t[1]*t[1]+r,a*t[1]*t[2]-t[0]*n,0,a*t[2]*t[0]-t[1]*n,a*t[1]*t[2]+t[0]*n,a*t[2]*t[2]+r,0,0,0,0,1)}Object.defineProperty(n,"__esModule",{value:!0}),n.isIOS=r,n.isAndroid=a,n.rot4=i;var o=t("gl-matrix")},{"gl-matrix":26}],89:[function(t,e,n){"use strict";function r(t){var e=s.get(t);if(!e||!t.isBuffer(e._triangleBuffer.buffer)){var n=i(t,new Float32Array([-1,-1,-1,4,4,-1]));e=o(t,[{buffer:n,type:t.FLOAT,size:2}]),e._triangleBuffer=n,s.set(t,e)}e.bind(),t.drawArrays(t.TRIANGLES,0,3),e.unbind()}var a="undefined"==typeof WeakMap?t("weak-map"):WeakMap,i=t("gl-buffer"),o=t("gl-vao"),s=new a;e.exports=r},{"gl-buffer":95,"gl-vao":99,"weak-map":106}],90:[function(t,e,n){arguments[4][8][0].apply(n,arguments)},{dup:8}],91:[function(t,e,n){arguments[4][13][0].apply(n,arguments)},{"./lib/thunk.js":93,dup:13}],92:[function(t,e,n){arguments[4][14][0].apply(n,arguments)},{dup:14,uniq:105}],93:[function(t,e,n){arguments[4][15][0].apply(n,arguments)},{"./compile.js":92,dup:15}],94:[function(t,e,n){arguments[4][17][0].apply(n,arguments)},{dup:17}],95:[function(t,e,n){arguments[4][20][0].apply(n,arguments)},{dup:20,ndarray:103,"ndarray-ops":102,"typedarray-pool":104}],96:[function(t,e,n){arguments[4][44][0].apply(n,arguments)},{dup:44}],97:[function(t,e,n){arguments[4][45][0].apply(n,arguments)},{"./do-bind.js":96,dup:45}],98:[function(t,e,n){arguments[4][46][0].apply(n,arguments)},{"./do-bind.js":96,dup:46}],99:[function(t,e,n){arguments[4][47][0].apply(n,arguments)},{"./lib/vao-emulated.js":97,"./lib/vao-native.js":98,dup:47}],100:[function(t,e,n){arguments[4][61][0].apply(n,arguments)},{dup:61}],101:[function(t,e,n){arguments[4][62][0].apply(n,arguments)},{dup:62}],102:[function(t,e,n){arguments[4][64][0].apply(n,arguments)},{"cwise-compiler":91,dup:64}],103:[function(t,e,n){arguments[4][65][0].apply(n,arguments)},{dup:65,"iota-array":100,"is-buffer":101}],104:[function(t,e,n){arguments[4][78][0].apply(n,arguments)},{"bit-twiddle":90,buffer:10,dup:78}],105:[function(t,e,n){arguments[4][79][0].apply(n,arguments)},{dup:79}],106:[function(t,e,n){arguments[4][80][0].apply(n,arguments)},{dup:80}],107:[function(t,e,n){function r(t){this.gl=t,this.width=window.innerWidth,this.height=window.innerHeight,this.vrDisplay=void 0,this.autoSubmitFrame=!0,this.frameData=null,"VRFrameData"in window&&(this.frameData=new VRFrameData),this.isPresenting=!1,window.addEventListener("vrdisplaypresentchange",this.onVRDisplayPresentChange.bind(this),!1)}const a=t("a-big-triangle"),i=[0,0,.5,1],o=[.5,0,.5,1];r.prototype.setSize=function(t,e){this.width=t,this.height=e},r.prototype.getVRDisplay=function(){return this.vrDisplay},r.prototype.setVRDisplay=function(t){this.vrDisplay=t},r.prototype.onVRDisplayPresentChange=function(){this.isPresenting=void 0!==this.vrDisplay&&this.vrDisplay.isPresenting},r.prototype.submitFrame=function(){var t=this.vrDisplay,e=this.isPresenting;void 0!==t&&e&&t.submitFrame()},r.prototype.renderEye=function(t,e){t.viewport(e.x,e.y,e.width,e.height),t.scissor(e.x,e.y,e.width,e.height),a(t)},r.prototype.render=function(t,e){var n=this.gl,r=this.vrDisplay,s=this.isPresenting,u=this.width,l=this.height;if(r&&s){var c,f,h=r.getEyeParameters("left"),d=r.getEyeParameters("right"),p={width:u,height:l},g=r.getLayers();if(g.length){var m=g[0];c=null!==m.leftBounds&&4===m.leftBounds.length?m.leftBounds:i,f=null!==m.rightBounds&&4===m.rightBounds.length?m.rightBounds:o}else c=i,f=o;var v={x:Math.round(p.width*c[0]),y:Math.round(p.height*c[1]),width:Math.round(p.width*c[2]),height:Math.round(p.height*c[3])},y={x:Math.round(p.width*f[0]),y:Math.round(p.height*f[1]),width:Math.round(p.width*f[2]),height:Math.round(p.height*f[3])};n.enable(n.SCISSOR_TEST),r.getFrameData&&r.getFrameData(this.frameData),t.uniforms.resolution=[v.width,v.height],t.uniforms.cOffset=h.offset,t.uniforms.projectionMatrix=this.frameData.leftProjectionMatrix,this.renderEye(n,v),t.uniforms.resolution=[y.width,y.height],t.uniforms.cOffset=d.offset,t.uniforms.projectionMatrix=this.frameData.rightProjectionMatrix,this.renderEye(n,y),n.viewport(0,0,p.width,p.height),n.disable(n.SCISSOR_TEST),this.autoSubmitFrame&&this.submitFrame()}else{t.uniforms.resolution=[u,l],n.viewport(0,0,u,l);var _=this.projectionMatrix(80,1,1);t.uniforms.projectionMatrix=_,a(n)}},r.prototype.projectionMatrix=function(t,e,n){const r=this.vrDisplay.depthNear,a=this.vrDisplay.depthFar,i=Math.PI/180,o=35;var s=r*Math.tan(.5*i*t)/n,u=2*s,l=e*u,c=-.5*l;o*Math.min(e,1);return this.makeFrustum(c,c+l,s-u,s,r,a)},r.prototype.makeFrustum=function(t,e,n,r,a,i){var o=[],s=2*a/(e-t),u=2*a/(r-n),l=(e+t)/(e-t),c=(r+n)/(r-n),f=-(i+a)/(i-a),h=-2*i*a/(i-a);return o[0]=s,o[4]=0,o[8]=l,o[12]=0,o[1]=0,o[5]=u,o[9]=c,o[13]=0,o[2]=0,o[6]=0,o[10]=f,o[14]=h,o[3]=0,o[7]=0,o[11]=-1,o[15]=0,o},e.exports=r},{"a-big-triangle":89}],108:[function(t,e,n){function r(t){this.gl=t,this.scale=1,this.vrDisplay=void 0,this.frameData=null,"VRFrameData"in window&&(this.frameData=new VRFrameData),window.addEventListener("vrdisplaypresentchange",this.onVRDisplayPresentChange.bind(this),!1)}r.prototype.getVRDisplay=function(){return this.vrDisplay},r.prototype.setVRDisplay=function(t){this.vrDisplay=t},r.prototype.onVRDisplayPresentChange=function(){var t=this.vrDisplay;this.isPresenting=void 0!==t&&t.isPresenting},r.prototype.quaternionToMatrix=function(t){var e=[],n=t[0],r=t[1],a=t[2],i=t[3],o=n+n,s=r+r,u=a+a,l=n*o,c=n*s,f=n*u,h=r*s,d=r*u,p=a*u,g=i*o,m=i*s,v=i*u;return e[0]=1-(h+p),e[4]=c-v,e[8]=f+m,e[1]=c+v,e[5]=1-(l+p),e[9]=d-g,e[2]=f-m,e[6]=d+g,e[10]=1-(l+h),e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},r.prototype.update=function(t){var e=this.vrDisplay,n=this.frameData;if(e){var r;e.getFrameData?(e.getFrameData(n),r=n.pose):e.getPose&&(r=e.getPose()),null!==r.orientation&&(t.uniforms.orientation=this.quaternionToMatrix(r.orientation))}},e.exports=r},{}],109:[function(t,e,n){function r(t){var e=t||document.body;this.loadIcons_();var n=this.createButton();n.src=this.ICONS.fullscreen,n.title="Fullscreen mode";var r=n.style;r.bottom=0,r.right=0,n.addEventListener("click",this.createClickHandler_("fs")),e.appendChild(n),this.fsButton=n;var a=this.createButton();a.src=this.ICONS.cardboard,a.title="Virtual reality mode";var r=a.style;r.bottom=0,r.right="48px",a.addEventListener("click",this.createClickHandler_("vr")),e.appendChild(a),this.vrButton=a,this.isVisible=!0,this.callbacks={}}var a=t("./emitter.js"),i=t("./modes.js"),o=t("./util.js");r.prototype.emit=a.prototype.emit,r.prototype.on=a.prototype.on,r.prototype.createButton=function(){var t=document.createElement("img");t.className="webvr-button";var e=t.style;return e.position="absolute",e.width="24px",e.height="24px",e.backgroundSize="cover",e.backgroundColor="transparent",e.border=0,e.userSelect="none",e.webkitUserSelect="none",e.MozUserSelect="none",e.cursor="pointer",e.padding="12px",e.zIndex=1,e.display="none",e.boxSizing="content-box",t.draggable=!1,t.addEventListener("dragstart",function(t){t.preventDefault()}),t.addEventListener("mouseenter",function(t){e.filter=e.webkitFilter="drop-shadow(0 0 5px rgba(255,255,255,1))"}),t.addEventListener("mouseleave",function(t){e.filter=e.webkitFilter=""}),t},r.prototype.setMode=function(t,e){if(e=e||WebVRConfig.FORCE_ENABLE_VR,this.isVisible){switch(t){case i.NORMAL:this.fsButton.style.display="block",this.fsButton.src=this.ICONS.fullscreen,this.vrButton.style.display=e?"block":"none";break;case i.MAGIC_WINDOW:this.fsButton.style.display="block",this.fsButton.src=this.ICONS.exitFullscreen,this.vrButton.style.display="none";break;case i.VR:this.fsButton.style.display="none",this.vrButton.style.display="none"}var n=this.fsButton.style.display;this.fsButton.style.display="inline-block",this.fsButton.offsetHeight,this.fsButton.style.display=n}},r.prototype.setVisibility=function(t){this.isVisible=t,this.fsButton.style.display=t?"block":"none",this.vrButton.style.display=t?"block":"none"},r.prototype.createClickHandler_=function(t){return function(e){e.stopPropagation(),e.preventDefault(),this.emit(t)}.bind(this)},r.prototype.loadIcons_=function(){this.ICONS={},this.ICONS.cardboard=o.base64("image/svg+xml","PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNHB4IiBoZWlnaHQ9IjI0cHgiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0iI0ZGRkZGRiI+CiAgICA8cGF0aCBkPSJNMjAuNzQgNkgzLjIxQzIuNTUgNiAyIDYuNTcgMiA3LjI4djEwLjQ0YzAgLjcuNTUgMS4yOCAxLjIzIDEuMjhoNC43OWMuNTIgMCAuOTYtLjMzIDEuMTQtLjc5bDEuNC0zLjQ4Yy4yMy0uNTkuNzktMS4wMSAxLjQ0LTEuMDFzMS4yMS40MiAxLjQ1IDEuMDFsMS4zOSAzLjQ4Yy4xOS40Ni42My43OSAxLjExLjc5aDQuNzljLjcxIDAgMS4yNi0uNTcgMS4yNi0xLjI4VjcuMjhjMC0uNy0uNTUtMS4yOC0xLjI2LTEuMjh6TTcuNSAxNC42MmMtMS4xNyAwLTIuMTMtLjk1LTIuMTMtMi4xMiAwLTEuMTcuOTYtMi4xMyAyLjEzLTIuMTMgMS4xOCAwIDIuMTIuOTYgMi4xMiAyLjEzcy0uOTUgMi4xMi0yLjEyIDIuMTJ6bTkgMGMtMS4xNyAwLTIuMTMtLjk1LTIuMTMtMi4xMiAwLTEuMTcuOTYtMi4xMyAyLjEzLTIuMTNzMi4xMi45NiAyLjEyIDIuMTMtLjk1IDIuMTItMi4xMiAyLjEyeiIvPgogICAgPHBhdGggZmlsbD0ibm9uZSIgZD0iTTAgMGgyNHYyNEgwVjB6Ii8+Cjwvc3ZnPgo="),this.ICONS.fullscreen=o.base64("image/svg+xml","PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNHB4IiBoZWlnaHQ9IjI0cHgiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0iI0ZGRkZGRiI+CiAgICA8cGF0aCBkPSJNMCAwaDI0djI0SDB6IiBmaWxsPSJub25lIi8+CiAgICA8cGF0aCBkPSJNNyAxNEg1djVoNXYtMkg3di0zem0tMi00aDJWN2gzVjVINXY1em0xMiA3aC0zdjJoNXYtNWgtMnYzek0xNCA1djJoM3YzaDJWNWgtNXoiLz4KPC9zdmc+Cg=="),this.ICONS.exitFullscreen=o.base64("image/svg+xml","PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNHB4IiBoZWlnaHQ9IjI0cHgiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0iI0ZGRkZGRiI+CiAgICA8cGF0aCBkPSJNMCAwaDI0djI0SDB6IiBmaWxsPSJub25lIi8+CiAgICA8cGF0aCBkPSJNNSAxNmgzdjNoMnYtNUg1djJ6bTMtOEg1djJoNVY1SDh2M3ptNiAxMWgydi0zaDN2LTJoLTV2NXptMi0xMVY1aC0ydjVoNVY4aC0zeiIvPgo8L3N2Zz4K"),this.ICONS.settings=o.base64("image/svg+xml","PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNHB4IiBoZWlnaHQ9IjI0cHgiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0iI0ZGRkZGRiI+CiAgICA8cGF0aCBkPSJNMCAwaDI0djI0SDB6IiBmaWxsPSJub25lIi8+CiAgICA8cGF0aCBkPSJNMTkuNDMgMTIuOThjLjA0LS4zMi4wNy0uNjQuMDctLjk4cy0uMDMtLjY2LS4wNy0uOThsMi4xMS0xLjY1Yy4xOS0uMTUuMjQtLjQyLjEyLS42NGwtMi0zLjQ2Yy0uMTItLjIyLS4zOS0uMy0uNjEtLjIybC0yLjQ5IDFjLS41Mi0uNC0xLjA4LS43My0xLjY5LS45OGwtLjM4LTIuNjVDMTQuNDYgMi4xOCAxNC4yNSAyIDE0IDJoLTRjLS4yNSAwLS40Ni4xOC0uNDkuNDJsLS4zOCAyLjY1Yy0uNjEuMjUtMS4xNy41OS0xLjY5Ljk4bC0yLjQ5LTFjLS4yMy0uMDktLjQ5IDAtLjYxLjIybC0yIDMuNDZjLS4xMy4yMi0uMDcuNDkuMTIuNjRsMi4xMSAxLjY1Yy0uMDQuMzItLjA3LjY1LS4wNy45OHMuMDMuNjYuMDcuOThsLTIuMTEgMS42NWMtLjE5LjE1LS4yNC40Mi0uMTIuNjRsMiAzLjQ2Yy4xMi4yMi4zOS4zLjYxLjIybDIuNDktMWMuNTIuNCAxLjA4LjczIDEuNjkuOThsLjM4IDIuNjVjLjAzLjI0LjI0LjQyLjQ5LjQyaDRjLjI1IDAgLjQ2LS4xOC40OS0uNDJsLjM4LTIuNjVjLjYxLS4yNSAxLjE3LS41OSAxLjY5LS45OGwyLjQ5IDFjLjIzLjA5LjQ5IDAgLjYxLS4yMmwyLTMuNDZjLjEyLS4yMi4wNy0uNDktLjEyLS42NGwtMi4xMS0xLjY1ek0xMiAxNS41Yy0xLjkzIDAtMy41LTEuNTctMy41LTMuNXMxLjU3LTMuNSAzLjUtMy41IDMuNSAxLjU3IDMuNSAzLjUtMS41NyAzLjUtMy41IDMuNXoiLz4KPC9zdmc+Cg==")},e.exports=r},{"./emitter.js":110,"./modes.js":111,"./util.js":112}],110:[function(t,e,n){function r(){this.callbacks={}}r.prototype.emit=function(t){var e=this.callbacks[t];if(e){var n=[].slice.call(arguments);n.shift();for(var r=0;r<e.length;r++)e[r].apply(this,n)}},r.prototype.on=function(t,e){t in this.callbacks?this.callbacks[t].push(e):this.callbacks[t]=[e]},e.exports=r},{}],111:[function(t,e,n){var r={UNKNOWN:0,NORMAL:1,MAGIC_WINDOW:2,VR:3};e.exports=r},{}],112:[function(t,e,n){var r={};r.base64=function(t,e){return"data:"+t+";base64,"+e},r.isMobile=function(){var t=!1;return function(e){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)))&&(t=!0)}(navigator.userAgent||navigator.vendor||window.opera),t},r.isFirefox=function(){return/firefox/i.test(navigator.userAgent)},r.isIOS=function(){return/(iPad|iPhone|iPod)/g.test(navigator.userAgent)},r.isIFrame=function(){try{return window.self!==window.top}catch(t){return!0}},r.appendQueryParameter=function(t,e,n){var r=t.indexOf("?")<0?"?":"&";return t+=r+e+"="+n},r.getQueryParameter=function(t){var t=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]"),e=new RegExp("[\\?&]"+t+"=([^&#]*)"),n=e.exec(location.search);return null===n?"":decodeURIComponent(n[1].replace(/\+/g," "))},r.isLandscapeMode=function(){return 90==window.orientation||window.orientation==-90},r.getScreenWidth=function(){return Math.max(window.screen.width,window.screen.height)*window.devicePixelRatio},r.getScreenHeight=function(){return Math.min(window.screen.width,window.screen.height)*window.devicePixelRatio},e.exports=r},{}],113:[function(t,e,n){function r(t,e,n){this.params=n||{},this.mode=o.UNKNOWN,this.hideButton=this.params.hideButton||!1,this.predistorted=!!this.params.predistorted,this.renderer=t,this.effect=e;var r=document.querySelector(".webvr-polyfill-fullscreen-wrapper");this.button=new a(r),this.isFullscreenDisabled=!!s.getQueryParameter("no_fullscreen"),this.startMode=o.NORMAL;var i=parseInt(s.getQueryParameter("start_mode"));isNaN(i)||(this.startMode=i),this.hideButton&&this.button.setVisibility(!1),this.getDeviceByType_(VRDisplay).then(function(t){switch(this.hmd=t,this.isVRCompatibleOverride||(this.isVRCompatible=!t.isPolyfilled||s.isMobile()),this.startMode){case o.MAGIC_WINDOW:this.setMode_(o.MAGIC_WINDOW);break;case o.VR:this.enterVRMode_(),this.setMode_(o.VR);break;default:this.setMode_(o.NORMAL)}this.emit("initialized")}.bind(this)),this.button.on("fs",this.onFSClick_.bind(this)),this.button.on("vr",this.onVRClick_.bind(this)),this.onFullScreenChangeBound=this.onFullscreenChange_.bind(this),this.onVRDisplayPresentChangeBound=this.onVRDisplayPresentChange_.bind(this),this.onVRDisplayDeviceParamsChangeBound=this.onVRDisplayDeviceParamsChange_.bind(this)}var a=t("./button-manager.js"),i=t("./emitter.js"),o=t("./modes.js"),s=t("./util.js");r.prototype=new i,r.Modes=o,r.prototype.enableEvents=function(){document.addEventListener("webkitfullscreenchange",this.onFullScreenChangeBound),document.addEventListener("mozfullscreenchange",this.onFullScreenChangeBound),document.addEventListener("msfullscreenchange",this.onFullScreenChangeBound),window.addEventListener("vrdisplaypresentchange",this.onVRDisplayPresentChangeBound),window.addEventListener("vrdisplaydeviceparamschange",this.onVRDisplayDeviceParamsChangeBound)},r.prototype.disposeEvents=function(){document.removeEventListener("webkitfullscreenchange",this.onFullScreenChangeBound),document.removeEventListener("mozfullscreenchange",this.onFullScreenChangeBound),document.removeEventListener("msfullscreenchange",this.onFullScreenChangeBound),window.removeEventListener("vrdisplaypresentchange",this.onVRDisplayPresentChangeBound),window.removeEventListener("vrdisplaydeviceparamschange",this.onVRDisplayDeviceParamsChangeBound)},r.prototype.render=function(t,e){t instanceof Array?this.effect.render(t,e):this.effect.render(t,e)},r.prototype.setVRCompatibleOverride=function(t){this.isVRCompatible=t,this.isVRCompatibleOverride=!0,this.button.setMode(this.mode,this.isVRCompatible)},r.prototype.setFullscreenCallback=function(t){this.fullscreenCallback=t},r.prototype.setVRCallback=function(t){this.vrCallback=t},r.prototype.setExitFullscreenCallback=function(t){this.exitFullscreenCallback=t},r.prototype.getDeviceByType_=function(t){return new Promise(function(e,n){navigator.getVRDisplays().then(function(n){for(var r=0;r<n.length;r++)if(n[r]instanceof t){e(n[r]);break}e(null)},function(){e(null)})})},r.prototype.enterVRMode_=function(){this.hmd.requestPresent([{source:this.renderer.domElement,predistorted:this.predistorted}])},r.prototype.setMode_=function(t){var e=this.mode;return t==this.mode?void console.warn("Not changing modes, already in %s",t):(this.mode=t,this.button.setMode(t,this.isVRCompatible),void this.emit("modechange",t,e))},r.prototype.onFSClick_=function(){switch(this.mode){case o.NORMAL:if(s.isIOS()&&s.isIFrame()){if(!this.fullscreenCallback){var t=window.location.href;return t=s.appendQueryParameter(t,"no_fullscreen","true"),t=s.appendQueryParameter(t,"start_mode",o.MAGIC_WINDOW),void(top.location.href=t)}this.fullscreenCallback()}this.setMode_(o.MAGIC_WINDOW),this.requestFullscreen_();break;case o.MAGIC_WINDOW:if(this.isFullscreenDisabled)return void window.history.back();this.exitFullscreenCallback&&this.exitFullscreenCallback(),this.setMode_(o.NORMAL),this.exitFullscreen_()}},r.prototype.onVRClick_=function(){if(this.mode==o.NORMAL&&s.isIOS()&&s.isIFrame()){if(!this.vrCallback){var t=window.location.href;return t=s.appendQueryParameter(t,"no_fullscreen","true"),t=s.appendQueryParameter(t,"start_mode",o.VR),void(top.location.href=t)}this.vrCallback()}this.enterVRMode_()},r.prototype.requestFullscreen_=function(){var t=document.body;t.requestFullscreen?t.requestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen?t.webkitRequestFullscreen():t.msRequestFullscreen&&t.msRequestFullscreen()},r.prototype.exitFullscreen_=function(){document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen()},r.prototype.onVRDisplayPresentChange_=function(t){console.log("onVRDisplayPresentChange_",t),this.hmd.isPresenting?this.setMode_(o.VR):this.setMode_(o.NORMAL)},r.prototype.onVRDisplayDeviceParamsChange_=function(t){console.log("onVRDisplayDeviceParamsChange_",t)},r.prototype.onFullscreenChange_=function(t){null!==document.webkitFullscreenElement&&null!==document.mozFullScreenElement||this.setMode_(o.NORMAL)},e.exports=r},{"./button-manager.js":109,"./emitter.js":110,"./modes.js":111,"./util.js":112}]},{},[2])(2)});
